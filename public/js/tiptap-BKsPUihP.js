import{P as U,a as K,S as dt,N as yt,f as ts,c as he,l as es,b as ns,T as Q,d as ss,e as rs,j as os,g as is,h as as,i as ls,k as fn,m as cs,n as ds,o as us,p as ps,q as hs,r as fs,s as gs,t as ms,u as bs,v as ys,w as vs,x as Ms,y as Re,z as ks,A as It,F as Ht,B as ws,C as Es,D as xs,E as Ts,G as Ss,H as As,I as gn,J as ee,R as Cs,K as Os,L as Ls,M as _s,O as Ps,Q as Rs,U as Ns,V as Is,W as fe,X as ge,Y as Hs,Z as $s,_ as Bs,$ as Ds,a0 as js,a1 as Fs,a2 as Ws,a3 as Ne,a4 as Ie,a5 as He,a6 as zs,a7 as Us,a8 as $e,a9 as qs,aa as mn,ab as Ks,ac as Vs,ad as Be,ae as bn,af as Gs,ag as Qs,ah as Js,ai as Ft,aj as me,ak as Xs,al as be,am as Wt,an as Ys,ao as yn,ap as vn,aq as Zs,ar as De,as as tr,at as er,au as je,av as nr,aw as sr,ax as ie}from"./vendor-CWXOCgin.js";function zt(t){const{state:e,transaction:n}=t;let{selection:s}=n,{doc:r}=n,{storedMarks:a}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return s},get doc(){return r},get tr(){return s=n.selection,r=n.doc,a=n.storedMarks,n}}}class Ut{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:s}=this,{view:r}=n,{tr:a}=s,o=this.buildProps(a);return Object.fromEntries(Object.entries(e).map(([i,l])=>[i,(...u)=>{const d=l(...u)(o);return!a.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(a),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:s,editor:r,state:a}=this,{view:o}=r,i=[],l=!!e,c=e||a.tr,u=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),i.every(p=>p===!0)),d={...Object.fromEntries(Object.entries(s).map(([p,h])=>[p,(...b)=>{const m=this.buildProps(c,n),g=h(...b)(m);return i.push(g),d}])),run:u};return d}createCan(e){const{rawCommands:n,state:s}=this,r=!1,a=e||s.tr,o=this.buildProps(a,r);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(a,r)}}buildProps(e,n=!0){const{rawCommands:s,editor:r,state:a}=this,{view:o}=r,i={tr:e,editor:r,view:o,state:zt({state:a,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(s).map(([l,c])=>[l,(...u)=>c(...u)(i)]))}};return i}}class rr{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const s=this.callbacks[e];return s&&s.forEach(r=>r.apply(this,n)),this}off(e,n){const s=this.callbacks[e];return s&&(n?this.callbacks[e]=s.filter(r=>r!==n):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function k(t,e,n){return t.config[e]===void 0&&t.parent?k(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?k(t.parent,e,n):null}):t.config[e]}function qt(t){const e=t.filter(r=>r.type==="extension"),n=t.filter(r=>r.type==="node"),s=t.filter(r=>r.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:s}}function Mn(t){const e=[],{nodeExtensions:n,markExtensions:s}=qt(t),r=[...n,...s],a={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const i={name:o.name,options:o.options,storage:o.storage,extensions:r},l=k(o,"addGlobalAttributes",i);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([p,h])=>{e.push({type:d,name:p,attribute:{...a,...h}})})})})}),r.forEach(o=>{const i={name:o.name,options:o.options,storage:o.storage},l=k(o,"addAttributes",i);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const p={...a,...d};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,e.push({type:o.name,name:u,attribute:p})})}),e}function W(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function R(...t){return t.filter(e=>!!e).reduce((e,n)=>{const s={...e};return Object.entries(n).forEach(([r,a])=>{if(!s[r]){s[r]=a;return}if(r==="class"){const i=a?a.split(" "):[],l=s[r]?s[r].split(" "):[],c=i.filter(u=>!l.includes(u));s[r]=[...l,...c].join(" ")}else r==="style"?s[r]=[s[r],a].join("; "):s[r]=a}),s},{})}function ae(t,e){return e.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,s)=>R(n,s),{})}function kn(t){return typeof t=="function"}function A(t,e=void 0,...n){return kn(t)?e?t.bind(e)(...n):t(...n):t}function or(t={}){return Object.keys(t).length===0&&t.constructor===Object}function ir(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Fe(t,e){return"style"in t?t:{...t,getAttrs:n=>{const s=t.getAttrs?t.getAttrs(n):t.attrs;if(s===!1)return!1;const r=e.reduce((a,o)=>{const i=o.attribute.parseHTML?o.attribute.parseHTML(n):ir(n.getAttribute(o.name));return i==null?a:{...a,[o.name]:i}},{});return{...s,...r}}}}function We(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&or(n)?!1:n!=null))}function ar(t,e){var n;const s=Mn(t),{nodeExtensions:r,markExtensions:a}=qt(t),o=(n=r.find(c=>k(c,"topNode")))===null||n===void 0?void 0:n.name,i=Object.fromEntries(r.map(c=>{const u=s.filter(g=>g.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},p=t.reduce((g,M)=>{const x=k(M,"extendNodeSchema",d);return{...g,...x?x(c):{}}},{}),h=We({...p,content:A(k(c,"content",d)),marks:A(k(c,"marks",d)),group:A(k(c,"group",d)),inline:A(k(c,"inline",d)),atom:A(k(c,"atom",d)),selectable:A(k(c,"selectable",d)),draggable:A(k(c,"draggable",d)),code:A(k(c,"code",d)),whitespace:A(k(c,"whitespace",d)),defining:A(k(c,"defining",d)),isolating:A(k(c,"isolating",d)),attrs:Object.fromEntries(u.map(g=>{var M;return[g.name,{default:(M=g==null?void 0:g.attribute)===null||M===void 0?void 0:M.default}]}))}),f=A(k(c,"parseHTML",d));f&&(h.parseDOM=f.map(g=>Fe(g,u)));const b=k(c,"renderHTML",d);b&&(h.toDOM=g=>b({node:g,HTMLAttributes:ae(g,u)}));const m=k(c,"renderText",d);return m&&(h.toText=m),[c.name,h]})),l=Object.fromEntries(a.map(c=>{const u=s.filter(m=>m.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},p=t.reduce((m,g)=>{const M=k(g,"extendMarkSchema",d);return{...m,...M?M(c):{}}},{}),h=We({...p,inclusive:A(k(c,"inclusive",d)),excludes:A(k(c,"excludes",d)),group:A(k(c,"group",d)),spanning:A(k(c,"spanning",d)),code:A(k(c,"code",d)),attrs:Object.fromEntries(u.map(m=>{var g;return[m.name,{default:(g=m==null?void 0:m.attribute)===null||g===void 0?void 0:g.default}]}))}),f=A(k(c,"parseHTML",d));f&&(h.parseDOM=f.map(m=>Fe(m,u)));const b=k(c,"renderHTML",d);return b&&(h.toDOM=m=>b({mark:m,HTMLAttributes:ae(m,u)})),[c.name,h]}));return new gn({topNode:o,nodes:i,marks:l})}function ne(t,e){return e.nodes[t]||e.marks[t]||null}function ze(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}const lr=(t,e=500)=>{let n="";const s=t.parentOffset;return t.parent.nodesBetween(Math.max(0,s-e),s,(r,a,o,i)=>{var l,c;const u=((c=(l=r.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:r,pos:a,parent:o,index:i}))||r.textContent||"%leaf%";n+=r.isAtom&&!r.isText?u:u.slice(0,Math.max(0,s-a))}),n};function ye(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class xt{constructor(e){this.find=e.find,this.handler=e.handler}}const cr=(t,e)=>{if(ye(e))return e.exec(t);const n=e(t);if(!n)return null;const s=[n.text];return s.index=n.index,s.input=t,s.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),s.push(n.replaceWith)),s};function Lt(t){var e;const{editor:n,from:s,to:r,text:a,rules:o,plugin:i}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(s);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(p=>p.type.spec.code))return!1;let u=!1;const d=lr(c)+a;return o.forEach(p=>{if(u)return;const h=cr(d,p.find);if(!h)return;const f=l.state.tr,b=zt({state:l.state,transaction:f}),m={from:s-(h[0].length-a.length),to:r},{commands:g,chain:M,can:x}=new Ut({editor:n,state:b});p.handler({state:b,range:m,match:h,commands:g,chain:M,can:x})===null||!f.steps.length||(f.setMeta(i,{transform:f,from:s,to:r,text:a}),l.dispatch(f),u=!0)}),u}function dr(t){const{editor:e,rules:n}=t,s=new U({state:{init(){return null},apply(r,a){const o=r.getMeta(s);if(o)return o;const i=r.getMeta("applyInputRules");return!!i&&setTimeout(()=>{const{from:c,text:u}=i,d=c+u.length;Lt({editor:e,from:c,to:d,text:u,rules:n,plugin:s})}),r.selectionSet||r.docChanged?null:a}},props:{handleTextInput(r,a,o,i){return Lt({editor:e,from:a,to:o,text:i,rules:n,plugin:s})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{const{$cursor:a}=r.state.selection;a&&Lt({editor:e,from:a.pos,to:a.pos,text:"",rules:n,plugin:s})}),!1)},handleKeyDown(r,a){if(a.key!=="Enter")return!1;const{$cursor:o}=r.state.selection;return o?Lt({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:s}):!1}},isInputRules:!0});return s}function ur(t){return typeof t=="number"}class pr{constructor(e){this.find=e.find,this.handler=e.handler}}const hr=(t,e,n)=>{if(ye(e))return[...t.matchAll(e)];const s=e(t,n);return s?s.map(r=>{const a=[r.text];return a.index=r.index,a.input=t,a.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(r.replaceWith)),a}):[]};function fr(t){const{editor:e,state:n,from:s,to:r,rule:a,pasteEvent:o,dropEvent:i}=t,{commands:l,chain:c,can:u}=new Ut({editor:e,state:n}),d=[];return n.doc.nodesBetween(s,r,(h,f)=>{if(!h.isTextblock||h.type.spec.code)return;const b=Math.max(s,f),m=Math.min(r,f+h.content.size),g=h.textBetween(b-f,m-f,void 0,"￼");hr(g,a.find,o).forEach(x=>{if(x.index===void 0)return;const L=b+x.index+1,I=L+x[0].length,O={from:n.tr.mapping.map(L),to:n.tr.mapping.map(I)},$=a.handler({state:n,range:O,match:x,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:i});d.push($)})}),d.every(h=>h!==null)}const gr=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function mr(t){const{editor:e,rules:n}=t;let s=null,r=!1,a=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,i=typeof DragEvent<"u"?new DragEvent("drop"):null;const l=({state:u,from:d,to:p,rule:h,pasteEvt:f})=>{const b=u.tr,m=zt({state:u,transaction:b});if(!(!fr({editor:e,state:m,from:Math.max(d-1,0),to:p.b-1,rule:h,pasteEvent:f,dropEvent:i})||!b.steps.length))return i=typeof DragEvent<"u"?new DragEvent("drop"):null,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,b};return n.map(u=>new U({view(d){const p=h=>{var f;s=!((f=d.dom.parentElement)===null||f===void 0)&&f.contains(h.target)?d.dom.parentElement:null};return window.addEventListener("dragstart",p),{destroy(){window.removeEventListener("dragstart",p)}}},props:{handleDOMEvents:{drop:(d,p)=>(a=s===d.dom.parentElement,i=p,!1),paste:(d,p)=>{var h;const f=(h=p.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return o=p,r=!!(f!=null&&f.includes("data-pm-slice")),!1}}},appendTransaction:(d,p,h)=>{const f=d[0],b=f.getMeta("uiEvent")==="paste"&&!r,m=f.getMeta("uiEvent")==="drop"&&!a,g=f.getMeta("applyPasteRules"),M=!!g;if(!b&&!m&&!M)return;if(M){const{from:I,text:O}=g,$=I+O.length,J=gr(O);return l({rule:u,state:h,from:I,to:{b:$},pasteEvt:J})}const x=p.doc.content.findDiffStart(h.doc.content),L=p.doc.content.findDiffEnd(h.doc.content);if(!(!ur(x)||!L||x===L.b))return l({rule:u,state:h,from:x,to:L,pasteEvt:o})}}))}function br(t){const e=t.filter((n,s)=>t.indexOf(n)!==s);return Array.from(new Set(e))}class bt{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=bt.resolve(e),this.schema=ar(this.extensions,n),this.setupExtensions()}static resolve(e){const n=bt.sort(bt.flatten(e)),s=br(n.map(r=>r.name));return s.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${s.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const s={name:n.name,options:n.options,storage:n.storage},r=k(n,"addExtensions",s);return r?[n,...this.flatten(r())]:n}).flat(10)}static sort(e){return e.sort((s,r)=>{const a=k(s,"priority")||100,o=k(r,"priority")||100;return a>o?-1:a<o?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const s={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:ne(n.name,this.schema)},r=k(n,"addCommands",s);return r?{...e,...r()}:e},{})}get plugins(){const{editor:e}=this,n=bt.sort([...this.extensions].reverse()),s=[],r=[],a=n.map(o=>{const i={name:o.name,options:o.options,storage:o.storage,editor:e,type:ne(o.name,this.schema)},l=[],c=k(o,"addKeyboardShortcuts",i);let u={};if(o.type==="mark"&&k(o,"exitable",i)&&(u.ArrowRight=()=>Y.handleExit({editor:e,mark:o})),c){const b=Object.fromEntries(Object.entries(c()).map(([m,g])=>[m,()=>g({editor:e})]));u={...u,...b}}const d=As(u);l.push(d);const p=k(o,"addInputRules",i);ze(o,e.options.enableInputRules)&&p&&s.push(...p());const h=k(o,"addPasteRules",i);ze(o,e.options.enablePasteRules)&&h&&r.push(...h());const f=k(o,"addProseMirrorPlugins",i);if(f){const b=f();l.push(...b)}return l}).flat();return[dr({editor:e,rules:s}),...mr({editor:e,rules:r}),...a]}get attributes(){return Mn(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=qt(this.extensions);return Object.fromEntries(n.filter(s=>!!k(s,"addNodeView")).map(s=>{const r=this.attributes.filter(l=>l.type===s.name),a={name:s.name,options:s.options,storage:s.storage,editor:e,type:W(s.name,this.schema)},o=k(s,"addNodeView",a);if(!o)return[];const i=(l,c,u,d)=>{const p=ae(l,r);return o()({editor:e,node:l,getPos:u,decorations:d,HTMLAttributes:p,extension:s})};return[s.name,i]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const s={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:ne(e.name,this.schema)};e.type==="mark"&&(!((n=A(k(e,"keepOnSplit",s)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const r=k(e,"onBeforeCreate",s),a=k(e,"onCreate",s),o=k(e,"onUpdate",s),i=k(e,"onSelectionUpdate",s),l=k(e,"onTransaction",s),c=k(e,"onFocus",s),u=k(e,"onBlur",s),d=k(e,"onDestroy",s);r&&this.editor.on("beforeCreate",r),a&&this.editor.on("create",a),o&&this.editor.on("update",o),i&&this.editor.on("selectionUpdate",i),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}function yr(t){return Object.prototype.toString.call(t).slice(8,-1)}function _t(t){return yr(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Kt(t,e){const n={...t};return _t(t)&&_t(e)&&Object.keys(e).forEach(s=>{_t(e[s])&&_t(t[s])?n[s]=Kt(t[s],e[s]):n[s]=e[s]}),n}class F{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=A(k(this,"addOptions",{name:this.name}))),this.storage=A(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new F(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Kt(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new F({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=A(k(n,"addOptions",{name:n.name})),n.storage=A(k(n,"addStorage",{name:n.name,options:n.options})),n}}function wn(t,e,n){const{from:s,to:r}=e,{blockSeparator:a=`

`,textSerializers:o={}}=n||{};let i="";return t.nodesBetween(s,r,(l,c,u,d)=>{var p;l.isBlock&&c>s&&(i+=a);const h=o==null?void 0:o[l.type.name];if(h)return u&&(i+=h({node:l,pos:c,parent:u,index:d,range:e})),!1;l.isText&&(i+=(p=l==null?void 0:l.text)===null||p===void 0?void 0:p.slice(Math.max(s,c)-c,r-c))}),i}function En(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const vr=F.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new U({key:new K("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:s,selection:r}=e,{ranges:a}=r,o=Math.min(...a.map(u=>u.$from.pos)),i=Math.max(...a.map(u=>u.$to.pos)),l=En(n);return wn(s,{from:o,to:i},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),Mr=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),kr=(t=!1)=>({commands:e})=>e.setContent("",t),wr=()=>({state:t,tr:e,dispatch:n})=>{const{selection:s}=e,{ranges:r}=s;return n&&r.forEach(({$from:a,$to:o})=>{t.doc.nodesBetween(a.pos,o.pos,(i,l)=>{if(i.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),p=c.resolve(u.map(l+i.nodeSize)),h=d.blockRange(p);if(!h)return;const f=es(h);if(i.type.isTextblock){const{defaultType:b}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(h.start,b)}(f||f===0)&&e.lift(h,f)})}),!0},Er=t=>e=>t(e),xr=()=>({state:t,dispatch:e})=>ns(t,e),Tr=(t,e)=>({editor:n,tr:s})=>{const{state:r}=n,a=r.doc.slice(t.from,t.to);s.deleteRange(t.from,t.to);const o=s.mapping.map(e);return s.insert(o,a.content),s.setSelection(new Q(s.doc.resolve(o-1))),!0},Sr=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,s=n.$anchor.node();if(s.content.size>0)return!1;const r=t.selection.$anchor;for(let a=r.depth;a>0;a-=1)if(r.node(a).type===s.type){if(e){const i=r.before(a),l=r.after(a);t.delete(i,l).scrollIntoView()}return!0}return!1},Ar=t=>({tr:e,state:n,dispatch:s})=>{const r=W(t,n.schema),a=e.selection.$anchor;for(let o=a.depth;o>0;o-=1)if(a.node(o).type===r){if(s){const l=a.before(o),c=a.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},Cr=t=>({tr:e,dispatch:n})=>{const{from:s,to:r}=t;return n&&e.delete(s,r),!0},Or=()=>({state:t,dispatch:e})=>ss(t,e),Lr=()=>({commands:t})=>t.keyboardShortcut("Enter"),_r=()=>({state:t,dispatch:e})=>rs(t,e);function Bt(t,e,n={strict:!0}){const s=Object.keys(e);return s.length?s.every(r=>n.strict?e[r]===t[r]:ye(e[r])?e[r].test(t[r]):e[r]===t[r]):!0}function le(t,e,n={}){return t.find(s=>s.type===e&&Bt(s.attrs,n))}function Pr(t,e,n={}){return!!le(t,e,n)}function ve(t,e,n={}){if(!t||!e)return;let s=t.parent.childAfter(t.parentOffset);if(t.parentOffset===s.offset&&s.offset!==0&&(s=t.parent.childBefore(t.parentOffset)),!s.node)return;const r=le([...s.node.marks],e,n);if(!r)return;let a=s.index,o=t.start()+s.offset,i=a+1,l=o+s.node.nodeSize;for(le([...s.node.marks],e,n);a>0&&r.isInSet(t.parent.child(a-1).marks);)a-=1,o-=t.parent.child(a).nodeSize;for(;i<t.parent.childCount&&Pr([...t.parent.child(i).marks],e,n);)l+=t.parent.child(i).nodeSize,i+=1;return{from:o,to:l}}function at(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const Rr=(t,e={})=>({tr:n,state:s,dispatch:r})=>{const a=at(t,s.schema),{doc:o,selection:i}=n,{$from:l,from:c,to:u}=i;if(r){const d=ve(l,a,e);if(d&&d.from<=c&&d.to>=u){const p=Q.create(o,d.from,d.to);n.setSelection(p)}}return!0},Nr=t=>e=>{const n=typeof t=="function"?t(e):t;for(let s=0;s<n.length;s+=1)if(n[s](e))return!0;return!1};function Me(t){return t instanceof Q}function st(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function xn(t,e=null){if(!e)return null;const n=dt.atStart(t),s=dt.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return s;const r=n.from,a=s.to;return e==="all"?Q.create(t,st(0,r,a),st(t.content.size,r,a)):Q.create(t,st(e,r,a),st(e,r,a))}function Vt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Ir=(t=null,e={})=>({editor:n,view:s,tr:r,dispatch:a})=>{e={scrollIntoView:!0,...e};const o=()=>{Vt()&&s.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(s.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(s.hasFocus()&&t===null||t===!1)return!0;if(a&&t===null&&!Me(n.state.selection))return o(),!0;const i=xn(r.doc,t)||n.state.selection,l=n.state.selection.eq(i);return a&&(l||r.setSelection(i),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),o()),!0},Hr=(t,e)=>n=>t.every((s,r)=>e(s,{...n,index:r})),$r=(t,e)=>({tr:n,commands:s})=>s.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),Tn=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const s=e[n];s.nodeType===3&&s.nodeValue&&/^(\n\s\s|\n)$/.test(s.nodeValue)?t.removeChild(s):s.nodeType===1&&Tn(s)}return t};function Pt(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return Tn(n)}function Dt(t,e,n){n={slice:!0,parseOptions:{},...n};const s=typeof t=="object"&&t!==null,r=typeof t=="string";if(s)try{return Array.isArray(t)&&t.length>0?Ht.fromArray(t.map(o=>e.nodeFromJSON(o))):e.nodeFromJSON(t)}catch(a){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",a),Dt("",e,n)}if(r){if(n.errorOnInvalidContent){let o=!1,i="";const l=new gn({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,i=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?ee.fromSchema(l).parseSlice(Pt(t),n.parseOptions):ee.fromSchema(l).parse(Pt(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${i}`)})}const a=ee.fromSchema(e);return n.slice?a.parseSlice(Pt(t),n.parseOptions).content:a.parse(Pt(t),n.parseOptions)}return Dt("",e,n)}function Br(t,e,n){const s=t.steps.length-1;if(s<e)return;const r=t.steps[s];if(!(r instanceof Cs||r instanceof Os))return;const a=t.mapping.maps[s];let o=0;a.forEach((i,l,c,u)=>{o===0&&(o=u)}),t.setSelection(dt.near(t.doc.resolve(o),n))}const Dr=t=>!("type"in t),jr=(t,e,n)=>({tr:s,dispatch:r,editor:a})=>{var o;if(r){n={parseOptions:{},updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let i;try{i=Dt(e,a.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:(o=n.errorOnInvalidContent)!==null&&o!==void 0?o:a.options.enableContentCheck})}catch(f){return a.emit("contentError",{editor:a,error:f,disableCollaboration:()=>{console.error("[tiptap error]: Unable to disable collaboration at this point in time")}}),!1}let{from:l,to:c}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},u=!0,d=!0;if((Dr(i)?i:[i]).forEach(f=>{f.check(),u=u?f.isText&&f.marks.length===0:!1,d=d?f.isBlock:!1}),l===c&&d){const{parent:f}=s.doc.resolve(l);f.isTextblock&&!f.type.spec.code&&!f.childCount&&(l-=1,c+=1)}let h;u?(Array.isArray(e)?h=e.map(f=>f.text||"").join(""):typeof e=="object"&&e&&e.text?h=e.text:h=e,s.insertText(h,l,c)):(h=i,s.replaceWith(l,c,h)),n.updateSelection&&Br(s,s.steps.length-1,-1),n.applyInputRules&&s.setMeta("applyInputRules",{from:l,text:h}),n.applyPasteRules&&s.setMeta("applyPasteRules",{from:l,text:h})}return!0},Fr=()=>({state:t,dispatch:e})=>os(t,e),Wr=()=>({state:t,dispatch:e})=>is(t,e),zr=()=>({state:t,dispatch:e})=>as(t,e),Ur=()=>({state:t,dispatch:e})=>ls(t,e),qr=()=>({state:t,dispatch:e,tr:n})=>{try{const s=fn(t.doc,t.selection.$from.pos,-1);return s==null?!1:(n.join(s,2),e&&e(n),!0)}catch{return!1}},Kr=()=>({state:t,dispatch:e,tr:n})=>{try{const s=fn(t.doc,t.selection.$from.pos,1);return s==null?!1:(n.join(s,2),e&&e(n),!0)}catch{return!1}},Vr=()=>({state:t,dispatch:e})=>cs(t,e),Gr=()=>({state:t,dispatch:e})=>ds(t,e);function Sn(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Qr(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let s,r,a,o;for(let i=0;i<e.length-1;i+=1){const l=e[i];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))s=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))Vt()||Sn()?o=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return s&&(n=`Alt-${n}`),r&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),a&&(n=`Shift-${n}`),n}const Jr=t=>({editor:e,view:n,tr:s,dispatch:r})=>{const a=Qr(t).split(/-(?!$)/),o=a.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),i=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,i))});return l==null||l.steps.forEach(c=>{const u=c.map(s.mapping);u&&r&&s.maybeStep(u)}),!0};function kt(t,e,n={}){const{from:s,to:r,empty:a}=t.selection,o=e?W(e,t.schema):null,i=[];t.doc.nodesBetween(s,r,(d,p)=>{if(d.isText)return;const h=Math.max(s,p),f=Math.min(r,p+d.nodeSize);i.push({node:d,from:h,to:f})});const l=r-s,c=i.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>Bt(d.node.attrs,n,{strict:!1}));return a?!!c.length:c.reduce((d,p)=>d+p.to-p.from,0)>=l}const Xr=(t,e={})=>({state:n,dispatch:s})=>{const r=W(t,n.schema);return kt(n,r,e)?us(n,s):!1},Yr=()=>({state:t,dispatch:e})=>ps(t,e),Zr=t=>({state:e,dispatch:n})=>{const s=W(t,e.schema);return hs(s)(e,n)},to=()=>({state:t,dispatch:e})=>fs(t,e);function Gt(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Ue(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((s,r)=>(n.includes(r)||(s[r]=t[r]),s),{})}const eo=(t,e)=>({tr:n,state:s,dispatch:r})=>{let a=null,o=null;const i=Gt(typeof t=="string"?t:t.name,s.schema);return i?(i==="node"&&(a=W(t,s.schema)),i==="mark"&&(o=at(t,s.schema)),r&&n.selection.ranges.forEach(l=>{s.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{a&&a===c.type&&n.setNodeMarkup(u,void 0,Ue(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(d=>{o===d.type&&n.addMark(u,u+c.nodeSize,o.create(Ue(d.attrs,e)))})})}),!0):!1},no=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),so=()=>({tr:t,commands:e})=>e.setTextSelection({from:0,to:t.doc.content.size}),ro=()=>({state:t,dispatch:e})=>gs(t,e),oo=()=>({state:t,dispatch:e})=>ms(t,e),io=()=>({state:t,dispatch:e})=>bs(t,e),ao=()=>({state:t,dispatch:e})=>ys(t,e),lo=()=>({state:t,dispatch:e})=>vs(t,e);function ce(t,e,n={},s={}){return Dt(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:s.errorOnInvalidContent})}const co=(t,e=!1,n={},s={})=>({editor:r,tr:a,dispatch:o,commands:i})=>{var l,c;const{doc:u}=a;if(n.preserveWhitespace!=="full"){const d=ce(t,r.schema,n,{errorOnInvalidContent:(l=s.errorOnInvalidContent)!==null&&l!==void 0?l:r.options.enableContentCheck});return o&&a.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!e),!0}return o&&a.setMeta("preventUpdate",!e),i.insertContentAt({from:0,to:u.content.size},t,{parseOptions:n,errorOnInvalidContent:(c=s.errorOnInvalidContent)!==null&&c!==void 0?c:r.options.enableContentCheck})};function Qt(t,e){const n=at(e,t.schema),{from:s,to:r,empty:a}=t.selection,o=[];a?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(s,r,l=>{o.push(...l.marks)});const i=o.find(l=>l.type.name===n.name);return i?{...i.attrs}:{}}function uo(t,e){const n=new Ms(t);return e.forEach(s=>{s.steps.forEach(r=>{n.step(r)})}),n}function po(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function de(t,e){const n=[];return t.descendants((s,r)=>{e(s)&&n.push({node:s,pos:r})}),n}function ho(t,e,n){const s=[];return t.nodesBetween(e.from,e.to,(r,a)=>{n(r)&&s.push({node:r,pos:a})}),s}function An(t,e){for(let n=t.depth;n>0;n-=1){const s=t.node(n);if(e(s))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:s}}}function ke(t){return e=>An(e.$from,t)}function fo(t,e){const n=Ls.fromSchema(e).serializeFragment(t),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function go(t,e){const n={from:0,to:t.content.size};return wn(t,n,e)}function mo(t,e){const n=W(e,t.schema),{from:s,to:r}=t.selection,a=[];t.doc.nodesBetween(s,r,i=>{a.push(i)});const o=a.reverse().find(i=>i.type.name===n.name);return o?{...o.attrs}:{}}function Cn(t,e){const n=Gt(typeof e=="string"?e:e.name,t.schema);return n==="node"?mo(t,e):n==="mark"?Qt(t,e):{}}function bo(t,e=JSON.stringify){const n={};return t.filter(s=>{const r=e(s);return Object.prototype.hasOwnProperty.call(n,r)?!1:n[r]=!0})}function yo(t){const e=bo(t);return e.length===1?e:e.filter((n,s)=>!e.filter((a,o)=>o!==s).some(a=>n.oldRange.from>=a.oldRange.from&&n.oldRange.to<=a.oldRange.to&&n.newRange.from>=a.newRange.from&&n.newRange.to<=a.newRange.to))}function vo(t){const{mapping:e,steps:n}=t,s=[];return e.maps.forEach((r,a)=>{const o=[];if(r.ranges.length)r.forEach((i,l)=>{o.push({from:i,to:l})});else{const{from:i,to:l}=n[a];if(i===void 0||l===void 0)return;o.push({from:i,to:l})}o.forEach(({from:i,to:l})=>{const c=e.slice(a).map(i,-1),u=e.slice(a).map(l),d=e.invert().map(c,-1),p=e.invert().map(u);s.push({oldRange:{from:d,to:p},newRange:{from:c,to:u}})})}),yo(s)}function we(t,e,n){const s=[];return t===e?n.resolve(t).marks().forEach(r=>{const a=n.resolve(t),o=ve(a,r.type);o&&s.push({mark:r,...o})}):n.nodesBetween(t,e,(r,a)=>{!r||(r==null?void 0:r.nodeSize)===void 0||s.push(...r.marks.map(o=>({from:a,to:a+r.nodeSize,mark:o})))}),s}function $t(t,e,n){return Object.fromEntries(Object.entries(n).filter(([s])=>{const r=t.find(a=>a.type===e&&a.name===s);return r?r.attribute.keepOnSplit:!1}))}function ue(t,e,n={}){const{empty:s,ranges:r}=t.selection,a=e?at(e,t.schema):null;if(s)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>a?a.name===d.type.name:!0).find(d=>Bt(d.attrs,n,{strict:!1}));let o=0;const i=[];if(r.forEach(({$from:d,$to:p})=>{const h=d.pos,f=p.pos;t.doc.nodesBetween(h,f,(b,m)=>{if(!b.isText&&!b.marks.length)return;const g=Math.max(h,m),M=Math.min(f,m+b.nodeSize),x=M-g;o+=x,i.push(...b.marks.map(L=>({mark:L,from:g,to:M})))})}),o===0)return!1;const l=i.filter(d=>a?a.name===d.mark.type.name:!0).filter(d=>Bt(d.mark.attrs,n,{strict:!1})).reduce((d,p)=>d+p.to-p.from,0),c=i.filter(d=>a?d.mark.type!==a&&d.mark.type.excludes(a):!0).reduce((d,p)=>d+p.to-p.from,0);return(l>0?l+c:l)>=o}function Mo(t,e,n={}){if(!e)return kt(t,null,n)||ue(t,null,n);const s=Gt(e,t.schema);return s==="node"?kt(t,e,n):s==="mark"?ue(t,e,n):!1}function qe(t,e){const{nodeExtensions:n}=qt(e),s=n.find(o=>o.name===t);if(!s)return!1;const r={name:s.name,options:s.options,storage:s.storage},a=A(k(s,"group",r));return typeof a!="string"?!1:a.split(" ").includes("list")}function Ee(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var s;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((s=t.text)!==null&&s!==void 0?s:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let r=!0;return t.content.forEach(a=>{r!==!1&&(Ee(a,{ignoreWhitespace:n,checkChildren:e})||(r=!1))}),r}return!1}function On(t){return t instanceof yt}function ko(t,e,n){const r=t.state.doc.content.size,a=st(e,0,r),o=st(n,0,r),i=t.coordsAtPos(a),l=t.coordsAtPos(o,-1),c=Math.min(i.top,l.top),u=Math.max(i.bottom,l.bottom),d=Math.min(i.left,l.left),p=Math.max(i.right,l.right),h=p-d,f=u-c,g={top:c,bottom:u,left:d,right:p,width:h,height:f,x:d,y:c};return{...g,toJSON:()=>g}}function wo(t,e,n){var s;const{selection:r}=e;let a=null;if(Me(r)&&(a=r.$cursor),a){const i=(s=t.storedMarks)!==null&&s!==void 0?s:a.marks();return!!n.isInSet(i)||!i.some(l=>l.type.excludes(n))}const{ranges:o}=r;return o.some(({$from:i,$to:l})=>{let c=i.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(i.pos,l.pos,(u,d,p)=>{if(c)return!1;if(u.isInline){const h=!p||p.type.allowsMarkType(n),f=!!n.isInSet(u.marks)||!u.marks.some(b=>b.type.excludes(n));c=h&&f}return!c}),c})}const Eo=(t,e={})=>({tr:n,state:s,dispatch:r})=>{const{selection:a}=n,{empty:o,ranges:i}=a,l=at(t,s.schema);if(r)if(o){const c=Qt(s,l);n.addStoredMark(l.create({...c,...e}))}else i.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;s.doc.nodesBetween(u,d,(p,h)=>{const f=Math.max(h,u),b=Math.min(h+p.nodeSize,d);p.marks.find(g=>g.type===l)?p.marks.forEach(g=>{l===g.type&&n.addMark(f,b,l.create({...g.attrs,...e}))}):n.addMark(f,b,l.create(e))})});return wo(s,n,l)},xo=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),To=(t,e={})=>({state:n,dispatch:s,chain:r})=>{const a=W(t,n.schema);return a.isTextblock?r().command(({commands:o})=>Re(a,e)(n)?!0:o.clearNodes()).command(({state:o})=>Re(a,e)(o,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},So=t=>({tr:e,dispatch:n})=>{if(n){const{doc:s}=e,r=st(t,0,s.content.size),a=yt.create(s,r);e.setSelection(a)}return!0},Ao=t=>({tr:e,dispatch:n})=>{if(n){const{doc:s}=e,{from:r,to:a}=typeof t=="number"?{from:t,to:t}:t,o=Q.atStart(s).from,i=Q.atEnd(s).to,l=st(r,o,i),c=st(a,o,i),u=Q.create(s,l,c);e.setSelection(u)}return!0},Co=t=>({state:e,dispatch:n})=>{const s=W(t,e.schema);return ks(s)(e,n)};function Ke(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const s=n.filter(r=>e==null?void 0:e.includes(r.type.name));t.tr.ensureMarks(s)}}const Oo=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:s,editor:r})=>{const{selection:a,doc:o}=e,{$from:i,$to:l}=a,c=r.extensionManager.attributes,u=$t(c,i.node().type.name,i.node().attrs);if(a instanceof yt&&a.node.isBlock)return!i.parentOffset||!It(o,i.pos)?!1:(s&&(t&&Ke(n,r.extensionManager.splittableMarks),e.split(i.pos).scrollIntoView()),!0);if(!i.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,p=i.depth===0?void 0:po(i.node(-1).contentMatchAt(i.indexAfter(-1)));let h=d&&p?[{type:p,attrs:u}]:void 0,f=It(e.doc,e.mapping.map(i.pos),1,h);if(!h&&!f&&It(e.doc,e.mapping.map(i.pos),1,p?[{type:p}]:void 0)&&(f=!0,h=p?[{type:p,attrs:u}]:void 0),s){if(f&&(a instanceof Q&&e.deleteSelection(),e.split(e.mapping.map(i.pos),1,h),p&&!d&&!i.parentOffset&&i.parent.type!==p)){const b=e.mapping.map(i.before()),m=e.doc.resolve(b);i.node(-1).canReplaceWith(m.index(),m.index()+1,p)&&e.setNodeMarkup(e.mapping.map(i.before()),p)}t&&Ke(n,r.extensionManager.splittableMarks),e.scrollIntoView()}return f},Lo=t=>({tr:e,state:n,dispatch:s,editor:r})=>{var a;const o=W(t,n.schema),{$from:i,$to:l}=n.selection,c=n.selection.node;if(c&&c.isBlock||i.depth<2||!i.sameParent(l))return!1;const u=i.node(-1);if(u.type!==o)return!1;const d=r.extensionManager.attributes;if(i.parent.content.size===0&&i.node(-1).childCount===i.indexAfter(-1)){if(i.depth===2||i.node(-3).type!==o||i.index(-2)!==i.node(-2).childCount-1)return!1;if(s){let m=Ht.empty;const g=i.index(-1)?1:i.index(-2)?2:3;for(let $=i.depth-g;$>=i.depth-3;$-=1)m=Ht.from(i.node($).copy(m));const M=i.indexAfter(-1)<i.node(-2).childCount?1:i.indexAfter(-2)<i.node(-3).childCount?2:3,x=$t(d,i.node().type.name,i.node().attrs),L=((a=o.contentMatch.defaultType)===null||a===void 0?void 0:a.createAndFill(x))||void 0;m=m.append(Ht.from(o.createAndFill(null,L)||void 0));const I=i.before(i.depth-(g-1));e.replace(I,i.after(-M),new ws(m,4-g,0));let O=-1;e.doc.nodesBetween(I,e.doc.content.size,($,J)=>{if(O>-1)return!1;$.isTextblock&&$.content.size===0&&(O=J+1)}),O>-1&&e.setSelection(Q.near(e.doc.resolve(O))),e.scrollIntoView()}return!0}const p=l.pos===i.end()?u.contentMatchAt(0).defaultType:null,h=$t(d,u.type.name,u.attrs),f=$t(d,i.node().type.name,i.node().attrs);e.delete(i.pos,l.pos);const b=p?[{type:o,attrs:h},{type:p,attrs:f}]:[{type:o,attrs:h}];if(!It(e.doc,i.pos,2))return!1;if(s){const{selection:m,storedMarks:g}=n,{splittableMarks:M}=r.extensionManager,x=g||m.$to.parentOffset&&m.$from.marks();if(e.split(i.pos,2,b).scrollIntoView(),!x||!s)return!0;const L=x.filter(I=>M.includes(I.type.name));e.ensureMarks(L)}return!0},se=(t,e)=>{const n=ke(o=>o.type===e)(t.selection);if(!n)return!0;const s=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(s===void 0)return!0;const r=t.doc.nodeAt(s);return n.node.type===(r==null?void 0:r.type)&&he(t.doc,n.pos)&&t.join(n.pos),!0},re=(t,e)=>{const n=ke(o=>o.type===e)(t.selection);if(!n)return!0;const s=t.doc.resolve(n.start).after(n.depth);if(s===void 0)return!0;const r=t.doc.nodeAt(s);return n.node.type===(r==null?void 0:r.type)&&he(t.doc,s)&&t.join(s),!0},_o=(t,e,n,s={})=>({editor:r,tr:a,state:o,dispatch:i,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:p}=r.extensionManager,h=W(t,o.schema),f=W(e,o.schema),{selection:b,storedMarks:m}=o,{$from:g,$to:M}=b,x=g.blockRange(M),L=m||b.$to.parentOffset&&b.$from.marks();if(!x)return!1;const I=ke(O=>qe(O.type.name,d))(b);if(x.depth>=1&&I&&x.depth-I.depth<=1){if(I.node.type===h)return c.liftListItem(f);if(qe(I.node.type.name,d)&&h.validContent(I.node.content)&&i)return l().command(()=>(a.setNodeMarkup(I.pos,h),!0)).command(()=>se(a,h)).command(()=>re(a,h)).run()}return!n||!L||!i?l().command(()=>u().wrapInList(h,s)?!0:c.clearNodes()).wrapInList(h,s).command(()=>se(a,h)).command(()=>re(a,h)).run():l().command(()=>{const O=u().wrapInList(h,s),$=L.filter(J=>p.includes(J.type.name));return a.ensureMarks($),O?!0:c.clearNodes()}).wrapInList(h,s).command(()=>se(a,h)).command(()=>re(a,h)).run()},Po=(t,e={},n={})=>({state:s,commands:r})=>{const{extendEmptyMarkRange:a=!1}=n,o=at(t,s.schema);return ue(s,o,e)?r.unsetMark(o,{extendEmptyMarkRange:a}):r.setMark(o,e)},Ro=(t,e,n={})=>({state:s,commands:r})=>{const a=W(t,s.schema),o=W(e,s.schema);return kt(s,a,n)?r.setNode(o):r.setNode(a,n)},No=(t,e={})=>({state:n,commands:s})=>{const r=W(t,n.schema);return kt(n,r,e)?s.lift(r):s.wrapIn(r,e)},Io=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let s=0;s<n.length;s+=1){const r=n[s];let a;if(r.spec.isInputRules&&(a=r.getState(t))){if(e){const o=t.tr,i=a.transform;for(let l=i.steps.length-1;l>=0;l-=1)o.step(i.steps[l].invert(i.docs[l]));if(a.text){const l=o.doc.resolve(a.from).marks();o.replaceWith(a.from,a.to,t.schema.text(a.text,l))}else o.delete(a.from,a.to)}return!0}}return!1},Ho=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:s,ranges:r}=n;return s||e&&r.forEach(a=>{t.removeMark(a.$from.pos,a.$to.pos)}),!0},$o=(t,e={})=>({tr:n,state:s,dispatch:r})=>{var a;const{extendEmptyMarkRange:o=!1}=e,{selection:i}=n,l=at(t,s.schema),{$from:c,empty:u,ranges:d}=i;if(!r)return!0;if(u&&o){let{from:p,to:h}=i;const f=(a=c.marks().find(m=>m.type===l))===null||a===void 0?void 0:a.attrs,b=ve(c,l,f);b&&(p=b.from,h=b.to),n.removeMark(p,h,l)}else d.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,l)});return n.removeStoredMark(l),!0},Bo=(t,e={})=>({tr:n,state:s,dispatch:r})=>{let a=null,o=null;const i=Gt(typeof t=="string"?t:t.name,s.schema);return i?(i==="node"&&(a=W(t,s.schema)),i==="mark"&&(o=at(t,s.schema)),r&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;s.doc.nodesBetween(c,u,(d,p)=>{a&&a===d.type&&n.setNodeMarkup(p,void 0,{...d.attrs,...e}),o&&d.marks.length&&d.marks.forEach(h=>{if(o===h.type){const f=Math.max(p,c),b=Math.min(p+d.nodeSize,u);n.addMark(f,b,o.create({...h.attrs,...e}))}})})}),!0):!1},Do=(t,e={})=>({state:n,dispatch:s})=>{const r=W(t,n.schema);return Es(r,e)(n,s)},jo=(t,e={})=>({state:n,dispatch:s})=>{const r=W(t,n.schema);return xs(r,e)(n,s)};var Fo=Object.freeze({__proto__:null,blur:Mr,clearContent:kr,clearNodes:wr,command:Er,createParagraphNear:xr,cut:Tr,deleteCurrentNode:Sr,deleteNode:Ar,deleteRange:Cr,deleteSelection:Or,enter:Lr,exitCode:_r,extendMarkRange:Rr,first:Nr,focus:Ir,forEach:Hr,insertContent:$r,insertContentAt:jr,joinBackward:zr,joinDown:Wr,joinForward:Ur,joinItemBackward:qr,joinItemForward:Kr,joinTextblockBackward:Vr,joinTextblockForward:Gr,joinUp:Fr,keyboardShortcut:Jr,lift:Xr,liftEmptyBlock:Yr,liftListItem:Zr,newlineInCode:to,resetAttributes:eo,scrollIntoView:no,selectAll:so,selectNodeBackward:ro,selectNodeForward:oo,selectParentNode:io,selectTextblockEnd:ao,selectTextblockStart:lo,setContent:co,setMark:Eo,setMeta:xo,setNode:To,setNodeSelection:So,setTextSelection:Ao,sinkListItem:Co,splitBlock:Oo,splitListItem:Lo,toggleList:_o,toggleMark:Po,toggleNode:Ro,toggleWrap:No,undoInputRule:Io,unsetAllMarks:Ho,unsetMark:$o,updateAttributes:Bo,wrapIn:Do,wrapInList:jo});const Wo=F.create({name:"commands",addCommands(){return{...Fo}}}),zo=F.create({name:"editable",addProseMirrorPlugins(){return[new U({key:new K("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Uo=F.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new U({key:new K("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const s=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(s),!1},blur:(e,n)=>{t.isFocused=!1;const s=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(s),!1}}}})]}}),qo=F.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:i})=>{const{selection:l,doc:c}=i,{empty:u,$anchor:d}=l,{pos:p,parent:h}=d,f=d.parent.isTextblock&&p>0?i.doc.resolve(p-1):d,b=f.parent.type.spec.isolating,m=d.pos-d.parentOffset,g=b&&f.parent.childCount===1?m===d.pos:dt.atStart(c).from===p;return!u||!h.type.isTextblock||h.textContent.length||!g||g&&d.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},r={...s},a={...s,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Vt()||Sn()?a:r},addProseMirrorPlugins(){return[new U({key:new K("clearDocument"),appendTransaction:(t,e,n)=>{if(!(t.some(f=>f.docChanged)&&!e.doc.eq(n.doc)))return;const{empty:r,from:a,to:o}=e.selection,i=dt.atStart(e.doc).from,l=dt.atEnd(e.doc).to;if(r||!(a===i&&o===l)||!(n.doc.textBetween(0,n.doc.content.size," "," ").length===0))return;const d=n.tr,p=zt({state:n,transaction:d}),{commands:h}=new Ut({editor:this.editor,state:p});if(h.clearNodes(),!!d.steps.length)return d}})]}}),Ko=F.create({name:"tabindex",addProseMirrorPlugins(){return[new U({key:new K("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class ct{get name(){return this.node.type.name}constructor(e,n,s=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=s,this.resolvedPos=e,this.editor=n,this.currentNode=r}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,s=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,s=this.to-1}this.editor.commands.insertContentAt({from:n,to:s},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new ct(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new ct(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new ct(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,s)=>{const r=n.isBlock&&!n.isTextblock,a=this.pos+s+1,o=this.resolvedPos.doc.resolve(a);if(!r&&o.depth<=this.depth)return;const i=new ct(o,this.editor,r,r?n:null);r&&(i.actualDepth=this.depth+1),e.push(new ct(o,this.editor,r,r?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let s=null,r=this.parent;for(;r&&!s;){if(r.node.type.name===e)if(Object.keys(n).length>0){const a=r.node.attrs,o=Object.keys(n);for(let i=0;i<o.length;i+=1){const l=o[i];if(a[l]!==n[l])break}}else s=r;r=r.parent}return s}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},s=!1){let r=[];if(!this.children||this.children.length===0)return r;const a=Object.keys(n);return this.children.forEach(o=>{s&&r.length>0||(o.node.type.name===e&&a.every(l=>n[l]===o.node.attrs[l])&&r.push(o),!(s&&r.length>0)&&(r=r.concat(o.querySelectorAll(e,n,s))))}),r}setAttribute(e){const n=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,e).setTextSelection(n.from).run()}}const Vo=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function Go(t,e,n){const s=document.querySelector("style[data-tiptap-style]");if(s!==null)return s;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}let Qo=class extends rr{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n}},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=Go(Vo,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const s=kn(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:s});this.view.updateState(r)}unregisterPlugin(e){if(this.isDestroyed)return;const n=typeof e=="string"?`${e}$`:e.key,s=this.state.reconfigure({plugins:this.state.plugins.filter(r=>!r.key.startsWith(n))});this.view.updateState(s)}createExtensionManager(){var e,n;const r=[...this.options.enableCoreExtensions?[zo,vr.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),Wo,Uo,qo,Ko]:[],...this.options.extensions].filter(a=>["extension","node","mark"].includes(a==null?void 0:a.type));this.extensionManager=new bt(r,this)}createCommandManager(){this.commandManager=new Ut({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){let e;try{e=ce(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(a){if(!(a instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(a.message))throw a;this.emit("contentError",{editor:this,error:a,disableCollaboration:()=>{this.options.extensions=this.options.extensions.filter(o=>o.name!=="collaboration"),this.createExtensionManager()}}),e=ce(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const n=xn(e,this.options.autofocus);this.view=new Ts(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:Ss.create({doc:e,selection:n||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var i;return(i=this.capturedTransaction)===null||i===void 0?void 0:i.step(o)});return}const n=this.state.apply(e),s=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),s&&this.emit("selectionUpdate",{editor:this,transaction:e});const r=e.getMeta("focus"),a=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:e}),a&&this.emit("blur",{editor:this,event:a.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return Cn(this.state,e)}isActive(e,n){const s=typeof e=="string"?e:null,r=typeof e=="string"?n:e;return Mo(this.state,s,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return fo(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:s={}}=e||{};return go(this.state.doc,{blockSeparator:n,textSerializers:{...En(this.schema),...s}})}get isEmpty(){return Ee(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var s;return((s=this.$doc)===null||s===void 0?void 0:s.querySelector(e,n))||null}$nodes(e,n){var s;return((s=this.$doc)===null||s===void 0?void 0:s.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new ct(n,this)}get $doc(){return this.$pos(0)}};function pt(t){return new xt({find:t.find,handler:({state:e,range:n,match:s})=>{const r=A(t.getAttributes,void 0,s);if(r===!1||r===null)return null;const{tr:a}=e,o=s[s.length-1],i=s[0];if(o){const l=i.search(/\S/),c=n.from+i.indexOf(o),u=c+o.length;if(we(n.from,n.to,e.doc).filter(h=>h.mark.type.excluded.find(b=>b===t.type&&b!==h.mark.type)).filter(h=>h.to>c).length)return null;u<n.to&&a.delete(u,n.to),c>n.from&&a.delete(n.from+l,c);const p=n.from+l+o.length;a.addMark(n.from+l,p,t.type.create(r||{})),a.removeStoredMark(t.type)}}})}function Ln(t){return new xt({find:t.find,handler:({state:e,range:n,match:s})=>{const r=A(t.getAttributes,void 0,s)||{},{tr:a}=e,o=n.from;let i=n.to;const l=t.type.create(r);if(s[1]){const c=s[0].lastIndexOf(s[1]);let u=o+c;u>i?u=i:i=u+s[1].length;const d=s[0][s[0].length-1];a.insertText(d,o+s[0].length-1),a.replaceWith(u,i,l)}else if(s[0]){const c=t.type.isInline?o:o-1;a.insert(c,t.type.create(r)).delete(a.mapping.map(o),a.mapping.map(i))}a.scrollIntoView()}})}function pe(t){return new xt({find:t.find,handler:({state:e,range:n,match:s})=>{const r=e.doc.resolve(n.from),a=A(t.getAttributes,void 0,s)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,a)}})}function D(t){return new xt({find:t.find,handler:({state:e,range:n,match:s})=>{let r=t.replace,a=n.from;const o=n.to;if(s[1]){const i=s[0].lastIndexOf(s[1]);r+=s[0].slice(i+s[1].length),a+=i;const l=a-o;l>0&&(r=s[0].slice(i-l,i)+r,a=o)}e.tr.insertText(r,a,o)}})}function vt(t){return new xt({find:t.find,handler:({state:e,range:n,match:s,chain:r})=>{const a=A(t.getAttributes,void 0,s)||{},o=e.tr.delete(n.from,n.to),l=o.doc.resolve(n.from).blockRange(),c=l&&ts(l,t.type,a);if(!c)return null;if(o.wrap(l,c),t.keepMarks&&t.editor){const{selection:d,storedMarks:p}=e,{splittableMarks:h}=t.editor.extensionManager,f=p||d.$to.parentOffset&&d.$from.marks();if(f){const b=f.filter(m=>h.includes(m.type.name));o.ensureMarks(b)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(d,a).run()}const u=o.doc.resolve(n.from-1).nodeBefore;u&&u.type===t.type&&he(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(s,u))&&o.join(n.from-1)}})}class Y{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=A(k(this,"addOptions",{name:this.name}))),this.storage=A(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Y(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Kt(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Y(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=A(k(n,"addOptions",{name:n.name})),n.storage=A(k(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:s}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){const o=r.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&s.removeStoredMark(l),s.insertText(" ",r.pos),e.view.dispatch(s),!0}return!1}}class B{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=A(k(this,"addOptions",{name:this.name}))),this.storage=A(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new B(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Kt(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new B(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=A(k(n,"addOptions",{name:n.name})),n.storage=A(k(n,"addStorage",{name:n.name,options:n.options})),n}}function Jo(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}class Xo{constructor(e,n,s){this.isDragging=!1,this.component=e,this.editor=n.editor,this.options={stopEvent:null,ignoreMutation:null,...s},this.extension=n.extension,this.node=n.node,this.decorations=n.decorations,this.getPos=n.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(e){var n,s,r,a,o,i,l;const{view:c}=this.editor,u=e.target,d=u.nodeType===3?(n=u.parentElement)===null||n===void 0?void 0:n.closest("[data-drag-handle]"):u.closest("[data-drag-handle]");if(!this.dom||!((s=this.contentDOM)===null||s===void 0)&&s.contains(u)||!d)return;let p=0,h=0;if(this.dom!==d){const m=this.dom.getBoundingClientRect(),g=d.getBoundingClientRect(),M=(r=e.offsetX)!==null&&r!==void 0?r:(a=e.nativeEvent)===null||a===void 0?void 0:a.offsetX,x=(o=e.offsetY)!==null&&o!==void 0?o:(i=e.nativeEvent)===null||i===void 0?void 0:i.offsetY;p=g.x-m.x+M,h=g.y-m.y+x}(l=e.dataTransfer)===null||l===void 0||l.setDragImage(this.dom,p,h);const f=yt.create(c.state.doc,this.getPos()),b=c.state.tr.setSelection(f);c.dispatch(b)}stopEvent(e){var n;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:e});const s=e.target;if(!(this.dom.contains(s)&&!(!((n=this.contentDOM)===null||n===void 0)&&n.contains(s))))return!1;const a=e.type.startsWith("drag"),o=e.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(s.tagName)||s.isContentEditable)&&!o&&!a)return!0;const{isEditable:l}=this.editor,{isDragging:c}=this,u=!!this.node.type.spec.draggable,d=yt.isSelectable(this.node),p=e.type==="copy",h=e.type==="paste",f=e.type==="cut",b=e.type==="mousedown";if(!u&&d&&a&&e.preventDefault(),u&&a&&!c)return e.preventDefault(),!1;if(u&&l&&!c&&b){const m=s.closest("[data-drag-handle]");m&&(this.dom===m||this.dom.contains(m))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(c||o||p||h||f||b&&d)}ignoreMutation(e){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:e}):this.node.isLeaf||this.node.isAtom?!0:e.type==="selection"||this.dom.contains(e.target)&&e.type==="childList"&&(Vt()||Jo())&&this.editor.isFocused&&[...Array.from(e.addedNodes),...Array.from(e.removedNodes)].every(s=>s.isContentEditable)?!1:this.contentDOM===e.target&&e.type==="attributes"?!0:!this.contentDOM.contains(e.target)}updateAttributes(e){this.editor.commands.command(({tr:n})=>{const s=this.getPos();return n.setNodeMarkup(s,void 0,{...this.node.attrs,...e}),!0})}deleteNode(){const e=this.getPos(),n=e+this.node.nodeSize;this.editor.commands.deleteRange({from:e,to:n})}}function it(t){return new pr({find:t.find,handler:({state:e,range:n,match:s,pasteEvent:r})=>{const a=A(t.getAttributes,void 0,s,r);if(a===!1||a===null)return null;const{tr:o}=e,i=s[s.length-1],l=s[0];let c=n.to;if(i){const u=l.search(/\S/),d=n.from+l.indexOf(i),p=d+i.length;if(we(n.from,n.to,e.doc).filter(f=>f.mark.type.excluded.find(m=>m===t.type&&m!==f.mark.type)).filter(f=>f.to>d).length)return null;p<n.to&&o.delete(p,n.to),d>n.from&&o.delete(n.from+u,d),c=n.from+u+i.length,o.addMark(n.from+u,c,t.type.create(a||{})),o.removeStoredMark(t.type)}}})}function Yo(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}const Zo=B.create({name:"doc",topNode:!0,content:"block+"}),ti=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,ei=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,xl=Y.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:t=>t.getAttribute("data-color")||t.style.backgroundColor,renderHTML:t=>t.color?{"data-color":t.color,style:`background-color: ${t.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:t}){return["mark",R(this.options.HTMLAttributes,t),0]},addCommands(){return{setHighlight:t=>({commands:e})=>e.setMark(this.name,t),toggleHighlight:t=>({commands:e})=>e.toggleMark(this.name,t),unsetHighlight:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[pt({find:ti,type:this.type})]},addPasteRules(){return[it({find:ei,type:this.type})]}}),ni=t=>D({find:/--$/,replace:t??"—"}),si=t=>D({find:/\.\.\.$/,replace:t??"…"}),ri=t=>D({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:t??"“"}),oi=t=>D({find:/"$/,replace:t??"”"}),ii=t=>D({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:t??"‘"}),ai=t=>D({find:/'$/,replace:t??"’"}),li=t=>D({find:/<-$/,replace:t??"←"}),ci=t=>D({find:/->$/,replace:t??"→"}),di=t=>D({find:/\(c\)$/,replace:t??"©"}),ui=t=>D({find:/\(tm\)$/,replace:t??"™"}),pi=t=>D({find:/\(sm\)$/,replace:t??"℠"}),hi=t=>D({find:/\(r\)$/,replace:t??"®"}),fi=t=>D({find:/(?:^|\s)(1\/2)\s$/,replace:t??"½"}),gi=t=>D({find:/\+\/-$/,replace:t??"±"}),mi=t=>D({find:/!=$/,replace:t??"≠"}),bi=t=>D({find:/<<$/,replace:t??"«"}),yi=t=>D({find:/>>$/,replace:t??"»"}),vi=t=>D({find:/\d+\s?([*x])\s?\d+$/,replace:t??"×"}),Mi=t=>D({find:/\^2$/,replace:t??"²"}),ki=t=>D({find:/\^3$/,replace:t??"³"}),wi=t=>D({find:/(?:^|\s)(1\/4)\s$/,replace:t??"¼"}),Ei=t=>D({find:/(?:^|\s)(3\/4)\s$/,replace:t??"¾"}),Tl=F.create({name:"typography",addOptions(){return{closeDoubleQuote:"”",closeSingleQuote:"’",copyright:"©",ellipsis:"…",emDash:"—",laquo:"«",leftArrow:"←",multiplication:"×",notEqual:"≠",oneHalf:"½",oneQuarter:"¼",openDoubleQuote:"“",openSingleQuote:"‘",plusMinus:"±",raquo:"»",registeredTrademark:"®",rightArrow:"→",servicemark:"℠",superscriptThree:"³",superscriptTwo:"²",threeQuarters:"¾",trademark:"™"}},addInputRules(){const t=[];return this.options.emDash!==!1&&t.push(ni(this.options.emDash)),this.options.ellipsis!==!1&&t.push(si(this.options.ellipsis)),this.options.openDoubleQuote!==!1&&t.push(ri(this.options.openDoubleQuote)),this.options.closeDoubleQuote!==!1&&t.push(oi(this.options.closeDoubleQuote)),this.options.openSingleQuote!==!1&&t.push(ii(this.options.openSingleQuote)),this.options.closeSingleQuote!==!1&&t.push(ai(this.options.closeSingleQuote)),this.options.leftArrow!==!1&&t.push(li(this.options.leftArrow)),this.options.rightArrow!==!1&&t.push(ci(this.options.rightArrow)),this.options.copyright!==!1&&t.push(di(this.options.copyright)),this.options.trademark!==!1&&t.push(ui(this.options.trademark)),this.options.servicemark!==!1&&t.push(pi(this.options.servicemark)),this.options.registeredTrademark!==!1&&t.push(hi(this.options.registeredTrademark)),this.options.oneHalf!==!1&&t.push(fi(this.options.oneHalf)),this.options.plusMinus!==!1&&t.push(gi(this.options.plusMinus)),this.options.notEqual!==!1&&t.push(mi(this.options.notEqual)),this.options.laquo!==!1&&t.push(bi(this.options.laquo)),this.options.raquo!==!1&&t.push(yi(this.options.raquo)),this.options.multiplication!==!1&&t.push(vi(this.options.multiplication)),this.options.superscriptTwo!==!1&&t.push(Mi(this.options.superscriptTwo)),this.options.superscriptThree!==!1&&t.push(ki(this.options.superscriptThree)),this.options.oneQuarter!==!1&&t.push(wi(this.options.oneQuarter)),this.options.threeQuarters!==!1&&t.push(Ei(this.options.threeQuarters)),t}}),xi=/^\s*>\s$/,Ti=B.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",R(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[vt({find:xi,type:this.type})]}}),Si=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Ai=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Ci=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Oi=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Li=Y.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",R(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[pt({find:Si,type:this.type}),pt({find:Ci,type:this.type})]},addPasteRules(){return[it({find:Ai,type:this.type}),it({find:Oi,type:this.type})]}}),_i=B.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",R(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Ve=Y.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["span",R(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{const n=Qt(t,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:e.unsetMark(this.name)}}}}),Ge=/^\s*([-+*])\s$/,Pi=B.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",R(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(_i.name,this.editor.getAttributes(Ve.name)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=vt({find:Ge,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=vt({find:Ge,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Ve.name),editor:this.editor})),[t]}}),Ri=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))$/,Ni=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))/g,Ii=Y.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",R(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[pt({find:Ri,type:this.type})]},addPasteRules(){return[it({find:Ni,type:this.type})]}}),Hi=/^```([a-z]+)?[\s\n]$/,$i=/^~~~([a-z]+)?[\s\n]$/,_n=B.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,a=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",R(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:s,empty:r}=n;if(!r||s.parent.type!==this.type)return!1;const a=s.parentOffset===s.parent.nodeSize-2,o=s.parent.textContent.endsWith(`

`);return!a||!o?!1:t.chain().command(({tr:i})=>(i.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:s}=e,{$from:r,empty:a}=n;if(!a||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const i=r.after();return i===void 0?!1:s.nodeAt(i)?t.commands.command(({tr:c})=>(c.setSelection(dt.near(s.resolve(i))),!0)):t.commands.exitCode()}}},addInputRules(){return[pe({find:Hi,type:this.type,getAttributes:t=>({language:t[1]})}),pe({find:$i,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new U({key:new K("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),s=e.clipboardData.getData("vscode-editor-data"),r=s?JSON.parse(s):void 0,a=r==null?void 0:r.mode;if(!n||!a)return!1;const{tr:o,schema:i}=t.state,l=i.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:a},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(Q.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),Bi=F.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[_s(this.options)]}}),Di=F.create({name:"gapCursor",addProseMirrorPlugins(){return[Ps()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=A(k(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),ji=B.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",R(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:s})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:r,storedMarks:a}=n;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:i}=s.extensionManager,l=a||r.$to.parentOffset&&r.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const d=l.filter(p=>i.includes(p.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Fi=B.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,R(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>pe({find:new RegExp(`^(#{1,${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),Wi=F.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>Rs(t,e),redo:()=>({state:t,dispatch:e})=>Ns(t,e)}},addProseMirrorPlugins(){return[Is(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),zi=B.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",R(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{const{selection:n}=e,{$from:s,$to:r}=n,a=t();return s.parentOffset===0?a.insertContentAt({from:Math.max(s.pos-1,0),to:r.pos},{type:this.name}):On(n)?a.insertContentAt(r.pos,{type:this.name}):a.insertContent({type:this.name}),a.command(({tr:o,dispatch:i})=>{var l;if(i){const{$to:c}=o.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?o.setSelection(Q.create(o.doc,c.pos+1)):c.nodeAfter.isBlock?o.setSelection(yt.create(o.doc,c.pos)):o.setSelection(Q.create(o.doc,c.pos));else{const d=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();d&&(o.insert(u,d),o.setSelection(Q.create(o.doc,u+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Ln({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),Ui=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,qi=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Ki=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Vi=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Gi=Y.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",R(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[pt({find:Ui,type:this.type}),pt({find:Ki,type:this.type})]},addPasteRules(){return[it({find:qi,type:this.type}),it({find:Vi,type:this.type})]}}),Qi=B.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",R(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Ji=B.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",R(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Qe=Y.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["span",R(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{const n=Qt(t,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:e.unsetMark(this.name)}}}}),Je=/^(\d+)\.\s$/,Xi=B.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",R(this.options.HTMLAttributes,n),0]:["ol",R(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Ji.name,this.editor.getAttributes(Qe.name)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=vt({find:Je,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=vt({find:Je,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Qe.name)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),Yi=B.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",R(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Zi=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,ta=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,ea=Y.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",R(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[pt({find:Zi,type:this.type})]},addPasteRules(){return[it({find:ta,type:this.type})]}}),na=B.create({name:"text",group:"inline"}),Sl=F.create({name:"starterKit",addExtensions(){var t,e,n,s,r,a,o,i,l,c,u,d,p,h,f,b,m,g;const M=[];return this.options.bold!==!1&&M.push(Li.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.blockquote!==!1&&M.push(Ti.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bulletList!==!1&&M.push(Pi.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&M.push(Ii.configure((s=this.options)===null||s===void 0?void 0:s.code)),this.options.codeBlock!==!1&&M.push(_n.configure((r=this.options)===null||r===void 0?void 0:r.codeBlock)),this.options.document!==!1&&M.push(Zo.configure((a=this.options)===null||a===void 0?void 0:a.document)),this.options.dropcursor!==!1&&M.push(Bi.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&M.push(Di.configure((i=this.options)===null||i===void 0?void 0:i.gapcursor)),this.options.hardBreak!==!1&&M.push(ji.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&M.push(Fi.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&M.push(Wi.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&M.push(zi.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&M.push(Gi.configure((p=this.options)===null||p===void 0?void 0:p.italic)),this.options.listItem!==!1&&M.push(Qi.configure((h=this.options)===null||h===void 0?void 0:h.listItem)),this.options.orderedList!==!1&&M.push(Xi.configure((f=this.options)===null||f===void 0?void 0:f.orderedList)),this.options.paragraph!==!1&&M.push(Yi.configure((b=this.options)===null||b===void 0?void 0:b.paragraph)),this.options.strike!==!1&&M.push(ea.configure((m=this.options)===null||m===void 0?void 0:m.strike)),this.options.text!==!1&&M.push(na.configure((g=this.options)===null||g===void 0?void 0:g.text)),M}}),Al=F.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new U({key:new K("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:s}=e,r=[];if(!n)return null;const a=this.editor.isEmpty;return t.descendants((o,i)=>{const l=s>=i&&s<=i+o.nodeSize,c=!o.isLeaf&&Ee(o);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];a&&u.push(this.options.emptyEditorClass);const d=fe.node(i,i+o.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:i,hasAnchor:l}):this.options.placeholder});r.push(d)}return this.options.includeChildren}),ge.create(t,r)}}})]}});function sa(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Pn(t){return t instanceof Map?t.clear=t.delete=t.set=function(){throw new Error("map is read-only")}:t instanceof Set&&(t.add=t.clear=t.delete=function(){throw new Error("set is read-only")}),Object.freeze(t),Object.getOwnPropertyNames(t).forEach(e=>{const n=t[e],s=typeof n;(s==="object"||s==="function")&&!Object.isFrozen(n)&&Pn(n)}),t}class Xe{constructor(e){e.data===void 0&&(e.data={}),this.data=e.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function Rn(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function ot(t,...e){const n=Object.create(null);for(const s in t)n[s]=t[s];return e.forEach(function(s){for(const r in s)n[r]=s[r]}),n}const ra="</span>",Ye=t=>!!t.scope,oa=(t,{prefix:e})=>{if(t.startsWith("language:"))return t.replace("language:","language-");if(t.includes(".")){const n=t.split(".");return[`${e}${n.shift()}`,...n.map((s,r)=>`${s}${"_".repeat(r+1)}`)].join(" ")}return`${e}${t}`};class ia{constructor(e,n){this.buffer="",this.classPrefix=n.classPrefix,e.walk(this)}addText(e){this.buffer+=Rn(e)}openNode(e){if(!Ye(e))return;const n=oa(e.scope,{prefix:this.classPrefix});this.span(n)}closeNode(e){Ye(e)&&(this.buffer+=ra)}value(){return this.buffer}span(e){this.buffer+=`<span class="${e}">`}}const Ze=(t={})=>{const e={children:[]};return Object.assign(e,t),e};class xe{constructor(){this.rootNode=Ze(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(e){this.top.children.push(e)}openNode(e){const n=Ze({scope:e});this.add(n),this.stack.push(n)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(e){return this.constructor._walk(e,this.rootNode)}static _walk(e,n){return typeof n=="string"?e.addText(n):n.children&&(e.openNode(n),n.children.forEach(s=>this._walk(e,s)),e.closeNode(n)),e}static _collapse(e){typeof e!="string"&&e.children&&(e.children.every(n=>typeof n=="string")?e.children=[e.children.join("")]:e.children.forEach(n=>{xe._collapse(n)}))}}class aa extends xe{constructor(e){super(),this.options=e}addText(e){e!==""&&this.add(e)}startScope(e){this.openNode(e)}endScope(){this.closeNode()}__addSublanguage(e,n){const s=e.root;n&&(s.scope=`language:${n}`),this.add(s)}toHTML(){return new ia(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function wt(t){return t?typeof t=="string"?t:t.source:null}function Nn(t){return ht("(?=",t,")")}function la(t){return ht("(?:",t,")*")}function ca(t){return ht("(?:",t,")?")}function ht(...t){return t.map(n=>wt(n)).join("")}function da(t){const e=t[t.length-1];return typeof e=="object"&&e.constructor===Object?(t.splice(t.length-1,1),e):{}}function Te(...t){return"("+(da(t).capture?"":"?:")+t.map(s=>wt(s)).join("|")+")"}function In(t){return new RegExp(t.toString()+"|").exec("").length-1}function ua(t,e){const n=t&&t.exec(e);return n&&n.index===0}const pa=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function Se(t,{joinWith:e}){let n=0;return t.map(s=>{n+=1;const r=n;let a=wt(s),o="";for(;a.length>0;){const i=pa.exec(a);if(!i){o+=a;break}o+=a.substring(0,i.index),a=a.substring(i.index+i[0].length),i[0][0]==="\\"&&i[1]?o+="\\"+String(Number(i[1])+r):(o+=i[0],i[0]==="("&&n++)}return o}).map(s=>`(${s})`).join(e)}const ha=/\b\B/,Hn="[a-zA-Z]\\w*",Ae="[a-zA-Z_]\\w*",$n="\\b\\d+(\\.\\d+)?",Bn="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",Dn="\\b(0b[01]+)",fa="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",ga=(t={})=>{const e=/^#![ ]*\//;return t.binary&&(t.begin=ht(e,/.*\b/,t.binary,/\b.*/)),ot({scope:"meta",begin:e,end:/$/,relevance:0,"on:begin":(n,s)=>{n.index!==0&&s.ignoreMatch()}},t)},Et={begin:"\\\\[\\s\\S]",relevance:0},ma={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Et]},ba={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Et]},ya={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},Jt=function(t,e,n={}){const s=ot({scope:"comment",begin:t,end:e,contains:[]},n);s.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const r=Te("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return s.contains.push({begin:ht(/[ ]+/,"(",r,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),s},va=Jt("//","$"),Ma=Jt("/\\*","\\*/"),ka=Jt("#","$"),wa={scope:"number",begin:$n,relevance:0},Ea={scope:"number",begin:Bn,relevance:0},xa={scope:"number",begin:Dn,relevance:0},Ta={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[Et,{begin:/\[/,end:/\]/,relevance:0,contains:[Et]}]},Sa={scope:"title",begin:Hn,relevance:0},Aa={scope:"title",begin:Ae,relevance:0},Ca={begin:"\\.\\s*"+Ae,relevance:0},Oa=function(t){return Object.assign(t,{"on:begin":(e,n)=>{n.data._beginMatch=e[1]},"on:end":(e,n)=>{n.data._beginMatch!==e[1]&&n.ignoreMatch()}})};var Rt=Object.freeze({__proto__:null,APOS_STRING_MODE:ma,BACKSLASH_ESCAPE:Et,BINARY_NUMBER_MODE:xa,BINARY_NUMBER_RE:Dn,COMMENT:Jt,C_BLOCK_COMMENT_MODE:Ma,C_LINE_COMMENT_MODE:va,C_NUMBER_MODE:Ea,C_NUMBER_RE:Bn,END_SAME_AS_BEGIN:Oa,HASH_COMMENT_MODE:ka,IDENT_RE:Hn,MATCH_NOTHING_RE:ha,METHOD_GUARD:Ca,NUMBER_MODE:wa,NUMBER_RE:$n,PHRASAL_WORDS_MODE:ya,QUOTE_STRING_MODE:ba,REGEXP_MODE:Ta,RE_STARTERS_RE:fa,SHEBANG:ga,TITLE_MODE:Sa,UNDERSCORE_IDENT_RE:Ae,UNDERSCORE_TITLE_MODE:Aa});function La(t,e){t.input[t.index-1]==="."&&e.ignoreMatch()}function _a(t,e){t.className!==void 0&&(t.scope=t.className,delete t.className)}function Pa(t,e){e&&t.beginKeywords&&(t.begin="\\b("+t.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",t.__beforeBegin=La,t.keywords=t.keywords||t.beginKeywords,delete t.beginKeywords,t.relevance===void 0&&(t.relevance=0))}function Ra(t,e){Array.isArray(t.illegal)&&(t.illegal=Te(...t.illegal))}function Na(t,e){if(t.match){if(t.begin||t.end)throw new Error("begin & end are not supported with match");t.begin=t.match,delete t.match}}function Ia(t,e){t.relevance===void 0&&(t.relevance=1)}const Ha=(t,e)=>{if(!t.beforeMatch)return;if(t.starts)throw new Error("beforeMatch cannot be used with starts");const n=Object.assign({},t);Object.keys(t).forEach(s=>{delete t[s]}),t.keywords=n.keywords,t.begin=ht(n.beforeMatch,Nn(n.begin)),t.starts={relevance:0,contains:[Object.assign(n,{endsParent:!0})]},t.relevance=0,delete n.beforeMatch},$a=["of","and","for","in","not","or","if","then","parent","list","value"],Ba="keyword";function jn(t,e,n=Ba){const s=Object.create(null);return typeof t=="string"?r(n,t.split(" ")):Array.isArray(t)?r(n,t):Object.keys(t).forEach(function(a){Object.assign(s,jn(t[a],e,a))}),s;function r(a,o){e&&(o=o.map(i=>i.toLowerCase())),o.forEach(function(i){const l=i.split("|");s[l[0]]=[a,Da(l[0],l[1])]})}}function Da(t,e){return e?Number(e):ja(t)?0:1}function ja(t){return $a.includes(t.toLowerCase())}const tn={},ut=t=>{console.error(t)},en=(t,...e)=>{console.log(`WARN: ${t}`,...e)},mt=(t,e)=>{tn[`${t}/${e}`]||(console.log(`Deprecated as of ${t}. ${e}`),tn[`${t}/${e}`]=!0)},jt=new Error;function Fn(t,e,{key:n}){let s=0;const r=t[n],a={},o={};for(let i=1;i<=e.length;i++)o[i+s]=r[i],a[i+s]=!0,s+=In(e[i-1]);t[n]=o,t[n]._emit=a,t[n]._multi=!0}function Fa(t){if(Array.isArray(t.begin)){if(t.skip||t.excludeBegin||t.returnBegin)throw ut("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),jt;if(typeof t.beginScope!="object"||t.beginScope===null)throw ut("beginScope must be object"),jt;Fn(t,t.begin,{key:"beginScope"}),t.begin=Se(t.begin,{joinWith:""})}}function Wa(t){if(Array.isArray(t.end)){if(t.skip||t.excludeEnd||t.returnEnd)throw ut("skip, excludeEnd, returnEnd not compatible with endScope: {}"),jt;if(typeof t.endScope!="object"||t.endScope===null)throw ut("endScope must be object"),jt;Fn(t,t.end,{key:"endScope"}),t.end=Se(t.end,{joinWith:""})}}function za(t){t.scope&&typeof t.scope=="object"&&t.scope!==null&&(t.beginScope=t.scope,delete t.scope)}function Ua(t){za(t),typeof t.beginScope=="string"&&(t.beginScope={_wrap:t.beginScope}),typeof t.endScope=="string"&&(t.endScope={_wrap:t.endScope}),Fa(t),Wa(t)}function qa(t){function e(o,i){return new RegExp(wt(o),"m"+(t.case_insensitive?"i":"")+(t.unicodeRegex?"u":"")+(i?"g":""))}class n{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(i,l){l.position=this.position++,this.matchIndexes[this.matchAt]=l,this.regexes.push([l,i]),this.matchAt+=In(i)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const i=this.regexes.map(l=>l[1]);this.matcherRe=e(Se(i,{joinWith:"|"}),!0),this.lastIndex=0}exec(i){this.matcherRe.lastIndex=this.lastIndex;const l=this.matcherRe.exec(i);if(!l)return null;const c=l.findIndex((d,p)=>p>0&&d!==void 0),u=this.matchIndexes[c];return l.splice(0,c),Object.assign(l,u)}}class s{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(i){if(this.multiRegexes[i])return this.multiRegexes[i];const l=new n;return this.rules.slice(i).forEach(([c,u])=>l.addRule(c,u)),l.compile(),this.multiRegexes[i]=l,l}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(i,l){this.rules.push([i,l]),l.type==="begin"&&this.count++}exec(i){const l=this.getMatcher(this.regexIndex);l.lastIndex=this.lastIndex;let c=l.exec(i);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const u=this.getMatcher(0);u.lastIndex=this.lastIndex+1,c=u.exec(i)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function r(o){const i=new s;return o.contains.forEach(l=>i.addRule(l.begin,{rule:l,type:"begin"})),o.terminatorEnd&&i.addRule(o.terminatorEnd,{type:"end"}),o.illegal&&i.addRule(o.illegal,{type:"illegal"}),i}function a(o,i){const l=o;if(o.isCompiled)return l;[_a,Na,Ua,Ha].forEach(u=>u(o,i)),t.compilerExtensions.forEach(u=>u(o,i)),o.__beforeBegin=null,[Pa,Ra,Ia].forEach(u=>u(o,i)),o.isCompiled=!0;let c=null;return typeof o.keywords=="object"&&o.keywords.$pattern&&(o.keywords=Object.assign({},o.keywords),c=o.keywords.$pattern,delete o.keywords.$pattern),c=c||/\w+/,o.keywords&&(o.keywords=jn(o.keywords,t.case_insensitive)),l.keywordPatternRe=e(c,!0),i&&(o.begin||(o.begin=/\B|\b/),l.beginRe=e(l.begin),!o.end&&!o.endsWithParent&&(o.end=/\B|\b/),o.end&&(l.endRe=e(l.end)),l.terminatorEnd=wt(l.end)||"",o.endsWithParent&&i.terminatorEnd&&(l.terminatorEnd+=(o.end?"|":"")+i.terminatorEnd)),o.illegal&&(l.illegalRe=e(o.illegal)),o.contains||(o.contains=[]),o.contains=[].concat(...o.contains.map(function(u){return Ka(u==="self"?o:u)})),o.contains.forEach(function(u){a(u,l)}),o.starts&&a(o.starts,i),l.matcher=r(l),l}if(t.compilerExtensions||(t.compilerExtensions=[]),t.contains&&t.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return t.classNameAliases=ot(t.classNameAliases||{}),a(t)}function Wn(t){return t?t.endsWithParent||Wn(t.starts):!1}function Ka(t){return t.variants&&!t.cachedVariants&&(t.cachedVariants=t.variants.map(function(e){return ot(t,{variants:null},e)})),t.cachedVariants?t.cachedVariants:Wn(t)?ot(t,{starts:t.starts?ot(t.starts):null}):Object.isFrozen(t)?ot(t):t}var Va="11.9.0";class Ga extends Error{constructor(e,n){super(e),this.name="HTMLInjectionError",this.html=n}}const oe=Rn,nn=ot,sn=Symbol("nomatch"),Qa=7,zn=function(t){const e=Object.create(null),n=Object.create(null),s=[];let r=!0;const a="Could not find the language '{}', did you forget to load/include a language module?",o={disableAutodetect:!0,name:"Plain text",contains:[]};let i={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:aa};function l(y){return i.noHighlightRe.test(y)}function c(y){let w=y.className+" ";w+=y.parentNode?y.parentNode.className:"";const C=i.languageDetectRe.exec(w);if(C){const _=P(C[1]);return _||(en(a.replace("{}",C[1])),en("Falling back to no-highlight mode for this block.",y)),_?C[1]:"no-highlight"}return w.split(/\s+/).find(_=>l(_)||P(_))}function u(y,w,C){let _="",j="";typeof w=="object"?(_=y,C=w.ignoreIllegals,j=w.language):(mt("10.7.0","highlight(lang, code, ...args) has been deprecated."),mt("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),j=y,_=w),C===void 0&&(C=!0);const G={code:_,language:j};Z("before:highlight",G);const rt=G.result?G.result:d(G.language,G.code,C);return rt.code=G.code,Z("after:highlight",rt),rt}function d(y,w,C,_){const j=Object.create(null);function G(v,E){return v.keywords[E]}function rt(){if(!T.keywords){z.addText(H);return}let v=0;T.keywordPatternRe.lastIndex=0;let E=T.keywordPatternRe.exec(H),S="";for(;E;){S+=H.substring(v,E.index);const N=et.case_insensitive?E[0].toLowerCase():E[0],q=G(T,N);if(q){const[nt,Yn]=q;if(z.addText(S),S="",j[N]=(j[N]||0)+1,j[N]<=Qa&&(Ot+=Yn),nt.startsWith("_"))S+=E[0];else{const Zn=et.classNameAliases[nt]||nt;tt(E[0],Zn)}}else S+=E[0];v=T.keywordPatternRe.lastIndex,E=T.keywordPatternRe.exec(H)}S+=H.substring(v),z.addText(S)}function At(){if(H==="")return;let v=null;if(typeof T.subLanguage=="string"){if(!e[T.subLanguage]){z.addText(H);return}v=d(T.subLanguage,H,!0,Pe[T.subLanguage]),Pe[T.subLanguage]=v._top}else v=h(H,T.subLanguage.length?T.subLanguage:null);T.relevance>0&&(Ot+=v.relevance),z.__addSublanguage(v._emitter,v.language)}function X(){T.subLanguage!=null?At():rt(),H=""}function tt(v,E){v!==""&&(z.startScope(E),z.addText(v),z.endScope())}function Ce(v,E){let S=1;const N=E.length-1;for(;S<=N;){if(!v._emit[S]){S++;continue}const q=et.classNameAliases[v[S]]||v[S],nt=E[S];q?tt(nt,q):(H=nt,rt(),H=""),S++}}function Oe(v,E){return v.scope&&typeof v.scope=="string"&&z.openNode(et.classNameAliases[v.scope]||v.scope),v.beginScope&&(v.beginScope._wrap?(tt(H,et.classNameAliases[v.beginScope._wrap]||v.beginScope._wrap),H=""):v.beginScope._multi&&(Ce(v.beginScope,E),H="")),T=Object.create(v,{parent:{value:T}}),T}function Le(v,E,S){let N=ua(v.endRe,S);if(N){if(v["on:end"]){const q=new Xe(v);v["on:end"](E,q),q.isMatchIgnored&&(N=!1)}if(N){for(;v.endsParent&&v.parent;)v=v.parent;return v}}if(v.endsWithParent)return Le(v.parent,E,S)}function Vn(v){return T.matcher.regexIndex===0?(H+=v[0],1):(te=!0,0)}function Gn(v){const E=v[0],S=v.rule,N=new Xe(S),q=[S.__beforeBegin,S["on:begin"]];for(const nt of q)if(nt&&(nt(v,N),N.isMatchIgnored))return Vn(E);return S.skip?H+=E:(S.excludeBegin&&(H+=E),X(),!S.returnBegin&&!S.excludeBegin&&(H=E)),Oe(S,v),S.returnBegin?0:E.length}function Qn(v){const E=v[0],S=w.substring(v.index),N=Le(T,v,S);if(!N)return sn;const q=T;T.endScope&&T.endScope._wrap?(X(),tt(E,T.endScope._wrap)):T.endScope&&T.endScope._multi?(X(),Ce(T.endScope,v)):q.skip?H+=E:(q.returnEnd||q.excludeEnd||(H+=E),X(),q.excludeEnd&&(H=E));do T.scope&&z.closeNode(),!T.skip&&!T.subLanguage&&(Ot+=T.relevance),T=T.parent;while(T!==N.parent);return N.starts&&Oe(N.starts,v),q.returnEnd?0:E.length}function Jn(){const v=[];for(let E=T;E!==et;E=E.parent)E.scope&&v.unshift(E.scope);v.forEach(E=>z.openNode(E))}let Ct={};function _e(v,E){const S=E&&E[0];if(H+=v,S==null)return X(),0;if(Ct.type==="begin"&&E.type==="end"&&Ct.index===E.index&&S===""){if(H+=w.slice(E.index,E.index+1),!r){const N=new Error(`0 width match regex (${y})`);throw N.languageName=y,N.badRule=Ct.rule,N}return 1}if(Ct=E,E.type==="begin")return Gn(E);if(E.type==="illegal"&&!C){const N=new Error('Illegal lexeme "'+S+'" for mode "'+(T.scope||"<unnamed>")+'"');throw N.mode=T,N}else if(E.type==="end"){const N=Qn(E);if(N!==sn)return N}if(E.type==="illegal"&&S==="")return 1;if(Zt>1e5&&Zt>E.index*3)throw new Error("potential infinite loop, way more iterations than matches");return H+=S,S.length}const et=P(y);if(!et)throw ut(a.replace("{}",y)),new Error('Unknown language: "'+y+'"');const Xn=qa(et);let Yt="",T=_||Xn;const Pe={},z=new i.__emitter(i);Jn();let H="",Ot=0,lt=0,Zt=0,te=!1;try{if(et.__emitTokens)et.__emitTokens(w,z);else{for(T.matcher.considerAll();;){Zt++,te?te=!1:T.matcher.considerAll(),T.matcher.lastIndex=lt;const v=T.matcher.exec(w);if(!v)break;const E=w.substring(lt,v.index),S=_e(E,v);lt=v.index+S}_e(w.substring(lt))}return z.finalize(),Yt=z.toHTML(),{language:y,value:Yt,relevance:Ot,illegal:!1,_emitter:z,_top:T}}catch(v){if(v.message&&v.message.includes("Illegal"))return{language:y,value:oe(w),illegal:!0,relevance:0,_illegalBy:{message:v.message,index:lt,context:w.slice(lt-100,lt+100),mode:v.mode,resultSoFar:Yt},_emitter:z};if(r)return{language:y,value:oe(w),illegal:!1,relevance:0,errorRaised:v,_emitter:z,_top:T};throw v}}function p(y){const w={value:oe(y),illegal:!1,relevance:0,_top:o,_emitter:new i.__emitter(i)};return w._emitter.addText(y),w}function h(y,w){w=w||i.languages||Object.keys(e);const C=p(y),_=w.filter(P).filter(ft).map(X=>d(X,y,!1));_.unshift(C);const j=_.sort((X,tt)=>{if(X.relevance!==tt.relevance)return tt.relevance-X.relevance;if(X.language&&tt.language){if(P(X.language).supersetOf===tt.language)return 1;if(P(tt.language).supersetOf===X.language)return-1}return 0}),[G,rt]=j,At=G;return At.secondBest=rt,At}function f(y,w,C){const _=w&&n[w]||C;y.classList.add("hljs"),y.classList.add(`language-${_}`)}function b(y){let w=null;const C=c(y);if(l(C))return;if(Z("before:highlightElement",{el:y,language:C}),y.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",y);return}if(y.children.length>0&&(i.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(y)),i.throwUnescapedHTML))throw new Ga("One of your code blocks includes unescaped HTML.",y.innerHTML);w=y;const _=w.textContent,j=C?u(_,{language:C,ignoreIllegals:!0}):h(_);y.innerHTML=j.value,y.dataset.highlighted="yes",f(y,C,j.language),y.result={language:j.language,re:j.relevance,relevance:j.relevance},j.secondBest&&(y.secondBest={language:j.secondBest.language,relevance:j.secondBest.relevance}),Z("after:highlightElement",{el:y,result:j,text:_})}function m(y){i=nn(i,y)}const g=()=>{L(),mt("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function M(){L(),mt("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let x=!1;function L(){if(document.readyState==="loading"){x=!0;return}document.querySelectorAll(i.cssSelector).forEach(b)}function I(){x&&L()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",I,!1);function O(y,w){let C=null;try{C=w(t)}catch(_){if(ut("Language definition for '{}' could not be registered.".replace("{}",y)),r)ut(_);else throw _;C=o}C.name||(C.name=y),e[y]=C,C.rawDefinition=w.bind(null,t),C.aliases&&V(C.aliases,{languageName:y})}function $(y){delete e[y];for(const w of Object.keys(n))n[w]===y&&delete n[w]}function J(){return Object.keys(e)}function P(y){return y=(y||"").toLowerCase(),e[y]||e[n[y]]}function V(y,{languageName:w}){typeof y=="string"&&(y=[y]),y.forEach(C=>{n[C.toLowerCase()]=w})}function ft(y){const w=P(y);return w&&!w.disableAutodetect}function Tt(y){y["before:highlightBlock"]&&!y["before:highlightElement"]&&(y["before:highlightElement"]=w=>{y["before:highlightBlock"](Object.assign({block:w.el},w))}),y["after:highlightBlock"]&&!y["after:highlightElement"]&&(y["after:highlightElement"]=w=>{y["after:highlightBlock"](Object.assign({block:w.el},w))})}function St(y){Tt(y),s.push(y)}function Xt(y){const w=s.indexOf(y);w!==-1&&s.splice(w,1)}function Z(y,w){const C=y;s.forEach(function(_){_[C]&&_[C](w)})}function gt(y){return mt("10.7.0","highlightBlock will be removed entirely in v12.0"),mt("10.7.0","Please use highlightElement now."),b(y)}Object.assign(t,{highlight:u,highlightAuto:h,highlightAll:L,highlightElement:b,highlightBlock:gt,configure:m,initHighlighting:g,initHighlightingOnLoad:M,registerLanguage:O,unregisterLanguage:$,listLanguages:J,getLanguage:P,registerAliases:V,autoDetection:ft,inherit:nn,addPlugin:St,removePlugin:Xt}),t.debugMode=function(){r=!1},t.safeMode=function(){r=!0},t.versionString=Va,t.regex={concat:ht,lookahead:Nn,either:Te,optional:ca,anyNumberOfTimes:la};for(const y in Rt)typeof Rt[y]=="object"&&Pn(Rt[y]);return Object.assign(t,Rt),t},Mt=zn({});Mt.newInstance=()=>zn({});var Ja=Mt;Mt.HighlightJS=Mt;Mt.default=Mt;var Xa=sa(Ja);function Un(t,e=[]){return t.map(n=>{const s=[...e,...n.properties?n.properties.className:[]];return n.children?Un(n.children,s):{text:n.value,classes:s}}).flat()}function rn(t){return t.value||t.children||[]}function Ya(t){return!!Xa.getLanguage(t)}function on({doc:t,name:e,lowlight:n,defaultLanguage:s}){const r=[];return de(t,a=>a.type.name===e).forEach(a=>{let o=a.pos+1;const i=a.node.attrs.language||s,l=n.listLanguages(),c=i&&(l.includes(i)||Ya(i))?rn(n.highlight(i,a.node.textContent)):rn(n.highlightAuto(a.node.textContent));Un(c).forEach(u=>{const d=o+u.text.length;if(u.classes.length){const p=fe.inline(o,d,{class:u.classes.join(" ")});r.push(p)}o=d})}),ge.create(t,r)}function Za(t){return typeof t=="function"}function tl({name:t,lowlight:e,defaultLanguage:n}){if(!["highlight","highlightAuto","listLanguages"].every(r=>Za(e[r])))throw Error("You should provide an instance of lowlight to use the code-block-lowlight extension");const s=new U({key:new K("lowlight"),state:{init:(r,{doc:a})=>on({doc:a,name:t,lowlight:e,defaultLanguage:n}),apply:(r,a,o,i)=>{const l=o.selection.$head.parent.type.name,c=i.selection.$head.parent.type.name,u=de(o.doc,p=>p.type.name===t),d=de(i.doc,p=>p.type.name===t);return r.docChanged&&([l,c].includes(t)||d.length!==u.length||r.steps.some(p=>p.from!==void 0&&p.to!==void 0&&u.some(h=>h.pos>=p.from&&h.pos+h.node.nodeSize<=p.to)))?on({doc:r.doc,name:t,lowlight:e,defaultLanguage:n}):a.map(r.mapping,r.doc)}},props:{decorations(r){return s.getState(r)}}});return s}const Cl=_n.extend({addOptions(){var t;return{...(t=this.parent)===null||t===void 0?void 0:t.call(this),lowlight:{},defaultLanguage:null}},addProseMirrorPlugins(){var t;return[...((t=this.parent)===null||t===void 0?void 0:t.call(this))||[],tl({name:this.name,lowlight:this.options.lowlight,defaultLanguage:this.options.defaultLanguage})]}});function an(t,e,n,s,r,a){let o=0,i=!0,l=e.firstChild;const c=t.firstChild;for(let u=0,d=0;u<c.childCount;u+=1){const{colspan:p,colwidth:h}=c.child(u).attrs;for(let f=0;f<p;f+=1,d+=1){const b=r===d?a:h&&h[f],m=b?`${b}px`:"";o+=b||s,b||(i=!1),l?(l.style.width!==m&&(l.style.width=m),l=l.nextSibling):e.appendChild(document.createElement("col")).style.width=m}}for(;l;){const u=l.nextSibling;l.parentNode.removeChild(l),l=u}i?(n.style.width=`${o}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${o}px`)}class el{constructor(e,n){this.node=e,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),an(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!==this.node.type?!1:(this.node=e,an(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type==="attributes"&&(e.target===this.table||this.colgroup.contains(e.target))}}function nl(t,e,n,s){let r=0,a=!0;const o=[],i=t.firstChild;if(!i)return{};for(let d=0,p=0;d<i.childCount;d+=1){const{colspan:h,colwidth:f}=i.child(d).attrs;for(let b=0;b<h;b+=1,p+=1){const m=n===p?s:f&&f[b],g=m?`${m}px`:"";r+=m||e,m||(a=!1),o.push(["col",g?{style:`width: ${g}`}:{}])}}const l=a?`${r}px`:"",c=a?"":`${r}px`;return{colgroup:["colgroup",{},...o],tableWidth:l,tableMinWidth:c}}function ln(t,e){return t.createAndFill()}function sl(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const e={};return Object.keys(t.nodes).forEach(n=>{const s=t.nodes[n];s.spec.tableRole&&(e[s.spec.tableRole]=s)}),t.cached.tableNodeTypes=e,e}function rl(t,e,n,s,r){const a=sl(t),o=[],i=[];for(let c=0;c<n;c+=1){const u=ln(a.cell);if(u&&i.push(u),s){const d=ln(a.header_cell);d&&o.push(d)}}const l=[];for(let c=0;c<e;c+=1)l.push(a.row.createChecked(null,s&&c===0?o:i));return a.table.createChecked(null,l)}function ol(t){return t instanceof mn}const Nt=({editor:t})=>{const{selection:e}=t.state;if(!ol(e))return!1;let n=0;const s=An(e.ranges[0].$from,a=>a.type.name==="table");return s==null||s.node.descendants(a=>{if(a.type.name==="table")return!1;["tableCell","tableHeader"].includes(a.type.name)&&(n+=1)}),n===e.ranges.length?(t.commands.deleteTable(),!0):!1},Ol=B.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:el,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:e}){const{colgroup:n,tableWidth:s,tableMinWidth:r}=nl(t,this.options.cellMinWidth);return["table",R(this.options.HTMLAttributes,e,{style:s?`width: ${s}`:`min-width: ${r}`}),n,["tbody",0]]},addCommands(){return{insertTable:({rows:t=3,cols:e=3,withHeaderRow:n=!0}={})=>({tr:s,dispatch:r,editor:a})=>{const o=rl(a.schema,t,e,n);if(r){const i=s.selection.from+1;s.replaceSelectionWith(o).scrollIntoView().setSelection(Q.near(s.doc.resolve(i)))}return!0},addColumnBefore:()=>({state:t,dispatch:e})=>Hs(t,e),addColumnAfter:()=>({state:t,dispatch:e})=>$s(t,e),deleteColumn:()=>({state:t,dispatch:e})=>Bs(t,e),addRowBefore:()=>({state:t,dispatch:e})=>Ds(t,e),addRowAfter:()=>({state:t,dispatch:e})=>js(t,e),deleteRow:()=>({state:t,dispatch:e})=>Fs(t,e),deleteTable:()=>({state:t,dispatch:e})=>Ws(t,e),mergeCells:()=>({state:t,dispatch:e})=>Ne(t,e),splitCell:()=>({state:t,dispatch:e})=>Ie(t,e),toggleHeaderColumn:()=>({state:t,dispatch:e})=>He("column")(t,e),toggleHeaderRow:()=>({state:t,dispatch:e})=>He("row")(t,e),toggleHeaderCell:()=>({state:t,dispatch:e})=>zs(t,e),mergeOrSplit:()=>({state:t,dispatch:e})=>Ne(t,e)?!0:Ie(t,e),setCellAttribute:(t,e)=>({state:n,dispatch:s})=>Us(t,e)(n,s),goToNextCell:()=>({state:t,dispatch:e})=>$e(1)(t,e),goToPreviousCell:()=>({state:t,dispatch:e})=>$e(-1)(t,e),fixTables:()=>({state:t,dispatch:e})=>(e&&qs(t),!0),setCellSelection:t=>({tr:e,dispatch:n})=>{if(n){const s=mn.create(e.doc,t.anchorCell,t.headCell);e.setSelection(s)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Nt,"Mod-Backspace":Nt,Delete:Nt,"Mod-Delete":Nt}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[Ks({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],Vs({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const e={name:t.name,options:t.options,storage:t.storage};return{tableRole:A(k(t,"tableRole",e))}}}),Ll=B.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?[parseInt(e,10)]:null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",R(this.options.HTMLAttributes,t),0]}}),_l=B.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?[parseInt(e,10)]:null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",R(this.options.HTMLAttributes,t),0]}}),Pl=B.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",R(this.options.HTMLAttributes,t),0]}}),il=({key:t,editor:e,onPaste:n,onDrop:s,allowedMimeTypes:r})=>new U({key:t||new K("fileHandler"),props:{handleDrop(a,o){var i;if(!s||!(!((i=o.dataTransfer)===null||i===void 0)&&i.files.length))return!1;const l=a.posAtCoords({left:o.clientX,top:o.clientY});let c=Array.from(o.dataTransfer.files);return r&&(c=c.filter(u=>r.includes(u.type))),c.length!==0&&(o.preventDefault(),o.stopPropagation(),s(e,c,(l==null?void 0:l.pos)||0),!0)},handlePaste(a,o){var i;if(!n||!(!((i=o.clipboardData)===null||i===void 0)&&i.files.length))return!1;let l=Array.from(o.clipboardData.files);const c=o.clipboardData.getData("text/html");return r&&(l=l.filter(u=>r.includes(u.type))),l.length!==0&&(o.preventDefault(),o.stopPropagation(),n(e,l,c),!(c.length>0))}}}),Rl=F.create({name:"fileHandler",addOptions:()=>({onPaste:void 0,onDrop:void 0,allowedMimeTypes:void 0}),addProseMirrorPlugins(){return[il({key:new K(this.name),editor:this.editor,allowedMimeTypes:this.options.allowedMimeTypes,onDrop:this.options.onDrop,onPaste:this.options.onPaste})]}}),al=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Nl=B.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",R(this.options.HTMLAttributes,t)]},addCommands(){return{setImage:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[Ln({find:al,type:this.type,getAttributes:t=>{const[,,e,n,s]=t;return{src:n,alt:e,title:s}}})]}}),Il=F.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const e=t.style.textAlign||this.options.defaultAlignment;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:t=>t.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${t.textAlign}`}}}}]},addCommands(){return{setTextAlign:t=>({commands:e})=>this.options.alignments.includes(t)?this.options.types.map(n=>e.updateAttributes(n,{textAlign:t})).every(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(e=>t.resetAttributes(e,"textAlign")).every(e=>e)}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),Hl=Y.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",R(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),ll=/^\s*(\[([( |x])?\])\s$/,$l=B.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e==null||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",R(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:s})=>{const r=document.createElement("li"),a=document.createElement("label"),o=document.createElement("span"),i=document.createElement("input"),l=document.createElement("div");return a.contentEditable="false",i.type="checkbox",i.addEventListener("change",c=>{if(!s.isEditable&&!this.options.onReadOnlyChecked){i.checked=!i.checked;return}const{checked:u}=c.target;s.isEditable&&typeof n=="function"&&s.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{const p=n(),h=d.doc.nodeAt(p);return d.setNodeMarkup(p,void 0,{...h==null?void 0:h.attrs,checked:u}),!0}).run(),!s.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,u)||(i.checked=!i.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([c,u])=>{r.setAttribute(c,u)}),r.dataset.checked=t.attrs.checked,t.attrs.checked&&i.setAttribute("checked","checked"),a.append(i,o),r.append(a,l),Object.entries(e).forEach(([c,u])=>{r.setAttribute(c,u)}),{dom:r,contentDOM:l,update:c=>c.type!==this.type?!1:(r.dataset.checked=c.attrs.checked,c.attrs.checked?i.setAttribute("checked","checked"):i.removeAttribute("checked"),!0)}}},addInputRules(){return[vt({find:ll,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),Bl=B.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",R(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});function cl(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function dl(t){return new U({key:new K("autolink"),appendTransaction:(e,n,s)=>{const r=e.some(c=>c.docChanged)&&!n.doc.eq(s.doc),a=e.some(c=>c.getMeta("preventAutolink"));if(!r||a)return;const{tr:o}=s,i=uo(n.doc,[...e]);if(vo(i).forEach(({newRange:c})=>{const u=ho(s.doc,c,h=>h.isTextblock);let d,p;if(u.length>1?(d=u[0],p=s.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):u.length&&s.doc.textBetween(c.from,c.to," "," ").endsWith(" ")&&(d=u[0],p=s.doc.textBetween(d.pos,c.to,void 0," ")),d&&p){const h=p.split(" ").filter(g=>g!=="");if(h.length<=0)return!1;const f=h[h.length-1],b=d.pos+p.lastIndexOf(f);if(!f)return!1;const m=Gs(f).map(g=>g.toObject(t.defaultProtocol));if(!cl(m))return!1;m.filter(g=>g.isLink).map(g=>({...g,from:b+g.start+1,to:b+g.end+1})).filter(g=>s.schema.marks.code?!s.doc.rangeHasMark(g.from,g.to,s.schema.marks.code):!0).filter(g=>t.validate(g.value)).forEach(g=>{we(g.from,g.to,s.doc).some(M=>M.mark.type===t.type)||o.addMark(g.from,g.to,t.type.create({href:g.href}))})}}),!!o.steps.length)return o}})}function ul(t){return new U({key:new K("handleClickLink"),props:{handleClick:(e,n,s)=>{var r,a;if(s.button!==0||!e.editable)return!1;let o=s.target;const i=[];for(;o.nodeName!=="DIV";)i.push(o),o=o.parentNode;if(!i.find(p=>p.nodeName==="A"))return!1;const l=Cn(e.state,t.type.name),c=s.target,u=(r=c==null?void 0:c.href)!==null&&r!==void 0?r:l.href,d=(a=c==null?void 0:c.target)!==null&&a!==void 0?a:l.target;return c&&u?(window.open(u,d),!0):!1}}})}function pl(t){return new U({key:new K("handlePasteLink"),props:{handlePaste:(e,n,s)=>{const{state:r}=e,{selection:a}=r,{empty:o}=a;if(o)return!1;let i="";s.content.forEach(c=>{i+=c.textContent});const l=bn(i,{defaultProtocol:t.defaultProtocol}).find(c=>c.isLink&&c.value===i);return!i||!l?!1:(t.editor.commands.setMark(t.type,{href:l.href}),!0)}}})}const hl=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g,fl=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i;function cn(t){return!t||t.replace(hl,"").match(fl)}const Dl=Y.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.protocols.forEach(t=>{if(typeof t=="string"){Be(t);return}Be(t.scheme,t.optionalSlashes)})},onDestroy(){Qs()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:t=>!!t}},addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!cn(e)?!1:{href:e}}}]},renderHTML({HTMLAttributes:t}){return cn(t.href)?["a",R(this.options.HTMLAttributes,t),0]:["a",R(this.options.HTMLAttributes,{...t,href:""}),0]},addCommands(){return{setLink:t=>({chain:e})=>e().setMark(this.name,t).setMeta("preventAutolink",!0).run(),toggleLink:t=>({chain:e})=>e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[it({find:t=>{const e=[];if(t){const{validate:n}=this.options,s=bn(t).filter(r=>r.isLink&&n(r.value));s.length&&s.forEach(r=>e.push({text:r.value,data:{href:r.href},index:r.start}))}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)===null||e===void 0?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[];return this.options.autolink&&t.push(dl({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:this.options.validate})),this.options.openOnClick===!0&&t.push(ul({type:this.type})),this.options.linkOnPaste&&t.push(pl({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),t}});class gl{constructor({editor:e,element:n,view:s,tippyOptions:r={},updateDelay:a=250,shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:i,state:l,from:c,to:u})=>{const{doc:d,selection:p}=l,{empty:h}=p,f=!d.textBetween(c,u).length&&Me(l.selection),b=this.element.contains(document.activeElement);return!(!(i.hasFocus()||b)||h||f||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:i})=>{var l;if(this.preventHide){this.preventHide=!1;return}i!=null&&i.relatedTarget&&(!((l=this.element.parentNode)===null||l===void 0)&&l.contains(i.relatedTarget))||this.hide()},this.tippyBlurHandler=i=>{this.blurHandler({event:i})},this.handleDebouncedUpdate=(i,l)=>{const c=!(l!=null&&l.selection.eq(i.state.selection)),u=!(l!=null&&l.doc.eq(i.state.doc));!c&&!u||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(i,c,u,l)},this.updateDelay))},this.updateHandler=(i,l,c,u)=>{var d,p,h;const{state:f,composing:b}=i,{selection:m}=f;if(b||!l&&!c)return;this.createTooltip();const{ranges:M}=m,x=Math.min(...M.map(O=>O.$from.pos)),L=Math.max(...M.map(O=>O.$to.pos));if(!((d=this.shouldShow)===null||d===void 0?void 0:d.call(this,{editor:this.editor,view:i,state:f,oldState:u,from:x,to:L}))){this.hide();return}(p=this.tippy)===null||p===void 0||p.setProps({getReferenceClientRect:((h=this.tippyOptions)===null||h===void 0?void 0:h.getReferenceClientRect)||(()=>{if(On(f.selection)){let O=i.nodeDOM(x);const $=O.dataset.nodeViewWrapper?O:O.querySelector("[data-node-view-wrapper]");if($&&(O=$.firstChild),O)return O.getBoundingClientRect()}return ko(i,x,L)})}),this.show()},this.editor=e,this.element=n,this.view=s,this.updateDelay=a,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,n=!!e.parentElement;this.tippy||!n||(this.tippy=Js(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,n){const{state:s}=e,r=s.selection.from!==s.selection.to;if(this.updateDelay>0&&r){this.handleDebouncedUpdate(e,n);return}const a=!(n!=null&&n.selection.eq(e.state.selection)),o=!(n!=null&&n.doc.eq(e.state.doc));this.updateHandler(e,a,o,n)}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e,n;!((e=this.tippy)===null||e===void 0)&&e.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const qn=t=>new U({key:typeof t.pluginKey=="string"?new K(t.pluginKey):t.pluginKey,view:e=>new gl({view:e,...t})});F.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[qn({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});const jl=Ft({name:"BubbleMenu",props:{pluginKey:{type:[String,Object],default:"bubbleMenu"},editor:{type:Object,required:!0},updateDelay:{type:Number,default:void 0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(t,{slots:e}){const n=me(null);return yn(()=>{const{updateDelay:s,editor:r,pluginKey:a,shouldShow:o,tippyOptions:i}=t;r.registerPlugin(qn({updateDelay:s,editor:r,element:n.value,pluginKey:a,shouldShow:o,tippyOptions:i}))}),be(()=>{const{pluginKey:s,editor:r}=t;r.unregisterPlugin(s)}),()=>{var s;return Wt("div",{ref:n},(s=e.default)===null||s===void 0?void 0:s.call(e))}}});function dn(t){return nr((e,n)=>({get(){return e(),t},set(s){t=s,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})})}}))}class ml extends Qo{constructor(e={}){return super(e),this.contentComponent=null,this.appContext=null,this.reactiveState=dn(this.view.state),this.reactiveExtensionStorage=dn(this.extensionStorage),this.on("beforeTransaction",({nextState:n})=>{this.reactiveState.value=n,this.reactiveExtensionStorage.value=this.extensionStorage}),vn(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(e,n){super.registerPlugin(e,n),this.reactiveState.value=this.view.state}unregisterPlugin(e){super.unregisterPlugin(e),this.reactiveState.value=this.view.state}}const Fl=Ft({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(t){const e=me(),n=sr();return Xs(()=>{const s=t.editor;s&&s.options.element&&e.value&&tr(()=>{if(!e.value||!s.options.element.firstChild)return;const r=er(e.value);e.value.append(...s.options.element.childNodes),s.contentComponent=n.ctx._,n&&(s.appContext={...n.appContext,provides:n.provides}),s.setOptions({element:r}),s.createNodeViews()})}),be(()=>{const s=t.editor;if(!s||(s.isDestroyed||s.view.setProps({nodeViews:{}}),s.contentComponent=null,s.appContext=null,!s.options.element.firstChild))return;const r=document.createElement("div");r.append(...s.options.element.childNodes),s.setOptions({element:r})}),{rootEl:e}},render(){return Wt("div",{ref:t=>{this.rootEl=t}})}}),Wl=Ft({name:"NodeViewWrapper",props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(){var t,e;return Wt(this.as,{class:this.decorationClasses,style:{whiteSpace:"normal"},"data-node-view-wrapper":"",onDragstart:this.onDragStart},(e=(t=this.$slots).default)===null||e===void 0?void 0:e.call(t))}}),zl=(t={})=>{const e=Ys();return yn(()=>{e.value=new ml(t)}),be(()=>{var n;(n=e.value)===null||n===void 0||n.destroy()}),e};class bl{constructor(e,{props:n={},editor:s}){this.editor=s,this.component=vn(e),this.el=document.createElement("div"),this.props=Zs(n),this.renderedComponent=this.renderComponent()}get element(){return this.renderedComponent.el}get ref(){var e,n,s,r;return!((n=(e=this.renderedComponent.vNode)===null||e===void 0?void 0:e.component)===null||n===void 0)&&n.exposed?this.renderedComponent.vNode.component.exposed:(r=(s=this.renderedComponent.vNode)===null||s===void 0?void 0:s.component)===null||r===void 0?void 0:r.proxy}renderComponent(){let e=Wt(this.component,this.props);return this.editor.appContext&&(e.appContext=this.editor.appContext),typeof document<"u"&&this.el&&De(e,this.el),{vNode:e,destroy:()=>{this.el&&De(null,this.el),this.el=null,e=null},el:this.el?this.el.firstElementChild:null}}updateProps(e={}){Object.entries(e).forEach(([n,s])=>{this.props[n]=s}),this.renderComponent()}destroy(){this.renderedComponent.destroy()}}const Ul={editor:{type:Object,required:!0},node:{type:Object,required:!0},decorations:{type:Object,required:!0},selected:{type:Boolean,required:!0},extension:{type:Object,required:!0},getPos:{type:Function,required:!0},updateAttributes:{type:Function,required:!0},deleteNode:{type:Function,required:!0}};class yl extends Xo{mount(){const e={editor:this.editor,node:this.node,decorations:this.decorations,selected:!1,extension:this.extension,getPos:()=>this.getPos(),updateAttributes:(r={})=>this.updateAttributes(r),deleteNode:()=>this.deleteNode()},n=this.onDragStart.bind(this);this.decorationClasses=me(this.getDecorationClasses());const s=Ft({extends:{...this.component},props:Object.keys(e),template:this.component.template,setup:r=>{var a,o;return je("onDragStart",n),je("decorationClasses",this.decorationClasses),(o=(a=this.component).setup)===null||o===void 0?void 0:o.call(a,r,{expose:()=>{}})},__scopeId:this.component.__scopeId,__cssModules:this.component.__cssModules,__name:this.component.__name,__file:this.component.__file});this.renderer=new bl(s,{editor:this.editor,props:e})}get dom(){if(!this.renderer.element||!this.renderer.element.hasAttribute("data-node-view-wrapper"))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.dom.querySelector("[data-node-view-content]")}update(e,n){const s=r=>{this.decorationClasses.value=this.getDecorationClasses(),this.renderer.updateProps(r)};if(typeof this.options.update=="function"){const r=this.node,a=this.decorations;return this.node=e,this.decorations=n,this.options.update({oldNode:r,oldDecorations:a,newNode:e,newDecorations:n,updateProps:()=>s({node:e,decorations:n})})}return e.type!==this.node.type?!1:(e===this.node&&this.decorations===n||(this.node=e,this.decorations=n,s({node:e,decorations:n})),!0)}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element&&this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element&&this.renderer.element.classList.remove("ProseMirror-selectednode")}getDecorationClasses(){return this.decorations.map(e=>e.type.attrs.class).flat().join(" ")}destroy(){this.renderer.destroy()}}function ql(t,e){return n=>n.editor.contentComponent?new yl(t,n,e):{}}const vl=({getId:t,anchorTypes:e=["heading"]})=>new U({key:new K("tableOfContent"),appendTransaction(n,s,r){const a=r.tr;let o=!1;if(n.some(i=>i.docChanged)){const i=[];r.doc.descendants((l,c)=>{const u=l.attrs["data-toc-id"];if(e.includes(l.type.name)&&l.textContent.length!==0){if(u==null||i.includes(u)){let d="";d=t?t(l.textContent):ie(),a.setNodeMarkup(c,void 0,{...l.attrs,"data-toc-id":d,id:d}),o=!0}i.push(u)}})}return o?a:null}}),un=(t,e)=>{let n=1;const s=e.at(-1),r=[...e].reverse().find(o=>o.originalLevel<=t.node.attrs.level),a=(r==null?void 0:r.level)||1;return n=t.node.attrs.level>((s==null?void 0:s.originalLevel)||1)?((s==null?void 0:s.level)||1)+1:t.node.attrs.level<((s==null?void 0:s.originalLevel)||1)?a:(s==null?void 0:s.level)||1,n},pn=(t,e)=>{const n=e.at(-1);return n?((n==null?void 0:n.itemIndex)||1)+1:1},Kn=(t,e)=>{const{editor:n}=e,s=[],r=[];let a=null;if(n.state.doc.descendants((o,i)=>{var l;!((l=e.anchorTypes)===null||l===void 0)&&l.includes(o.type.name)&&s.push({node:o,pos:i})}),s.forEach(o=>{const i=n.view.domAtPos(o.pos+1).node;e.storage.scrollPosition>=i.offsetTop&&(a=o.node.attrs["data-toc-id"],r.push(o.node.attrs["data-toc-id"]))}),t=t.map(o=>({...o,isActive:o.id===a,isScrolledOver:r.includes(o.id)})),e.onUpdate){const o=e.storage.content.length===0;e.onUpdate(t,o)}return t},hn=t=>{const{editor:e,onUpdate:n}=t,s=[];let r=[];const a=[];if(e.state.doc.descendants((o,i)=>{var l;!((l=t.anchorTypes)===null||l===void 0)&&l.includes(o.type.name)&&s.push({node:o,pos:i})}),s.forEach((o,i)=>{if(o.node.textContent.length===0)return;const l=e.view.domAtPos(o.pos+1).node,c=t.storage.scrollPosition>=l.offsetTop;a.push(l);const u=o.node.attrs.level,d=s[i-1],p=t.getLevelFn(o,r),h=t.getIndexFn(o,r,p);r=d?[...r,{itemIndex:h,id:o.node.attrs["data-toc-id"],originalLevel:u,level:p,textContent:o.node.textContent,pos:o.pos,editor:e,isActive:!1,isScrolledOver:!1,node:o.node,dom:l}]:[...r,{itemIndex:h,id:o.node.attrs["data-toc-id"],originalLevel:u,level:p,textContent:o.node.textContent,pos:o.pos,editor:e,isActive:!1,isScrolledOver:c,node:o.node,dom:l}]}),r=Kn(r,t),n){const o=t.storage.content.length===0;n(r,o)}t.storage.anchors=a,t.storage.content=r,e.state.tr.setMeta("toc",r),e.view.dispatch(e.state.tr)},Kl=F.create({name:"tableOfContents",addStorage:()=>({content:[],anchors:[],scrollHandler:()=>null,scrollPosition:0}),addGlobalAttributes(){return[{types:this.options.anchorTypes||["headline"],attributes:{id:{default:null,renderHTML:t=>({id:t.id}),parseHTML:t=>t.id||null},"data-toc-id":{default:null,renderHTML:t=>({"data-toc-id":t["data-toc-id"]}),parseHTML:t=>t.dataset.tocId||null}}}]},addOptions:()=>({onUpdate:()=>{},getId:t=>ie(),scrollParent:typeof window<"u"?()=>window:void 0,anchorTypes:["heading"]}),onUpdate(){var t;hn({editor:this.editor,storage:this.storage,onUpdate:(t=this.options.onUpdate)===null||t===void 0?void 0:t.bind(this),getIndexFn:this.options.getIndex||pn,getLevelFn:this.options.getLevel||un,anchorTypes:this.options.anchorTypes})},onCreate(){var t;const{tr:e}=this.editor.state,n=[];if(this.options.scrollParent&&typeof this.options.scrollParent!="function"&&console.warn("[Tiptap Table of Contents Deprecation Notice]: The 'scrollParent' option must now be provided as a callback function that returns the 'scrollParent' element. The ability to pass this option directly will be deprecated in future releases."),this.editor.state.doc.descendants((r,a)=>{var o;const i=r.attrs["data-toc-id"];if(!((o=this.options.anchorTypes)===null||o===void 0)&&o.includes(r.type.name)&&r.textContent.length!==0){if(i==null||n.includes(i)){let l="";l=this.options.getId?this.options.getId(r.textContent):ie(),e.setNodeMarkup(a,void 0,{...r.attrs,"data-toc-id":l,id:l})}n.push(i)}}),this.editor.view.dispatch(e),hn({editor:this.editor,storage:this.storage,onUpdate:(t=this.options.onUpdate)===null||t===void 0?void 0:t.bind(this),getIndexFn:this.options.getIndex||pn,getLevelFn:this.options.getLevel||un,anchorTypes:this.options.anchorTypes}),this.storage.scrollHandler=()=>{var r;if(!this.options.scrollParent)return;const a=typeof this.options.scrollParent=="function"?this.options.scrollParent():this.options.scrollParent,o=a instanceof HTMLElement?a.scrollTop:a.scrollY;this.storage.scrollPosition=o||0;const i=Kn(this.storage.content,{editor:this.editor,anchorTypes:this.options.anchorTypes,storage:this.storage,onUpdate:(r=this.options.onUpdate)===null||r===void 0?void 0:r.bind(this)});this.storage.content=i},!this.options.scrollParent)return;const s=typeof this.options.scrollParent=="function"?this.options.scrollParent():this.options.scrollParent;s&&s.addEventListener("scroll",this.storage.scrollHandler)},onDestroy(){if(!this.options.scrollParent)return;const t=typeof this.options.scrollParent=="function"?this.options.scrollParent():this.options.scrollParent;t&&t.removeEventListener("scroll",this.storage.scrollHandler)},addProseMirrorPlugins(){return[vl({getId:this.options.getId,anchorTypes:this.options.anchorTypes})]}});function Ml(t){var e;const{char:n,allowSpaces:s,allowedPrefixes:r,startOfLine:a,$position:o}=t,i=Yo(n),l=new RegExp(`\\s${i}$`),c=a?"^":"",u=s?new RegExp(`${c}${i}.*?(?=\\s${i}|$)`,"gm"):new RegExp(`${c}(?:^)?${i}[^\\s${i}]*`,"gm"),d=((e=o.nodeBefore)===null||e===void 0?void 0:e.isText)&&o.nodeBefore.text;if(!d)return null;const p=o.pos-d.length,h=Array.from(d.matchAll(u)).pop();if(!h||h.input===void 0||h.index===void 0)return null;const f=h.input.slice(Math.max(0,h.index-1),h.index),b=new RegExp(`^[${r==null?void 0:r.join("")}\0]?$`).test(f);if(r!==null&&!b)return null;const m=p+h.index;let g=m+h[0].length;return s&&l.test(d.slice(g-1,g+1))&&(h[0]+=" ",g+=1),m<o.pos&&g>=o.pos?{range:{from:m,to:g},query:h[0].slice(n.length),text:h[0]}:null}const kl=new K("suggestion");function Vl({pluginKey:t=kl,editor:e,char:n="@",allowSpaces:s=!1,allowedPrefixes:r=[" "],startOfLine:a=!1,decorationTag:o="span",decorationClass:i="suggestion",command:l=()=>null,items:c=()=>[],render:u=()=>({}),allow:d=()=>!0,findSuggestionMatch:p=Ml}){let h;const f=u==null?void 0:u(),b=new U({key:t,view(){return{update:async(m,g)=>{var M,x,L,I,O,$,J;const P=(M=this.key)===null||M===void 0?void 0:M.getState(g),V=(x=this.key)===null||x===void 0?void 0:x.getState(m.state),ft=P.active&&V.active&&P.range.from!==V.range.from,Tt=!P.active&&V.active,St=P.active&&!V.active,Xt=!Tt&&!St&&P.query!==V.query,Z=Tt,gt=Xt||ft,y=St;if(!Z&&!gt&&!y)return;const w=y&&!Z?P:V,C=m.dom.querySelector(`[data-decoration-id="${w.decorationId}"]`);h={editor:e,range:w.range,query:w.query,text:w.text,items:[],command:_=>l({editor:e,range:w.range,props:_}),decorationNode:C,clientRect:C?()=>{var _;const{decorationId:j}=(_=this.key)===null||_===void 0?void 0:_.getState(e.state),G=m.dom.querySelector(`[data-decoration-id="${j}"]`);return(G==null?void 0:G.getBoundingClientRect())||null}:null},Z&&((L=f==null?void 0:f.onBeforeStart)===null||L===void 0||L.call(f,h)),gt&&((I=f==null?void 0:f.onBeforeUpdate)===null||I===void 0||I.call(f,h)),(gt||Z)&&(h.items=await c({editor:e,query:w.query})),y&&((O=f==null?void 0:f.onExit)===null||O===void 0||O.call(f,h)),gt&&(($=f==null?void 0:f.onUpdate)===null||$===void 0||$.call(f,h)),Z&&((J=f==null?void 0:f.onStart)===null||J===void 0||J.call(f,h))},destroy:()=>{var m;h&&((m=f==null?void 0:f.onExit)===null||m===void 0||m.call(f,h))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(m,g,M,x){const{isEditable:L}=e,{composing:I}=e.view,{selection:O}=m,{empty:$,from:J}=O,P={...g};if(P.composing=I,L&&($||e.view.composing)){(J<g.range.from||J>g.range.to)&&!I&&!g.composing&&(P.active=!1);const V=p({char:n,allowSpaces:s,allowedPrefixes:r,startOfLine:a,$position:O.$from}),ft=`id_${Math.floor(Math.random()*4294967295)}`;V&&d({editor:e,state:x,range:V.range,isActive:g.active})?(P.active=!0,P.decorationId=g.decorationId?g.decorationId:ft,P.range=V.range,P.query=V.query,P.text=V.text):P.active=!1}else P.active=!1;return P.active||(P.decorationId=null,P.range={from:0,to:0},P.query=null,P.text=null),P}},props:{handleKeyDown(m,g){var M;const{active:x,range:L}=b.getState(m.state);return x&&((M=f==null?void 0:f.onKeyDown)===null||M===void 0?void 0:M.call(f,{view:m,event:g,range:L}))||!1},decorations(m){const{active:g,range:M,decorationId:x}=b.getState(m);return g?ge.create(m.doc,[fe.inline(M.from,M.to,{nodeName:o,class:i,"data-decoration-id":x})]):null}}});return b}export{jl as B,Cl as C,Zo as D,F as E,xl as H,Nl as I,Dl as L,Wl as N,Al as P,Vl as S,Tl as T,Hl as U,bl as V,B as a,ql as b,Sl as c,Il as d,Bl as e,$l as f,Ol as g,Pl as h,Rl as i,_l as j,Ll as k,Fl as l,R as m,Ul as n,Yi as o,Kl as p,na as q,zl as u};
