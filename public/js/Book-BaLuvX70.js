const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Markdown-CmIxG0NX.js","./tiptap-DZtZPlcx.js","./vendor-Ca624vxD.js","../css/vendor-BPbd6SgJ.css","./RemixIcon-Cy7WqHn8.js","./ai-B24q-XeF.js","./index-D5Zmbx3T.js","../css/index-DcOPh1ro.css","./message-BXUz8B8N.js","./_plugin-vue_export-helper-DlAUqK2U.js","../css/message-Ld0-QEl8.css","./utils-BIo_BOvM.js","../css/Markdown-DA1csfbN.css","./Text-B8BzxiH-.js","./Code-0zxFkx8P.js","../css/Code-BLTi7TbQ.css","./Task-BYQ2teV6.js","../css/Task-CoyDmG1V.css","./Drawing-B4Iwa-x9.js","../css/Drawing-Bdgq6z4a.css"])))=>i.map(i=>d[i]);
import{_ as n}from"./index-D5Zmbx3T.js";import{ai as h,aA as x,an as C,aj as m,aR as A,aD as p,aE as f,aS as R,a_ as I,aF as D,aZ as L,aY as P,aK as s}from"./vendor-Ca624vxD.js";import{u as V,g as y}from"./book-BoQwkkU-.js";import{m as _}from"./message-BXUz8B8N.js";import{R as B}from"./RemixIcon-Cy7WqHn8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j=h({__name:"Book",setup(O){const k=x(),r=C(),l=m(""),u=m(Array()),c=m(!1),i=m(!1);let v="";const d=m(""),b=()=>new Promise(t=>{if(l.value===v)return t(!0);let o=[];u.value.length>0&&(o=u.value.map(a=>({id:a.id,itemIndex:a.itemIndex,level:a.level,originalLevel:a.originalLevel,pos:a.pos,textContent:a.textContent})));let e={id:d.value,content:l.value,anchors:o};V(e).then(a=>{a&&(v=l.value,_.success("保存成功"),t(!0))}).catch(a=>{_.error(a),t(!1)})}),E=t=>{switch(t){case"markdown":{r.value=s(()=>n(()=>import("./Markdown-CmIxG0NX.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url));break}case"chat":case"text":{r.value=s(()=>n(()=>import("./Text-B8BzxiH-.js"),__vite__mapDeps([13,1,2,3,11]),import.meta.url));break}case"code":{r.value=s(()=>n(()=>import("./Code-0zxFkx8P.js"),__vite__mapDeps([14,2,3,11,15]),import.meta.url));break}case"task":{r.value=s(()=>n(()=>import("./Task-BYQ2teV6.js"),__vite__mapDeps([16,1,2,3,11,17]),import.meta.url));break}case"drawing":{r.value=s(()=>n(()=>import("./Drawing-B4Iwa-x9.js"),__vite__mapDeps([18,1,2,3,9,11,19]),import.meta.url));break}default:{r.value=s(()=>n(()=>import("./Markdown-CmIxG0NX.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url));break}}},g=()=>{i.value?b().then(()=>{i.value=!1}):i.value=c.value};return A(()=>k.params.id,(t,o)=>{t&&t!==o&&(typeof t=="string"&&(d.value=t||""),y(d.value).then(e=>{l.value=e.content||"",u.value=e.anchors||[],v=e.content||"",c.value=e.editable||!1,E(e.type)}).catch(e=>{_.error(e)}))},{immediate:!0}),(t,o)=>(p(),f("div",{class:P(["w-full h-full flex",{"select-none":!c.value}])},[(p(),R(I(r.value),{editable:i.value,modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=e=>l.value=e),anchors:u.value,"onUpdate:anchors":o[1]||(o[1]=e=>u.value=e)},null,40,["editable","modelValue","anchors"])),c.value?(p(),f("div",{key:0,class:"fixed top-28 right-4 w-8 h-8 text-center rounded-full border bg-blue-700/10 hover:bg-blue-500 z-40 cursor-pointer",onClick:g},[D(B,{class:"text-slate-50 text-lg",name:i.value?"save-line":"file-edit-line"},null,8,["name"])])):L("",!0)],2))}});export{j as default};
