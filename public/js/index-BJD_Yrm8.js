const __vite__fileDeps=["./Markdown-SpexRMaa.js","./tiptap-CwgDY1J2.js","./vendor-CyQ1aPvD.js","../css/vendor-St55MTdn.css","./utils-_yvyshlj.js","../css/Markdown-DCFTSIbh.css","./Text-CFHmariN.js","./Code-Dpt7sAWG.js","../css/Code-BLTi7TbQ.css","./Task-COfSzYy4.js","../css/Task-CoyDmG1V.css","./Drawing-DOZzcUc5.js","../css/Drawing-Bdgq6z4a.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var st=Object.defineProperty;var at=(t,e,o)=>e in t?st(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var F=(t,e,o)=>at(t,typeof e!="symbol"?e+"":e,o);import{at as B,au as H,av as ce,aw as le,ax as de,ay as p,az as f,aA as v,aB as j,aC as s,aD as be,ae as h,aE as N,aF as U,aG as L,aH as M,aI as T,aJ as Ce,aK as Le,ag as pe,aL as R,aM as q,aN as xe,ak as Q,aO as nt,aP as V,aQ as Ue,ar as ye,ad as se,aR as D,aS as W,aT as rt,aU as it,aV as oe,aW as Re,aX as Oe,aj as ze,aY as ut,aZ as ee,ao as ie,a_ as ct,a$ as dt,b0 as pt,b1 as mt,b2 as ft,b3 as vt}from"./vendor-CyQ1aPvD.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}})();const qe=""+new URL("../assets/bg-01-BiePeNN8.avif",import.meta.url).href,ht="http://42.193.244.237:3000";let gt=ht;function bt(t,e){B.interceptors.request.use(function(o){const l=localStorage.getItem("me_token");return o.headers.Authorization=l,o.headers.appId=t.query.appId,o.url&&!new RegExp(/http|https/).test(o.url)&&(o.url=gt+o.url),console.log("Starting request",o),o},function(o){return console.log("Request error",o),Promise.reject(o)}),B.interceptors.response.use(function(o){return o.status===200?(console.log("Successful response",o),o):(o.status===401&&e(),Promise.reject(o))},function(o){return o.response&&o.response.status===401&&e(),Promise.reject(o)})}const xt=qe,_t=s("div",{class:"absolute z-20 top-0 lg:top-0 inset-x-0 flex justify-center lg:justify-end overflow-hidden pointer-events-none"},[s("div",{class:"w-[80rem] lg:w-[100rem] flex-none flex justify-end"},[s("picture",null,[s("source",{srcset:xt,type:"image/avif"}),s("img",{src:qe,alt:"",class:"w-[70rem] flex-none max-w-none dark:hidden",decoding:"async"})])])],-1),yt={__name:"App",setup(t){const e=H(),o=ce();return le(()=>{bt(o,()=>{localStorage.removeItem("me_token"),e.replace("/login")})}),(l,n)=>{const a=de("router-view");return p(),f(j,null,[_t,v(a)],64)}}};window._iconfont_svg_string_4523946='<svg><symbol id="me-error" viewBox="0 0 1024 1024"><path d="M512 725.333333a68.266667 68.266667 0 1 1 0 136.533334 68.266667 68.266667 0 0 1 0-136.533334z" fill="#e74c3c" ></path><path d="M512 42.666667c259.2 0 469.333333 210.133333 469.333333 469.333333s-210.133333 469.333333-469.333333 469.333333S42.666667 771.2 42.666667 512 252.8 42.666667 512 42.666667zM417.450667 357.589333a42.666667 42.666667 0 0 0-56.32 63.914667L451.669333 512l-90.538666 90.496-3.541334 4.053333a42.666667 42.666667 0 0 0 63.914667 56.32L512 572.330667l90.496 90.538666 4.053333 3.541334a42.666667 42.666667 0 0 0 56.32-63.914667L572.330667 512l90.538666-90.496 3.541334-4.053333a42.666667 42.666667 0 0 0-63.914667-56.32L512 451.669333 421.504 361.130667z" fill="#e74c3c" ></path></symbol><symbol id="me-success" viewBox="0 0 1024 1024"><path d="M512 32C248 32 32 248 32 512s216 480 480 480 480-216 480-480-216-480-480-480z m280.00000031 391.99999969L504.00000031 720.00000031c-7.99999969 7.99999969-16.00000031 16.00000031-32.00000062 15.99999938-7.99999969 0-24-7.99999969-31.99999969-15.99999938l-160.00000031-168c0-7.99999969-7.99999969-16.00000031-7.99999969-32.00000062 0-7.99999969 7.99999969-16.00000031 7.99999969-24 16.00000031-16.00000031 40.00000031-16.00000031 56.00000062 0l135.99999938 144 256.00000031-271.99999969c16.00000031-16.00000031 40.00000031-16.00000031 55.99999969 0 16.00000031 16.00000031 16.00000031 40.00000031 8.00000062 55.99999969z" fill="#2ecc71" ></path></symbol><symbol id="me-info" viewBox="0 0 1024 1024"><path d="M512 26.59669333C243.98203221 26.59669333 26.54814777 243.88494222 26.54814777 512c0 268.11505778 217.43388445 485.45185223 485.45185223 485.45185223 268.16360334 0 485.45185223-217.33679445 485.45185223-485.45185223 0-268.06651221-217.28824889-485.3547611-485.45185223-485.3547611z m76.11884999 664.09813334c-36.60307001 54.85605888-73.83722667 97.33309667-136.60615111 97.33309667-42.81685333-6.9419611-60.29312-37.67106333-51.02098887-68.88561777l80.68209778-267.19270002c1.94180779-6.50505443-1.35926557-13.4955611-7.28177778-15.63154888-5.97105778-2.03889778-17.67044779 5.67978667-27.81639111 16.69954333L397.43336334 511.66018333c-1.35926557-9.80612779-0.14563555-26.11731001-0.14563555-32.67090888 36.60307001-55.00169443 96.79909888-98.35254557 137.52850887-98.35254556 38.83614777 3.93216 57.2833189 34.95253333 50.43844779 69.03125333l-81.16755002 268.45487445a12.52465778 12.52465778 0 0 0 7.62159446 14.17519332c5.92251221 2.03889778 18.54426112-5.72833223 28.54456889-16.69954332l48.78791111-58.69112889c1.35926557 9.80612779-0.9223589 27.18530333-0.9223589 33.73890332z m-10.77703111-349.0398811c-30.82619221 0-55.92405333-22.42787555-55.92405333-55.53569224 0-33.01072555 25.09786112-55.53569223 55.92405333-55.53569223 30.82619221 0 55.77841778 22.47642112 55.77841778 55.53569223 0 33.10781667-24.95222557 55.53569223-55.82696221 55.53569224z" fill="#4a90e2" ></path></symbol><symbol id="me-warning" viewBox="0 0 1024 1024"><path d="M844.8 179.2C759.466667 93.866667 640 42.666667 512 42.666667S264.533333 93.866667 179.2 179.2 42.666667 384 42.666667 512s51.2 247.466667 136.533333 332.8S379.733333 981.333333 512 981.333333c132.266667 0 247.466667-51.2 332.8-136.533333S981.333333 644.266667 981.333333 512c0-132.266667-51.2-247.466667-136.533333-332.8zM469.333333 256v-4.266667c4.266667-21.333333 21.333333-38.4 42.666667-38.4s38.4 17.066667 42.666667 38.4v349.866667c-4.266667 21.333333-21.333333 38.4-42.666667 38.4s-38.4-17.066667-42.666667-38.4V256z m42.666667 533.333333c-29.866667 0-51.2-25.6-51.2-51.2S482.133333 682.666667 512 682.666667s51.2 25.6 51.2 51.2-21.333333 55.466667-51.2 55.466666z" fill="#f39c12" ></path></symbol><symbol id="me-progress" viewBox="0 0 1024 1024"><path d="M960.7 737.8V98H64.5v639.8h384v127.8h-192v64h512.1v-64h-192V737.8h384.1zM128.5 162h768.2v511.8H128.5V162z"  ></path><path d="M287.2 567c-7.9 0-15.7-2.9-21.9-8.7-12.9-12.1-13.5-32.4-1.4-45.2l141-150c11.2-11.9 29.6-13.5 42.6-3.6l123.6 93.3 142.4-158.2c11.8-13.1 32.1-14.2 45.2-2.4 13.1 11.8 14.2 32.1 2.4 45.2l-162 180c-11.1 12.3-29.8 14.1-43.1 4.1l-124.1-93.7-121.4 129.1c-6.3 6.7-14.8 10.1-23.3 10.1z"  ></path></symbol><symbol id="me-progress-simple" viewBox="0 0 1024 1024"><path d="M624.469333 694.784c-32.028444 20.878222-63.943111 19.968-94.492444-9.557333L367.274667 521.671111 175.786667 708.835556c-30.151111 30.151111-73.443556 42.666667-100.522667 16.839111s-23.665778-65.763556 6.428444-95.857778c0.625778-0.568889 1.251556-1.365333 1.991112-1.934222l221.866666-214.243556a79.872 79.872 0 0 1 64.341334-21.617778c17.237333 1.706667 33.735111 9.045333 47.104 21.731556l166.343111 160.654222 277.390222-268.060444c31.175111-29.070222 71.793778-27.477333 92.956444-4.892445 21.162667 22.528 17.408 61.155556-11.946666 90.567111-190.179556 187.960889-295.879111 288.881778-317.269334 302.819556z" fill="#333333" ></path></symbol></svg>',function(t){var o=(o=document.getElementsByTagName("script"))[o.length-1],e=o.getAttribute("data-injectcss"),o=o.getAttribute("data-disable-injectsvg");if(!o){var l,n,a,r,i,d=function(b,c){c.parentNode.insertBefore(b,c)};if(e&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(b){console&&console.log(b)}}l=function(){var b,c=document.createElement("div");c.innerHTML=t._iconfont_svg_string_4523946,(c=c.getElementsByTagName("svg")[0])&&(c.setAttribute("aria-hidden","true"),c.style.position="absolute",c.style.width=0,c.style.height=0,c.style.overflow="hidden",c=c,(b=document.body).firstChild?d(c,b.firstChild):b.appendChild(c))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(l,0):(n=function(){document.removeEventListener("DOMContentLoaded",n,!1),l()},document.addEventListener("DOMContentLoaded",n,!1)):document.attachEvent&&(a=l,r=t.document,i=!1,m(),r.onreadystatechange=function(){r.readyState=="complete"&&(r.onreadystatechange=null,u())})}function u(){i||(i=!0,a())}function m(){try{r.documentElement.doScroll("left")}catch{return void setTimeout(m,50)}u()}}(window);const wt=t=>B.post("/users/login",t),kt=t=>B.post("/users/register",t),Fe=()=>B.get("/users/getLoginUser").then(t=>t.data.success?t.data.data:Promise.reject(t.data.message)),$t=()=>B.get("/users/getContactList").then(t=>t.data.success?t.data.data:Promise.reject(t.data.message)),ae=(t,e)=>{const o=t.__vccOpts||t;for(const[l,n]of e)o[l]=n;return o},Ct={class:"symbol-icon-svg","aria-hidden":"true"},It=["xlink:href"],Vt={__name:"IconSvg",props:{name:{type:String,required:!0}},setup(t){const e=t,o=be(()=>`#me-${e.name}`);return(l,n)=>(p(),f("svg",Ct,[s("use",{"xlink:href":o.value},null,8,It)]))}},Bt=ae(Vt,[["__scopeId","data-v-5f02164a"]]),St={key:0,class:"flex w-full align-middle justify-center p-4"},Mt={class:"flex items-center text-sm min-w-28 px-4 py-2 rounded bg-white shadow shadow-slate-300"},Pt={__name:"Message",props:{config:{type:Object,required:!0,default:()=>({content:"空消息",type:"info"})}},emits:["close"],setup(t,{emit:e}){const o=e,l=h(!0),n=()=>{l.value=!1,o("close")};return(a,r)=>(p(),N(Ce,{name:"fade"},{default:U(()=>[l.value?(p(),f("div",St,[s("div",Mt,[v(Bt,{name:t.config.type,class:"mr-2"},null,8,["name"]),s("p",{class:L([t.config.type,"mr-2"])},M(t.config.content),3),s("button",{onClick:n,class:"text-slate-400 hover:text-slate-700"}," × ")])])):T("",!0)]),_:1}))}},Tt=ae(Pt,[["__scopeId","data-v-4e28a757"]]),we=t=>{const e=v(Tt,{config:t,onClose:()=>{je(o)}}),o=document.createElement("div");o.className="fixed top-4 left-0 w-full z-50",Le(e,o),document.body.appendChild(o),setTimeout(()=>{je(o)},3e3)},je=t=>{Le(null,t),t.remove()},Et=t=>{we({content:t,type:"info"})},jt=t=>{we({content:t,type:"warning"})},At=t=>{we({content:t,type:"error"})},Lt=t=>{we({content:t,type:"success"})},A={info:Et,warning:jt,error:At,success:Lt};class Ut{constructor(e){F(this,"stars");F(this,"canvas");F(this,"context");F(this,"count");F(this,"frequency");F(this,"duration");let{count:o,frequency:l,duration:n,background:a}=e||{};this.stars=[],this.count=o||200,this.frequency=l||1e-4,this.duration=n||1e3;const r=document.createElement("canvas");r.style.cssText="position: absolute; top: 0; left: 0; width: 100%; height: 100;z-index: -1;",r.style.background=a||"black",r.width=window.innerWidth,r.height=window.innerHeight,document.body.appendChild(r),this.canvas=r,this.context=r.getContext("2d")}createStar(){return{x:Math.random()*this.canvas.width,y:Math.random()*this.canvas.height,radius:Math.random()*2+1,brightness:Math.random()*.5+.5}}drawStar(e){let o=this.context;o&&(o.beginPath(),o.arc(e.x,e.y,e.radius,0,Math.PI*2),o.fillStyle=`rgba(255, 255, 255, ${e.brightness})`,o.fill())}animate(){let e=this.canvas,o=this.context,l=this.stars;if(o){o.clearRect(0,0,e.width,e.height);for(let n=l.length;n<this.count;n++)l.push(this.createStar());for(let n=l.length-1;n>=0;n--){const a=l[n];if(this.drawStar(a),Math.random()<.05&&(a.brightness=Math.random()*.5+.5),Math.random()<this.frequency){const r={...a,life:this.duration};l.push(r)}a.y>e.height+a.radius||a.y<-a.radius?l.splice(n,1):a.y+=Math.random()}for(let n=l.length-1;n>=0;n--){const a=l[n];a&&"life"in a&&(this.drawMeteor(a),typeof a.life=="number"&&(a.life-=10,a.life<=0&&l.splice(n,1)))}requestAnimationFrame(()=>this.animate())}}drawMeteor(e){let o=this.context;if(!o)return;let l=this.stars;o.beginPath(),o.moveTo(e.x,e.y),o.lineTo(e.x+100,e.y-100),o.strokeStyle="white",o.lineWidth=2,o.stroke(),e.x-=15,e.y+=15,e.life-=10,e.life<=0&&l.splice(l.indexOf(e),1)}}const Ie=h(),Ve=t=>{Ie.value=t},Rt=()=>Ie.value,Ot=()=>{var t;return(t=Ie.value)==null?void 0:t.userId},zt={class:"h-screen flex items-center justify-center"},qt={class:"h-80 w-80 p-4 flex flex-col bg-transparent rounded-lg shadow-md"},Ft=s("span",{class:"font-sans font-normal lg:font-semibold text-2xl lg:text-3xl leading-10 text-slate-500"}," I Want Progress ",-1),Wt={__name:"Login",setup(t){const e=h(""),o=h(""),l=H();let n=null;const a=()=>{console.log(e.value,o.value,xe(o.value)),wt({name:e.value,password:xe(o.value)}).then(i=>{if(console.log(i),i&&i.data)if(i.data.success){let{token:d,userId:u,name:m,avatar:b}=i.data.data;d?(localStorage.setItem("me_token",d),Ve({userId:u,name:m,avatar:b}),l.push("/home")):i.data.message&&A.error(i.data.message)}else console.log("登录失败"),i.data.message&&A.error(i.data.message);else i.data.message&&A.error("登录失败")})},r=()=>{l.push("register")};return le(()=>{n=new Ut({count:50,background:"rgb(41 37 36)"}),n.animate()}),pe(()=>{n.canvas.remove(),n=null}),(i,d)=>(p(),f("div",zt,[s("div",qt,[Ft,R(s("input",{class:"px-4 py-3 my-2 bg-transparent text-slate-300 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent",type:"text","onUpdate:modelValue":d[0]||(d[0]=u=>e.value=u),placeholder:"请输入用户名"},null,512),[[q,e.value]]),R(s("input",{class:"px-4 py-3 my-2 bg-transparent text-slate-300 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent",type:"password","onUpdate:modelValue":d[1]||(d[1]=u=>o.value=u),placeholder:"请输入密码"},null,512),[[q,o.value]]),s("div",{class:"flex flex-row justify-between my-2"},[s("button",{class:"w-32 py-3 px-4 bg-blue-300 text-white font-semibold rounded-md shadow-md hover:bg-blue-600",onClick:a},"登录"),s("button",{class:"w-32 py-3 px-4 bg-red-300 text-white font-semibold rounded-md shadow-md hover:bg-red-600",onClick:r},"注册")])])]))}},k={__name:"RemixIcon",props:{name:{type:String,required:!0}},setup(t){return(e,o)=>(p(),f("i",{class:L(`ri-${t.name}`)},null,2))}},Nt={class:"flex flex-col w-full lg:w-80 mx-auto max-h-full lg:max-h-[60%] shadow-lg rounded-lg bg-white"},Dt={key:0,class:"flex p-4 border-b border-slate-100"},Gt={class:"flex flex-1 items-center"},Kt={class:"text-lg font-semibold"},Ht={class:"flex flex-1 flex-col p-4 overflow-auto"},Jt={class:"flex border-t border-slate-100 shadow-lg rounded-lg"},me={__name:"Modal",props:{visible:{type:Boolean,default:!1},title:{type:String,default:""},width:{type:Number,default:480},closable:{type:Boolean,default:!0},container:{type:[String,Object],default:"body"}},emits:["update:visible","confirm","cancel"],setup(t,{emit:e}){const o=t,l=e,{proxy:n}=ye();let a=null;const r=()=>{l("update:visible",!1),d()},i=()=>{l("confirm")},d=()=>{l("cancel")};return Q(()=>{typeof o.container=="string"?a=document.querySelector(o.container):a=o.container,a?a.appendChild(n.$el):console.error("Invalid container specified for CustomPopup.")}),nt(()=>{a&&a.contains(n.$el)&&(a.removeChild(n.$el),a=null)}),(u,m)=>(p(),f("div",{class:L(["flex flex-col lg:justify-center justify-end fixed top-0 left-0 inset-0 z-50 backdrop-blur bg-black/20 transition-transform duration-500 ease-in-out delay-200",t.visible?"translate-y-0":"translate-y-[100%]"])},[s("div",Nt,[t.title||!t.closable?(p(),f("div",Dt,[s("div",Gt,[s("span",Kt,M(t.title),1)]),t.closable?(p(),f("button",{key:0,class:"rounded px-2 text-xl hover:bg-blue-300 hover:text-slate-100",onClick:V(r,["stop"])},[v(k,{name:"close-line",class:"leading-6"})])):T("",!0)])):T("",!0),s("div",Ht,[Ue(u.$slots,"default")]),s("div",Jt,[s("button",{class:"basis-1/2 py-3 bg-blue-400 text-white font-medium hover:bg-blue-700",onClick:V(i,["stop"])},"确定"),s("button",{class:"basis-1/2 py-3 font-medium bg-white hover:bg-slate-50",onClick:V(d,["stop"])},"取消")])])],2))}},Xt={class:"text-xs lg:text-base break-all text-center"},Yt={key:0,class:"absolute bottom-0 left-0 right-0 z-10 bg-slate-300/10 flex justify-center py-2 text-xl backdrop-blur-lg"},Qt=s("span",{class:"align-center"},"你真的要删除这个卡片？",-1),_e=se({__name:"Card",props:{modelValue:{type:Object,default:()=>({})},theme:{type:String,default:"purple",validator(t){return["slate","purple","blue","green","red","yellow","sky","orange","pink"].includes(t)}},editable:{type:Boolean,default:!1}},emits:["update:modelValue","cardClick","edit","remove"],setup(t,{emit:e}){const o=H(),l=t,n=h(!1),a=h(!1),r=e,i=()=>{!l.modelValue||!l.modelValue.url?r("cardClick"):l.modelValue.inner?o.push({path:l.modelValue.url,query:{appId:l.modelValue._id}}):window.open(l.modelValue.url,"_blank")},d=()=>{l.editable&&r("edit",l.modelValue)},u=()=>{a.value=!0},m=()=>{a.value=!1},b=()=>{r("remove",l.modelValue)},c=()=>{n.value=!0},_=()=>{n.value=!1};return(x,w)=>(p(),f(j,null,[s("a",{class:L(["relative w-[4.5rem] h-[4.5rem] lg:w-28 lg:h-28 p-1 lg:p-4 flex flex-col items-center rounded shadow-md hover:shadow-lg",`text-${t.theme}-400 hover:text-${t.theme}-700`]),onClick:V(i,["stop"]),onMouseover:c,onMouseleave:_},[v(k,{class:"text-2xl lg:text-4xl lg:mb-2",name:t.modelValue.icon||"book-2-line"},null,8,["name"]),s("span",Xt,M(t.modelValue.title),1),t.editable&&n.value?(p(),f("div",Yt,[v(k,{class:L(["mx-1",`text-${t.theme}-400 hover:text-${t.theme}-700`]),name:"edit-line",onClick:V(d,["stop"])},null,8,["class"]),v(k,{class:L(["mx-1",`text-${t.theme}-400 hover:text-${t.theme}-700`]),name:"delete-bin-line",onClick:V(u,["stop"])},null,8,["class"])])):T("",!0)],34),T("",!0),v(me,{visible:a.value,closable:!1,title:"确认删除",onConfirm:b,onCancel:m},{default:U(()=>[Qt]),_:1},8,["visible"])],64))}});var We=(t=>(t.markdown="富文本",t.text="文字",t.drawing="图画",t.task="待办",t.code="代码",t.link="链接",t.chat="对话",t))(We||{});const Zt={class:"flex p-2 bg-white text-slate-600 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent"},eo={class:"flex-1 pr-4"},to={key:0},oo={key:1,class:"text-slate-300"},lo={class:"p-2 bg-white shadow-xl rounded"},so=["onClick"],Ne={__name:"Select",props:{options:{type:Array,default:()=>[]},modelValue:String,palaceHolder:{type:String,default:"请选择"}},emits:["update:value"],setup(t,{emit:e}){const o=h(),l=t,n=e,a=h(""),r=i=>{a.value=i.label,n("update:modelValue",i.value),o.value.hide()};return D(()=>l.modelValue,i=>{l.options.map(({value:d,label:u})=>{i===d&&(a.value=u)})},{immediate:!0}),(i,d)=>{const u=de("tippy");return p(),f("div",Zt,[s("div",eo,[a.value?(p(),f("span",to,M(a.value),1)):(p(),f("span",oo,M(t.palaceHolder),1))]),v(u,{class:"w-0",ref_key:"dropdown",ref:o,trigger:"click",placement:"bottom-end",offset:[0,10],animation:"fade",interactive:!0,arrow:!1},{content:U(()=>[s("div",lo,[(p(!0),f(j,null,W(t.options,(m,b)=>(p(),f("div",{key:b,class:"w-full px-2 py-1 cursor-pointer hover:bg-blue-100",onClick:c=>r(m)},M(m.label),9,so))),128))])]),default:U(()=>[v(k,{class:"float-right hover:text-blue-500",name:"arrow-down-s-line"})]),_:1},512)])}}},ao={class:"px-2"},no=s("label",{class:"mr-2",for:"inner"},"是否内置",-1),ro={__name:"AppModal",props:{title:{type:String,default:"新增应用"},visible:{type:Boolean,default:!1},app:{type:Object,default:()=>({title:"",url:"",icon:"",inner:!1})}},emits:["update:app","confirm","cancel"],setup(t,{emit:e}){const o=t,l=e,n=h(o.visible),a=()=>{l("confirm"),n.value=!1},r=()=>{l("cancel"),n.value=!1};return D(()=>o.visible,()=>{n.value=o.visible}),(i,d)=>(p(),N(me,{title:t.title,visible:n.value,"onUpdate:visible":d[4]||(d[4]=u=>n.value=u),onConfirm:a,onCancel:r},{default:U(()=>[R(s("input",{class:"p-2 mb-4 bg-white text-slate-600 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",type:"text","onUpdate:modelValue":d[0]||(d[0]=u=>t.app.title=u),placeholder:"请输入应用标题"},null,512),[[q,t.app.title]]),R(s("input",{class:"p-2 mb-4 bg-white text-slate-600 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",type:"text","onUpdate:modelValue":d[1]||(d[1]=u=>t.app.url=u),placeholder:"请输入应用地址"},null,512),[[q,t.app.url]]),R(s("input",{class:"p-2 mb-4 bg-white text-slate-600 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",type:"text","onUpdate:modelValue":d[2]||(d[2]=u=>t.app.icon=u),placeholder:"应用图标"},null,512),[[q,t.app.icon]]),s("div",ao,[no,s("span",null,[R(s("input",{id:"inner",type:"checkbox","onUpdate:modelValue":d[3]||(d[3]=u=>t.app.inner=u)},null,512),[[rt,t.app.inner]])])])]),_:1},8,["title","visible"]))}},ue={__name:"Avatar",props:{size:{type:String,default:"md",validate:function(t){return["sm","md","lg"].indexOf(t)!==-1}},icon:{type:String,default:"user-2-fill"}},setup(t){const e=t,o=be(()=>{switch(e.size){case"sm":return"w-6 h-6";case"md":return"w-8 h-8";case"lg":return"w-10 h-10"}}),l=be(()=>{switch(e.size){case"sm":return"font-normal text-base";case"md":return"font-medium text-xl";case"lg":return"font-bold text-2xl"}});return(n,a)=>(p(),f("div",{class:L(["inline-block rounded-lg bg-gradient-to-r from-cyan-500 to-blue-500 text-center m-2",o.value])},[v(k,{class:L(["text-slate-50",l.value]),name:t.icon},null,8,["name","class"])],2))}},io={id:"header",class:"sticky h-16 top-0 z-20 w-full max-w-screen-2xl mx-auto backdrop-blur lg:border-b border-slate-900/10 bg-white/90 lg:bg-white/60 flex-none flex lg:shadow-none shadow-lg"},uo={class:"flex items-center px-2 sm:px-6 lg:mx-6 lg:px-0 xl:mx-8"},co={class:"flex-auto flex items-center justify-end pr-4 sm:pr-6 xl:pr-8"},po={class:"text-sm font-bold"},mo={class:"min-w-20 lg:min-w-24 bg-white shadow-xl border border-slate-50 rounded text-center"},fo={class:"px-2 py-1 text-slate-500 hover:bg-blue-300 hover:text-slate-50 rounded-sm"},vo={class:"px-2 py-1 text-slate-500 hover:bg-blue-300 hover:text-slate-50 rounded-sm"},J={__name:"Header",props:{hiddenFold:{type:Boolean,default:!1},fold:{type:Boolean,default:!0}},emits:["toggleFold"],setup(t,{emit:e}){const o=h(),l=H(),n=e,a=()=>{l.push("/home")},r=()=>{n("toggleFold")},i=()=>{localStorage.removeItem("token"),l.push("/login")},d=()=>{l.push("/setting")};return le(()=>{let u=Rt();u?o.value=u:Fe().then(m=>{o.value=m,Ve(m)})}),(u,m)=>{const b=de("tippy");return p(),f("div",io,[s("div",{class:"hidden lg:flex flex-none pl-4 sm:pl-6 xl:pl-8 items-center border-b border-gray-200 lg:border-b-0 lg:w-60 xl:w-72"},[s("div",{class:"font-semibold text-3xl text-slate-500 cursor-pointer",onClick:a},"I Want progress")]),s("div",uo,[t.hiddenFold?T("",!0):(p(),N(k,{key:0,name:t.fold?"menu-fold-line":"menu-unfold-line",class:"lg:hidden py-1 px-2 text-2xl text-slate-500 hover:text-slate-700",onClick:r},null,8,["name"])),v(k,{name:"home-8-line",class:"lg:hidden py-1 px-2 text-2xl text-blue-500 hover:text-blue-700",onClick:a}),Ue(u.$slots,"default")]),s("div",co,[v(b,{trigger:"mouseenter click",placement:"bottom-end",offset:[10,0],animation:"slide",interactive:!0,arrow:!0},{content:U(()=>[s("div",mo,[s("ul",null,[s("ol",fo,[s("a",{onClick:V(d,["stop"])},"我的")]),s("ol",vo,[s("a",{onClick:V(i,["stop"])},"退出")])])])]),default:U(()=>[v(ue,{size:"sm"}),s("span",po,M(o.value&&o.value.name),1)]),_:1})])])}}},ho=()=>B.get("/word/getDailyEnglish").then(t=>{if(t.data.success)return t.data.data;t.data.message&&A.error(t.data.message)}),go=t=>B.get("/word/getWords",{params:{newWord:t}}).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),bo=t=>B.post("/word/createWord",t).then(e=>e&&e.data&&e.data.success?(e.data.message&&A.success(e.data.message),e.data.data):Promise.reject(e&&e.data&&e.data.message)),xo=(t,e)=>B.post("/word/toggleNewWord",{id:t,newWord:e}).then(o=>o&&o.data&&o.data.success?(o.data.message&&A.success(o.data.message),o.data.data):Promise.reject(o&&o.data&&o.data.message)),_o={class:"flex flex-col items-center shadow-lg rounded-lg bg-white"},yo=["src","alt"],wo={class:"lg:text-lg text-slate-300"},ko={class:"p-4 lg:p-8 lg:font-medium lg:text-lg text-slate-500"},$o={__name:"Note",props:{modelValue:{type:Object,default:()=>({_id:"",image:"",word:"",from:"",photoBy:""})}},setup(t){return(e,o)=>(p(),f("div",_o,[s("img",{class:"w-full lg:w-[50rem]",src:t.modelValue.image,alt:t.modelValue.photoBy},null,8,yo),s("span",wo,M(t.modelValue.photoBy),1),s("p",ko,M(t.modelValue.word),1)]))}},Co=()=>B.get("/app/getApps").then(t=>t&&t.data&&t.data.success?t.data.data:Promise.reject(t&&t.data&&t.data.message)),Io=t=>B.post("/app/createApp",t).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),Vo=t=>B.post("/app/updateApp",t).then(e=>e&&e.data&&e.data.success?(e.data.message&&A.success(e.data.message),e.data.data):Promise.reject(e&&e.data&&e.data.message)),Bo=t=>B.post("/app/removeApp",{id:t}).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),So=()=>B.get("/note/getOneNote").then(t=>{if(t.data.success)return t.data.data;t.data.message&&A.error(t.data.message)}),Mo={class:"h-screen w-full flex flex-col overflow-y-auto"},Po={class:"flex p-2 lg:p-4 flex-wrap justify-start"},To={class:"flex flex-col items-center p-2 lg:p-4 basis-1/4 md:basis-1/6 lg:basis-1/12"},Eo={__name:"Home",setup(t){const e=h([]),o=h(!1),l=h(!1),n=h(void 0),a=h(!1),r=h(),i=()=>{a.value=!0,n.value={title:"新增",icon:"book-2-fill",inner:!0},l.value=!0},d=c=>{a.value=!1,n.value=c,l.value=!0},u=async()=>{a.value?await Io(n.value).then(c=>{e.value.push(c),a.value=!1}):await Vo(n.value).catch(c=>{A.error(c)}),l.value=!1},m=()=>{a.value=!1,n.value=void 0,l.value=!1},b=c=>{Bo(c).then(_=>{e.value=e.value.filter(x=>x._id!==c)})};return Q(()=>{Co().then(c=>{let{editable:_,apps:x}=c||{};e.value=x||[],o.value=_}),So().then(c=>{r.value=c})}),(c,_)=>(p(),f(j,null,[s("div",Mo,[v(J,{hiddenFold:!0}),v($o,{class:"flex-none m-4 lg:m-8",modelValue:r.value},null,8,["modelValue"]),s("div",Po,[(p(!0),f(j,null,W(e.value,(x,w)=>(p(),f("div",{key:x._id,class:"flex flex-col items-center p-2 lg:p-4 basis-1/4 md:basis-1/6 lg:basis-1/12"},[v(_e,{class:"w-full h-full",editable:x.system&&o.value||!x.system,modelValue:x,theme:"blue",onEdit:$=>d(x),onRemove:$=>b(x._id)},null,8,["editable","modelValue","onEdit","onRemove"])]))),128)),s("div",To,[v(_e,{theme:"blue",modelValue:{title:"新增应用",icon:"add-line"},onCardClick:i})])])]),v(ro,{title:`${a.value?"新增应用":"编辑应用"}`,visible:l.value,app:n.value,onConfirm:u,onCancel:m},null,8,["title","visible","app"])],64))}},jo={class:"h-screen flex items-center justify-center"},Ao={class:"min-h-80 w-80 p-4 flex flex-col bg-slate-50 rounded-lg shadow-md"},Lo=s("span",{class:"font-sans font-semibold text-3xl leading-10 text-slate-300"},"I Want Progress",-1),Uo={class:"text-red-400 text-sm"},Ro={__name:"Register",setup(t){const e=h(""),o=h(""),l=h(""),n=h(""),a=H(),r=()=>{let d="",u=!0;return o.value?o.value.length<6?(d="请输入至少6位的密码",u=!1):o.value!==l.value&&(d="两次输入密码不同",u=!1):(d="请输入密码",u=!1),{message:d,success:u}},i=()=>{let d=r();if(!d.success){n.value=d.message,console.log(n);return}console.log(e.value,o.value,xe(o.value)),kt({name:e.value,password:xe(o.value)}).then(u=>{console.log(u),u&&u.data?u.data.success?(u.data.message&&A.success(u.data.message),a.push("login")):(console.log("注册失败"),u.data.message&&A.error(u.data.message)):(console.log("注册失败"),A.error("注册失败"))})};return(d,u)=>(p(),f("div",jo,[s("div",Ao,[Lo,R(s("input",{class:"px-4 py-3 my-2 bg-white text-slate-600 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",type:"text","onUpdate:modelValue":u[0]||(u[0]=m=>e.value=m),placeholder:"输入用户名"},null,512),[[q,e.value]]),R(s("input",{class:"px-4 py-3 my-2 bg-white text-slate-600 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",type:"password","onUpdate:modelValue":u[1]||(u[1]=m=>o.value=m),placeholder:"输入大于6位密码"},null,512),[[q,o.value]]),R(s("input",{class:"px-4 py-3 my-2 bg-white text-slate-600 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",type:"password","onUpdate:modelValue":u[2]||(u[2]=m=>l.value=m),placeholder:"再次输入大于6位密码"},null,512),[[q,l.value]]),s("span",Uo,M(n.value),1),s("button",{class:"py-3 px-4 my-2 bg-slate-400 text-white font-semibold rounded-md shadow-md hover:bg-slate-700",onClick:i},"注册")])]))}},Oo=()=>B.get("/books/getBooks").then(t=>t&&t.data&&t.data.success?t.data.data:Promise.reject(t&&t.data&&t.data.message)),De=t=>B.get("/books/getBookById",{params:{id:t}}).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),Ge=t=>B.post("/books/createBook",t).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),Ke=t=>B.post("/books/updateBook",t).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),zo=t=>B.post("/books/updateBookTitle",t).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),He=t=>B.post("/books/removeBook",{id:t}).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),qo=t=>B.get("/books/searchBook",{params:{key:t}}).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),Fo=()=>B.get("/groups/getPortalAndBooks").then(t=>t&&t.data&&t.data.success?t.data.data:Promise.reject(t&&t.data&&t.data.message)),Wo=t=>B.get("/groups/getAppGroupAndBooks",{params:{defaultGroup:t}}).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),Je=t=>B.post("/groups/createGroup",t).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),Xe=t=>B.post("/groups/updateGroup",t).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),No=t=>B.post("/groups/removeGroup",{id:t}).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),Do={key:1,class:"flex flex-row flex-wrap px-2 my-2"},Go={class:"mr-2"},Ko=["id","value","onUpdate:modelValue"],Ho=["for"],Ye={__name:"BookModal",props:{visible:{type:Boolean,default:!1},book:{type:Object,default:()=>({id:"",title:"",category:"",url:"",type:""})},categories:{type:Array,default:()=>[]},types:{type:Object,default:()=>We},fixedType:{type:String,default:""}},emits:["update:book","confirm","cancel"],setup(t,{emit:e}){const o=t,l=be(()=>o.categories.map(d=>({label:d.name,value:d.id}))),n=e,a=h(o.visible),r=()=>{n("confirm"),a.value=!1},i=()=>{n("cancel"),a.value=!1};return D(()=>o.visible,()=>{a.value=o.visible}),(d,u)=>(p(),N(me,{visible:a.value,"onUpdate:visible":u[3]||(u[3]=m=>a.value=m),onConfirm:r,onCancel:i},{default:U(()=>[R(s("input",{class:"p-2 my-2 bg-white text-slate-600 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",type:"text","onUpdate:modelValue":u[0]||(u[0]=m=>t.book.title=m),placeholder:"请输入书名"},null,512),[[q,t.book.title]]),v(Ne,{class:"my-2",modelValue:t.book.category,"onUpdate:modelValue":u[1]||(u[1]=m=>t.book.category=m),options:l.value},null,8,["modelValue","options"]),t.fixedType==="link"?R((p(),f("input",{key:0,class:"p-2 my-2 bg-white text-slate-600 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",type:"text","onUpdate:modelValue":u[2]||(u[2]=m=>t.book.url=m),placeholder:"请输入链接(http://www.xxxx.com)"},null,512)),[[q,t.book.url]]):t.fixedType?T("",!0):(p(),f("div",Do,[(p(!0),f(j,null,W(Object.keys(t.types),(m,b)=>(p(),f("span",{key:b,class:"pr-4 py-2 basis-1/4 lg:basis-1/3"},[s("span",Go,[R(s("input",{id:m,value:m,type:"radio","onUpdate:modelValue":c=>t.book.type=c},null,8,Ko),[[it,t.book.type]])]),s("label",{for:m},M(t.types[m]),9,Ho)]))),128))]))]),_:1},8,["visible"]))}},Qe={__name:"GroupModal",props:{visible:{type:Boolean,default:!1},title:{type:String,default:"新增分类"},group:{type:Object,default:()=>({name:"",icon:""})}},emits:["update:group","confirm","cancel"],setup(t,{emit:e}){const o=t,l=e,n=h(o.visible),a=()=>{l("confirm"),n.value=!1},r=()=>{l("cancel"),n.value=!1};return D(()=>o.visible,()=>{n.value=o.visible}),(i,d)=>(p(),N(me,{title:t.title,visible:n.value,"onUpdate:visible":d[1]||(d[1]=u=>n.value=u),onConfirm:a,onCancel:r},{default:U(()=>[R(s("input",{class:"p-2 mb-2 bg-white text-slate-600 placeholder-slate-300 shadow-sm border rounded-md text-base focus:outline-none focus:ring-2 focus:ring-purple-600 focus:border-transparent",type:"text","onUpdate:modelValue":d[0]||(d[0]=u=>t.group.name=u),placeholder:"请输入分类名"},null,512),[[q,t.group.name]])]),_:1},8,["title","visible"]))}},ne=t=>(Re("data-v-35064ad1"),t=t(),Oe(),t),Jo={key:0,class:"flex h-14 px-1 sm:px-3 xl:px-5 py-1 pt-4 bg-white/95 lg:bg-transparent"},Xo=ne(()=>s("span",null,"分类",-1)),Yo=ne(()=>s("span",null,"笔记",-1)),Qo={class:"flex-1 px-1 sm:px-3 xl:px-5 lg:text-sm pb-10 lg:pb-14 bg-white/95 lg:bg-transparent"},Zo=["onUpdate:modelValue","onKeyup"],el=["onDblclick","onMouseover","onMouseleave","onTouchstartPassive","onTouchendPassive"],tl={class:"text-base mr-2"},ol={key:0,class:"absolute right-0 top-3 font-sans text-slate-50"},ll=["onClick"],sl=ne(()=>s("span",null,"编辑",-1)),al=["onClick"],nl=ne(()=>s("span",null,"删除",-1)),rl={class:"ml-3"},il=["id"],ul=["onUpdate:modelValue","onKeyup"],cl=["onClick","onDblclick","onMouseover","onMouseleave","onTouchstartPassive","onTouchendPassive"],dl={class:"p-2 bg-slate-700 text-white text-sm rounded shadow-md"},pl={key:0,class:"absolute right-0 top-3 font-sans text-slate-50"},ml=["onClick"],fl=ne(()=>s("span",null,"编辑",-1)),vl=["onClick"],hl=ne(()=>s("span",null,"删除",-1)),gl={__name:"Menu",props:{fold:{type:Boolean,default:!0},editable:{type:Boolean,default:!0},fixedType:{type:String,default:""},defaultGroup:{type:Boolean,default:!1},defaultSelected:{type:Boolean,default:!0}},emits:["toggleFold","menuChange"],setup(t,{emit:e}){H();const o=ce(),l=h([]),n=h(o.query.appId),a=h(""),r=h(""),i=h(""),d=h(void 0),u=h(void 0),m=h(!1);let b=null;const{proxy:c}=ye(),_=t,x=h(!0),w=e,$=()=>{x.value=!0,w("toggleFold",!0)},I=g=>{let{id:y}=g||{};a.value=y||"",i.value="",$(),w("menuChange",y,o.query.appId)},G=()=>{d.value={name:"新增分类"},m.value=!0},Z=g=>{g!=="default"&&(i.value=g,c.$nextTick(()=>{let y=c.$refs.titleInput;console.log(y),y&&y[0]&&y[0].focus()}))},X=g=>{d.value=g,m.value=!1},fe=()=>{d.value&&m.value?Je(d.value).then(g=>{let{_id:y,name:z}=g;y&&(l.value.push({id:y,name:z,books:[]}),i.value="",d.value=void 0,m.value=!1)}):d.value&&ve(d.value)},ve=g=>{Xe(g).then(()=>{i.value="",d.value=void 0,m.value=!1})},ke=(g,y)=>{if(g.books&&g.books.length>0){A.warning("该分类下有书籍，不能删除!");return}No(g.id).then(()=>{A.success("删除分类成功!"),l.value.splice(y,1)})},C=()=>{m.value=!0,u.value={title:"新增笔记",type:_.fixedType||"markdown"}},P=()=>{u&&m.value?Ge(u.value).then(g=>{let y=l.value.find(({id:z})=>z===g.category);!y&&(y=l.value.find(({id:z})=>z==="default"),!y)||(y.books=y.books||[],g.id=g._id,y.books.splice(0,0,g),I(g),u.value=void 0)}):u&&u.value&&he(u.value)},O=()=>{i.value="",u.value=void 0,d.value=void 0,m.value=!1},re=(g,y)=>{He(a.value).then(()=>{g.splice(y,1);let z=g&&g.length>y?y:g.length-1;I(z<0?null:g[z]),A.success("删除书籍成功!")})},Y=g=>{i.value=g,c.$nextTick(()=>{let y=c.$refs.titleInput;y&&y[0]&&y[0].focus()})},$e=g=>{i.value=g.category,u.value=g,m.value=!1},he=g=>{zo({...g,category:g.category==="default"?"":g.category}).then(y=>{i.value,g.category,i.value="",u.value=null})};Q(()=>{Wo(_.defaultGroup).then(g=>{l.value=g||[],_.defaultSelected&&!o.params.id&&l.value[0]&&l.value[0].books&&l.value[0].books[0]&&I(l.value[0].books[0]),o.params.id&&c.$nextTick(()=>{Se(o.params.id||l.value[0].books[0].id)})})});const Se=g=>{let y=document.getElementById("sideBar");if(y&&g){let z=document.getElementById(`book-${g}`);z&&y.scrollTo({top:z.offsetTop,behavior:"smooth"})}},Me=g=>{r.value=g},Pe=g=>{r.value=""},Te=(g,y)=>{b={x:g.touches[0].clientX,target:y}},Ee=(g,y)=>{if(!b)return;let{x:z,target:E}=b;if(E!==y){b=null;return}let ge=g.changedTouches[0].clientX;z>ge?r.value=y:z<ge&&(r.value=""),b=null};return D(()=>o.params.id,(g,y)=>{g!==y&&(a.value=g,i.value="",$(),c.$nextTick(()=>{Se(g)}))},{immediate:!0}),D(()=>o.query.appId,g=>{n.value=g,console.log(g)},{immediate:!0}),D(()=>_.fold,(g,y)=>{x.value=g},{immediate:!0}),(g,y)=>{const z=de("tippy");return p(),f("div",{id:"sideBar",class:L(["flex flex-col fixed top-16 bottom-0 backdrop-blur overflow-y-auto z-20 bg-black/20 lg:bg-transparent w-full lg:w-80 pr-24 lg:pr-0 transition-transform duration-300 ease-out delay-100 lg:translate-x-0",x.value?"translate-x-[-100%]":"translate-x-0"]),onClick:V($,["stop"])},[t.editable?(p(),f("div",Jo,[s("button",{class:"font-sans-serif text-base text-blue-300 hover:text-blue-700 border border-blue-300 hover:border-blue-700 rounded px-2 mx-2",onClick:V(G,["stop"])},[v(k,{name:"add-line"}),Xo]),s("button",{class:"font-sans-serif text-base text-blue-300 hover:text-blue-700 border border-blue-300 hover:border-blue-700 rounded px-2 mx-2",onClick:V(C,["stop"])},[v(k,{name:"add-line"}),Yo])])):T("",!0),s("nav",Qo,[s("ul",null,[(p(!0),f(j,null,W(l.value,(E,ge)=>(p(),f("li",{key:E.id},[E.id===i.value?R((p(),f("input",{key:0,ref_for:!0,ref:"titleInput",class:"p-2 w-full rounded-md",type:"text","onUpdate:modelValue":S=>E.name=S,onKeyup:oe(S=>ve(E),["enter"])},null,40,Zo)),[[q,E.name]]):(p(),f("div",{key:1,class:"px-3 py-2 relative font-medium text-gray-900 cursor-pointer",onDblclick:V(S=>Z(E.id),["stop"]),onMouseover:S=>Me(E.id),onMouseleave:S=>Pe(E.id),onTouchstartPassive:S=>Te(S,E.id),onTouchendPassive:S=>Ee(S,E.id)},[s("span",tl,M(E.name),1),v(Ce,{name:"slide"},{default:U(()=>[r.value===E.id?(p(),f("div",ol,[t.editable&&!E.readonly?(p(),f("span",{key:0,class:"cursor-pointer bg-blue-300 hover:bg-blue-700 p-2",onClick:V(S=>X(E),["stop"])},[v(k,{name:"edit-line"}),sl],8,ll)):T("",!0),t.editable&&!E.readonly&&(!E.books||E.books.length<=0)?(p(),f("span",{key:1,class:"cursor-pointer bg-red-300 hover:bg-red-700 p-2",onClick:V(S=>ke(E,ge),["stop"])},[v(k,{name:"delete-bin-line"}),nl],8,al)):T("",!0)])):T("",!0)]),_:2},1024)],40,el)),s("ul",rl,[(p(!0),f(j,null,W(E.books,(S,lt)=>(p(),f("li",{id:`book-${S.id}`,key:S.id},[S.id===i.value?R((p(),f("input",{key:0,ref_for:!0,ref:"titleInput",class:"p-2 w-full rounded-md",type:"text","onUpdate:modelValue":K=>S.title=K,onKeyup:oe(K=>he(S),["enter"])},null,40,ul)),[[q,S.title]]):(p(),f("a",{key:1,onClick:V(K=>I(S),["stop"]),onDblclick:V(K=>Y(S.id),["stop"]),onMouseover:K=>Me(S.id),onMouseleave:K=>Pe(S.id),onTouchstartPassive:K=>Te(K,S.id),onTouchendPassive:K=>Ee(K,S.id),class:"px-3 py-2 transition-colors duration-200 relative block text-grey-700 hover:text-gray-900 cursor-pointer"},[v(z,{placement:"top-start",trigger:"hover"},{content:U(()=>[s("span",dl,M(S.title),1)]),default:U(()=>[s("span",{class:L(["relative inline-block text-base text-ellipsis whitespace-nowrap overflow-hidden",S.id===a.value?"text-blue-500 font-bold":""])},M(S.title),3)]),_:2},1024),v(Ce,{name:"slide"},{default:U(()=>[t.editable&&S.id===r.value?(p(),f("div",pl,[s("span",{class:"cursor-pointer bg-blue-300 hover:bg-blue-700 p-2",onClick:V(K=>$e(S),["stop"])},[v(k,{name:"edit-line"}),fl],8,ml),s("span",{class:"cursor-pointer bg-red-300 hover:bg-red-700 p-2",onClick:V(K=>re(E.books,lt),["stop"])},[v(k,{name:"delete-bin-line"}),hl],8,vl)])):T("",!0)]),_:2},1024)],40,cl))],8,il))),128))])]))),128))])]),v(Ye,{fixedType:t.fixedType,title:`${m.value?"新增":"编辑"}书籍`,visible:!!u.value,onConfirm:P,onCancel:O,book:u.value,categories:l.value},null,8,["fixedType","title","visible","book","categories"]),v(Qe,{title:`${m.value?"新增分类":"编辑分类"}`,visible:!!d.value,group:d.value,onConfirm:fe,onCancel:O},null,8,["title","visible","group"])],2)}}},Ze=ae(gl,[["__scopeId","data-v-35064ad1"]]),bl={key:0,class:"fixed top-0 left-0 inset-0 center z-50 backdrop-blur bg-white/50"},xl={class:"flex flex-col w-full lg:w-1/2 mx-auto lg:mt-[10%] max-h-full lg:max-h-[60%] shadow-lg rounded-lg bg-white"},_l={class:"flex px-6 py-4 border-b border-slate-100"},yl={class:"flex flex-1 items-center"},wl={class:"flex flex-1 flex-col p-6 overflow-auto"},kl={key:0,class:"text-center p-6"},$l=s("p",{class:"text-slate-300 text-base"},"没有搜索结果",-1),Cl=[$l],Il={key:1,class:"text-normal font-normal text-slate-600"},Vl=["onClick"],Bl={class:"flex-1"},Sl={key:0,class:"ml-4"},Ml=["onClick"],Pl={class:"flex-1"},Tl={class:"flex h-10 py-2 px-6 border-t border-slate-100 leading-6"},El=s("span",{class:"mr-8"},"选择",-1),jl=s("span",null,"上下移动",-1),Al={__name:"SearchModal",props:{visible:{type:Boolean,default:!1},container:{type:[String,Object],default:"body"}},emits:["update:visible"],setup(t,{emit:e}){const o=H();ce();const l=t;let n=null;const a=h(""),r=h([]),i=h(),d=e,u=()=>{d("update:visible",!1)},m=()=>{a.value&&qo(a.value).then(w=>{w&&w.length>=0&&(r.value=w,i.value={bookIdx:0,anchorIdx:-1})})},b=w=>{o.push({path:`/books/${w.id}`,query:{appId:w.appId}}),u()},c=(w,$)=>{o.push({path:`/books/${w.id}`,query:{appId:w.appId,anchorId:$.id}}),u()},_=w=>{if(w.key==="Escape")u(),w.preventDefault();else if(w.key==="ArrowUp"){if(i.value){if(i.value.anchorIdx>-1)i.value.anchorIdx--;else if(i.value.bookIdx>0){i.value.bookIdx--;let $=r.value[i.value.bookIdx];$&&$.anchors&&$.anchors.length>0&&(i.value.anchorIdx=$.anchors.length-1)}}}else if(w.key==="ArrowDown"){if(i.value){let $=r.value[i.value.bookIdx];i.value.anchorIdx<$.anchors.length-1?i.value.anchorIdx++:i.value.bookIdx<r.value.length-1&&(i.value.bookIdx++,i.value.anchorIdx=-1)}}else if(w.key==="Enter"&&i.value){let $=r.value[i.value.bookIdx];i.value.anchorIdx>-1?c($,$.anchors[i.value.anchorIdx]):b($)}};le(()=>{document.addEventListener("keydown",_)}),Q(()=>{typeof l.container=="string"?n=document.querySelector(l.container):n=l.container,n?n.appendChild(x.$el):console.error("Invalid container specified for CustomPopup."),x.$nextTick(()=>{x.$refs.searchInput.focus()})}),pe(()=>{document.removeEventListener("keydown",_),n&&n.contains(x.$el)&&(n.removeChild(x.$el),n=null)});const{proxy:x}=ye();return D(()=>l.visible,(w,$)=>{w&&w!==$&&x.$nextTick(()=>{x.$refs.searchInput.focus()})},{immediate:!0}),(w,$)=>t.visible?(p(),f("div",bl,[s("div",xl,[s("div",_l,[s("div",yl,[v(k,{name:"search-line",class:"leading-6"}),R(s("input",{placeholder:"输入关键字",class:"flex flex-1 px-2 text-slate-600 placeholder-slate-300 text-base focus:outline-none focus:border-transparent","onUpdate:modelValue":$[0]||($[0]=I=>a.value=I),onKeyup:oe(m,["enter"]),ref:"searchInput"},null,544),[[q,a.value]])]),s("button",{class:"rounded px-2 bg-slate-100 hover:bg-blue-300 hover:text-slate-100",onClick:V(u,["stop"])},[v(k,{name:"close-line",class:"leading-6"})])]),s("div",wl,[!r.value||r.value.length<1?(p(),f("div",kl,Cl)):(p(),f("ul",Il,[(p(!0),f(j,null,W(r.value,(I,G)=>(p(),f("li",{key:G},[s("a",{onClick:Z=>b(I),class:L(["flex m-2 p-2 lg:p-4 hover:bg-blue-400 rounded-lg hover:text-slate-100 shadow-sm",{"bg-slate-100":i.value.bookIdx!==G||i.value.anchorIdx!==-1,"bg-blue-500":i.value.bookIdx===G&&i.value.anchorIdx===-1,"text-slate-100":i.value.bookIdx===G&&i.value.anchorIdx===-1}])},[s("div",Bl,[v(k,{name:"book-open-line",class:"font-semibold mr-4 p-1 border-2 rounded hover:border-slate-100"}),s("span",null,M(I.title),1)]),v(k,{name:"arrow-right-s-line"})],10,Vl),I.anchors&&I.anchors.length>0?(p(),f("ul",Sl,[(p(!0),f(j,null,W(I.anchors,(Z,X)=>(p(),f("li",{key:X,class:"pl-4 border-l-2 border-slate-100"},[s("a",{onClick:fe=>c(I,Z),class:L(["flex m-2 p-2 lg:p-4 hover:bg-blue-400 rounded-lg hover:text-slate-100 shadow-sm",{"bg-slate-100":i.value.bookIdx!==G||i.value.anchorIdx!==X,"bg-blue-500":i.value.bookIdx===G&&i.value.anchorIdx===X,"text-slate-100":i.value.bookIdx===G&&i.value.anchorIdx===X}])},[s("div",Pl,[v(k,{name:"hashtag",class:"font-semibold mr-4 p-1 border-2 rounded hover:border-slate-100"}),s("span",null,M(Z.textContent),1)]),v(k,{name:"arrow-right-s-line"})],10,Ml)]))),128))])):T("",!0)]))),128))]))]),s("div",Tl,[v(k,{name:"corner-down-left-line",class:"px-2 mr-2 rounded shadow-sm shadow-slate-700"}),El,v(k,{name:"arrow-down-line",class:"px-2 mr-2 rounded shadow-sm shadow-slate-700"}),v(k,{name:"arrow-up-line",class:"px-2 mr-2 rounded shadow-sm shadow-slate-700"}),jl])])])):T("",!0)}},Ll=["onKeydown"],Ul=s("span",{class:"px-3 text-normal"},"快速搜索一切",-1),Rl=s("span",{class:"px-1 text-normal bg-slate-200 rounded"},"⌘K",-1),Ol=s("span",null,"这是一个测试",-1),zl=se({__name:"Search",setup(t){const e=h(!1),o=()=>{e.value=!0},l=n=>{n.key==="k"&&n.metaKey&&(e.value=!0,n.preventDefault())};return le(()=>{document.addEventListener("keydown",l)}),pe(()=>{document.removeEventListener("keydown",l)}),(n,a)=>(p(),f(j,null,[s("button",{class:"text-slate-400 px-4 py-3 my-2",onClick:o,onKeydown:oe(V(l,["meta"]),["key"])},[v(k,{name:"search-line"}),Ul,Rl],40,Ll),e.value?(p(),N(Al,{key:0,visible:e.value,"onUpdate:visible":a[0]||(a[0]=r=>e.value=r)},{default:U(()=>[Ol]),_:1},8,["visible"])):T("",!0)],64))}}),ql={id:"content",class:"w-full max-w-screen-2xl mx-auto"},Fl={class:"lg:flex"},Wl={id:"contentWrapper",class:"min-w-0 w-full flex-auto lg:static lg:max-h-full lg:overflow-visible lg:pl-80"},Nl=se({__name:"Books",setup(t){const e=H(),o=h(!0),l=a=>{if(a!==void 0){o.value=a;return}o.value=!o.value},n=(a,r)=>{let i=a?`/books/${a}`:"/books";e.push({path:i,query:{appId:r}})};return(a,r)=>{const i=de("router-view");return p(),f(j,null,[v(J,{onToggleFold:l,fold:o.value},{default:U(()=>[v(zl)]),_:1},8,["fold"]),s("div",ql,[s("div",Fl,[v(Ze,{editable:!0,onToggleFold:l,fold:o.value,onMenuChange:n},null,8,["fold"]),s("div",Wl,[v(i)])])])],64)}}}),Dl="modulepreload",Gl=function(t,e){return new URL(t,e).href},Ae={},te=function(e,o,l){let n=Promise.resolve();if(o&&o.length>0){const a=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),i=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));n=Promise.all(o.map(d=>{if(d=Gl(d,l),d in Ae)return;Ae[d]=!0;const u=d.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(!!l)for(let _=a.length-1;_>=0;_--){const x=a[_];if(x.href===d&&(!u||x.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${m}`))return;const c=document.createElement("link");if(c.rel=u?"stylesheet":Dl,u||(c.as="script",c.crossOrigin=""),c.href=d,i&&c.setAttribute("nonce",i),document.head.appendChild(c),u)return new Promise((_,x)=>{c.addEventListener("load",_),c.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}return n.then(()=>e()).catch(a=>{const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=a,window.dispatchEvent(r),!r.defaultPrevented)throw a})},Kl={class:"w-full h-full flex"},Hl=se({__name:"Book",setup(t){const e=ce(),o=ze(),l=h(""),n=h(Array());let a="";const r=h("");let i;const d=()=>{if(l.value===a)return;let m=[];n.value.length>0&&(m=n.value.map(c=>({id:c.id,itemIndex:c.itemIndex,level:c.level,originalLevel:c.originalLevel,pos:c.pos,textContent:c.textContent})));let b={id:r.value,content:l.value,anchors:m};Ke(b).then(()=>{a=l.value})},u=m=>{switch(m){case"markdown":{o.value=ee(()=>te(()=>import("./Markdown-SpexRMaa.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url));break}case"chat":case"text":{o.value=ee(()=>te(()=>import("./Text-CFHmariN.js"),__vite__mapDeps([6,1,2,3,4]),import.meta.url));break}case"code":{o.value=ee(()=>te(()=>import("./Code-Dpt7sAWG.js"),__vite__mapDeps([7,2,3,4,8]),import.meta.url));break}case"task":{o.value=ee(()=>te(()=>import("./Task-COfSzYy4.js"),__vite__mapDeps([9,1,2,3,4,10]),import.meta.url));break}case"drawing":{o.value=ee(()=>te(()=>import("./Drawing-DOZzcUc5.js"),__vite__mapDeps([11,1,2,3,4,12]),import.meta.url));break}default:{o.value=ee(()=>te(()=>import("./Markdown-SpexRMaa.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url));break}}};return D(()=>e.params.id,(m,b)=>{m&&m!==b&&(typeof m=="string"&&(r.value=m||""),De(r.value).then(c=>{l.value=c.content||"",n.value=c.anchors||[],a=c.content||"",u(c.type)}))},{immediate:!0}),le(()=>{i=setInterval(()=>{d()},5e3)}),pe(()=>{clearInterval(i)}),(m,b)=>(p(),f("div",Kl,[(p(),N(ut(o.value),{modelValue:l.value,"onUpdate:modelValue":b[0]||(b[0]=c=>l.value=c),anchors:n.value,"onUpdate:anchors":b[1]||(b[1]=c=>n.value=c)},null,40,["modelValue","anchors"]))]))}}),Jl={class:"flex flex-col w-full h-screen"},Xl={class:"flex-1 p-4 lg:p-8 overflow-y-auto"},Yl={class:"lg:w-1/2 mx-auto"},Ql={class:"inline-block w-1/2 px-4 lg:text-right"},Zl={class:"text-normal text-slate-500"},es=s("span",{class:"hidden border-blue-500 border-teal-500 border-red-500 border-orange-500 border-amber-500 border-yellow-500 border-purple-500 border-green-500 border-pink-500 border-rose-500"},null,-1),ts=s("div",{class:"absolute start-1/2 w-4 top-6 h-20"},[s("div",{class:"w-0.5 mx-auto bg-slate-300 h-full"})],-1),os={class:"inline-block w-1/2 pl-8"},ls=["onClick"],ss={__name:"Schedule",setup(t){const e=H(),o=h([]),l=a=>{e.push({path:`/books/${a._id}`,query:{appId:a.appId}})},n=["blue","teal","red","orange","amber","yellow","purple","green","pink","rose"];return Q(()=>{Oo().then(a=>{o.value=a||[]})}),(a,r)=>(p(),f("div",Jl,[v(J,{hiddenFold:!1}),s("div",Xl,[s("ul",Yl,[(p(!0),f(j,null,W(o.value,(i,d)=>(p(),f("li",{key:d,class:"relative flex h-28"},[s("div",Ql,[s("span",Zl,M(i.createTime),1)]),s("div",{class:L(`absolute w-4 h-4 start-1/2 top-1 bg-slate-50 border-4 rounded-lg  border-${n[Math.floor(Math.random()*10)]}-500`)},null,2),es,ts,s("div",os,[s("a",{class:"text-normal font-bold text-slate-700",onClick:V(u=>l(i),["stop"])},M(i.title),9,ls)])]))),128))])])]))}},as=t=>(Re("data-v-7dcd3095"),t=t(),Oe(),t),ns={class:"absolute w-full h-full top-0 left-0 flex justify-center items-center bg-slate-50 opacity-60 z-[100]"},rs=as(()=>s("div",{class:"loading"},[s("span"),s("span"),s("span"),s("span"),s("span")],-1)),is=[rs],us={__name:"Loading",setup(t){return(e,o)=>(p(),f("div",ns,is))}},et=ae(us,[["__scopeId","data-v-7dcd3095"]]),cs={id:"chatContent",class:"flex-1 text-base p-2 lg:p-4 text-slate-900 font-normal overflow-y-auto"},ds={key:0,class:"flex flex-col content-space-between"},ps={key:1,class:"inline-block my-3 self-start lg:mr-8"},ms={class:"px-4 py-2 text-slate-700 bg-blue-50 rounded-xl shadow-md"},fs={key:0,class:"relative h-24 lg:h-28 w-full text-lg px-2 lg:px-4 mb-4 lg:mb-8"},vs=["onKeyup"],hs=s("span",{class:"mr-1"},"发送",-1),tt={__name:"ChatPanel",props:{editable:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},messages:{type:Array,default:()=>[]},placeholder:{type:String,default:"开始向我提问吧..."},owner:{type:String,default:"user"},roleProperty:{type:String,default:"role"}},emits:["chart"],setup(t,{emit:e}){const{proxy:o}=ye(),l=t,n=e,a=h(""),r=()=>{a.value=a.value.replace(/[\r\n]/g,""),n("chart",a.value),a.value=""};return D(()=>l.messages,(i,d)=>{i&&i.length!==d.length&&(a.value="",o.$nextTick(()=>{const u=document.getElementById("chatContent");u&&u.scrollTo({top:u.scrollHeight,behavior:"smooth"})}))}),(i,d)=>(p(),f(j,null,[s("div",cs,[t.messages&&t.messages.length>0?(p(),f("div",ds,[(p(!0),f(j,null,W(t.messages,(u,m)=>(p(),f("div",{key:m,class:L(`my-3 text-slate-700 ${u[t.roleProperty]!==t.owner?"self-start lg:mr-8":"self-end lg: ml-8"}`)},[u[t.roleProperty]!==t.owner?(p(),N(ue,{key:0,icon:"robot-2-fill"})):T("",!0),s("span",{class:L(["inline-block px-4 py-2 rounded-xl shadow-md",u[t.roleProperty]!==t.owner?"":"bg-blue-50"])},M(u.content),3),u[t.roleProperty]===t.owner?(p(),N(ue,{key:1})):T("",!0)],2))),128))])):(p(),f("div",ps,[v(ue,{icon:"robot-2-fill"}),s("span",ms,M(t.placeholder),1)]))]),t.editable?(p(),f("div",fs,[R(s("textarea",{ref:"questionInput",rows:3,class:"w-full border rounded-lg shadow-sm py-2 lg:py-4 pl-4 pr-20 text-slate-600 placeholder-slate-300 font-normal text-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent","onUpdate:modelValue":d[0]||(d[0]=u=>a.value=u),type:"text",placeholder:"开始对话",onKeyup:oe(V(r,["stop"]),["enter"])},null,40,vs),[[q,a.value]]),s("button",{class:"absolute top-2 lg:top-4 right-4 lg:right-8 w-16 text-blue-300 hover:text-blue-600",onClick:V(r,["stop"])},[hs,v(k,{name:"send-plane-fill"})])])):T("",!0),t.loading?(p(),N(et,{key:1})):T("",!0)],64))}},gs=[{value:"tongyi",label:"通义千问"},{value:"qianfan",label:"文心一言"},{value:"moonshot",label:"月之暗面"}],bs=t=>B.post("/ai/getYouDaoAiTranslate",t).then(e=>e.data&&e.data.success?e.data.data&&e.data.data:Promise.reject(e.data&&e.data.message)),xs=(t,e,o)=>B.post("/ai/getAiChat",{id:t,mode:e,question:o}).then(l=>l.data&&l.data.success?l.data.data:Promise.reject(l.data&&l.data.message)),_s={class:"flex flex-col w-full h-screen"},ys={class:"flex-1 flex flex-col w-full lg:pl-80 overflow-y-auto"},ws={__name:"Robot",setup(t){const e=H(),o=ce(),l=h([]),n=h(!1),a=h("tongyi"),r=h(""),i=h(!0),d=c=>{if(c!==void 0){i.value=c;return}i.value=!i.value},u=(c,_)=>{e.push({path:"/robot",query:{id:c,appId:_}}),r.value=c||"",c?De(c).then(x=>{l.value=JSON.parse(x.content||"[]")}):l.value=[]},m=c=>{n.value=!0,xs(r.value,a.value,c).then(_=>{let{id:x,response:w}=_;r.value=x,n.value=!1,l.value=l.value.concat([{role:"user",content:c},{role:"assistant",content:w}])}).catch(_=>{n.value=!1,l.value=l.value.concat([{role:"assistant",content:_.message}])})},b=(c,_)=>{a.value=c,l.value&&l.value.length>0&&(e.push({path:"/robot",query:{id:"new",appId:o.query.appId}}),l.value=[],r.value="")};return D(o.query.id,(c,_)=>{r.value=c},{immediate:!0}),(c,_)=>(p(),f("div",_s,[v(J,{onToggleFold:d,fold:i.value},{default:U(()=>[v(Ne,{class:"w-48",modelValue:a.value,"onUpdate:modelValue":[_[0]||(_[0]=x=>a.value=x),b],palaceHolder:"请选择模型",options:ie(gs)},null,8,["modelValue","options"])]),_:1},8,["fold"]),v(Ze,{fixedType:"chat",defaultGroup:!0,fold:i.value,defaultSelected:!1,onToggleFold:d,onMenuChange:u},null,8,["fold"]),s("div",ys,[v(tt,{editable:!0,messages:l.value,loading:n.value,onChart:m},null,8,["messages","loading"])])]))}},ks={class:"flex flex-col h-screen w-full justify-center items-center text-slate-700"},$s={class:"flex-1 w-full p-2 lg:p-4 overflow-y-auto"},Cs={key:0,class:"rounded-lg shadow-lg p-4 lg:p-8 mb-4 lg:mb-8"},Is=s("div",{class:"font-bold text-normal lg:text-lg py-2"},[s("span",{class:"bg-blue-600 text-slate-50 rounded-xl px-2 py-1"},"每日一句")],-1),Vs={class:"text-normal lg:text-lg p-2"},Bs={class:"text-normal lg:text-lg p-2"},Ss={key:1,class:"rounded shadow-lg p-4 lg:p-8 mb-4 lg:mb-8"},Ms={class:"font-bold text-lg lg:text-xl text-blue-700 py-1"},Ps={class:"text-lg text-slate-300"},Ts={key:2,class:"rounded shadow-lg p-4 lg:p-8 mb-4 lg:mb-8"},Es={class:"font-bold text-lg lg:text-xl text-blue-700"},js={class:"text-lg text-slate-300"},As=["src"],Ls={class:"relative h-24 lg:h-28 w-full text-lg px-2 lg:px-4 mb-4 lg:mb-8"},Us=["onKeyup"],Rs=s("span",{class:"mr-1"},"发送",-1),Os={__name:"Translation",setup(t){const e=b=>{var c=document.createElement("textarea");c.value=b,document.body.appendChild(c),c.focus(),c.select();try{var _=document.execCommand("copy"),x=_?"成功拷贝!":"拷贝失败!";console.log(x)}catch(w){console.error("拷贝到剪贴板失败:",w)}document.body.removeChild(c)},o=h("");h("");const l=h(""),n=h(""),a=h(!1);h("");const r=h(),i=()=>{n.value&&(navigator.clipboard||(navigator.clipboard={writeText:e}),navigator.clipboard.writeText(n.value),A.success("复制成功！"))},d=()=>{bo({code:n.value,english:n.value,chinese:o.value,newWord:!0}).catch(b=>{A.error(b)})},u=()=>{o.value||A.warning("请输入要翻译的文本！"),o.value=o.value.replace(/[\r\n]/g,"");const c=new RegExp(/^[A-Za-z\s]*$/).test(o.value);a.value=!0,bs({query:o.value,from:c?"en":"zh-CHS",to:c?"zh-CHS":"en"}).then(_=>{let{translation:x,speakUrl:w,tSpeakUrl:$,dict:I,tDict:G}=_||{};n.value=x,l.value=$,a.value=!1})},m=b=>{let c=null;c=document.getElementById("responseAudioPlayer"),c.paused?c.play():c.pause()};return Q(()=>{ho().then(b=>{r.value=b})}),(b,c)=>(p(),f(j,null,[s("div",ks,[v(J),s("div",$s,[r.value?(p(),f("div",Cs,[Is,s("div",Vs,M(r.value.chinese||""),1),s("div",Bs,M(r.value.english||""),1)])):T("",!0),o.value?(p(),f("div",Ss,[s("div",Ms,M(o.value),1),s("span",Ps,[v(k,{class:"hover:text-blue-400",name:"clipboard-line",onClick:c[0]||(c[0]=V(_=>i(o.value),["stop"]))})])])):T("",!0),n.value?(p(),f("div",Ts,[s("div",Es,M(n.value),1),s("span",js,[v(k,{class:"mr-2 hover:text-blue-400",name:"volume-up-line",onClick:c[1]||(c[1]=_=>m())}),v(k,{class:"mr-2 hover:text-blue-400",name:"clipboard-line",onClick:c[2]||(c[2]=V(_=>i(),["stop"]))}),v(k,{class:"hover:text-blue-400",name:"add-line",onClick:c[3]||(c[3]=V(_=>d(),["stop"]))})]),s("audio",{id:"responseAudioPlayer",src:l.value},null,8,As)])):T("",!0)]),s("div",Ls,[R(s("textarea",{ref:"questionInput",rows:3,class:"w-full border rounded-lg shadow-sm py-2 lg:py-4 pl-4 pr-20 text-slate-600 placeholder-slate-300 font-normal text-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent","onUpdate:modelValue":c[4]||(c[4]=_=>o.value=_),type:"text",placeholder:"开始对话",onKeyup:oe(V(u,["stop"]),["enter"])},null,40,Us),[[q,o.value]]),s("button",{class:"absolute top-2 lg:top-4 right-4 lg:right-8 w-16 text-blue-300 hover:text-blue-600",onClick:u},[Rs,v(k,{name:"send-plane-fill"})])])]),a.value?(p(),N(et,{key:0})):T("",!0)],64))}},zs={class:"flex flex-col h-screen w-full"},qs={key:0},Fs=s("span",null,"新增",-1),Ws=s("span",null,"导入",-1),Ns=s("span",null,"导出",-1),Ds={class:"flex-1 p-2 lg:p-4 overflow-y-auto"},Gs=["onMouseover"],Ks={class:"mr-2"},Hs={class:"flex flex-row flex-wrap"},Js={key:0,class:"m-2 lg:m-4"},Xs=s("p",{class:"align-center"},"你真的要删除这个书签？",-1),Ys=se({__name:"Portals",setup(t){const e=h(Array()),o=h(!1),l=h(),n=h(),a=h(),r=h(!1),i=h(),d=h(""),u=C=>{r.value=!0,l.value={title:"新增书签",type:"link",url:"",category:C.id}},m=C=>{r.value=!1,l.value=C,n.value=C.category},b=C=>{i.value=C.id},c=()=>{i.value=null},_=()=>{He(i.value).then(C=>{e.value=e.value.map(P=>(P.id===C.category&&(P.books=P.books&&P.books.filter(O=>O.id!==C.id)),P)),i.value=null})},x=()=>{r.value=!0,a.value={name:""}},w=C=>{r.value=!1,a.value=C},$=()=>{A.warning("还未开发，敬请期待")},I=()=>{A.warning("还未开发，敬请期待")},G=()=>{r.value?Je(a.value).then(C=>{e.value&&e.value.length>0&&e.value.push(C),a.value=void 0,r.value=!1}):Xe(a.value).then(C=>{e.value=e.value.map(P=>P.id===C.id?C:P),a.value=void 0})},Z=()=>{r.value?Ge(l.value).then(C=>{let P=e.value.find(({id:O})=>O===C.category);P&&(P.books=P.books||[],C.id=C._id,P.books.splice(0,0,C),l.value=null,r.value=!1)}):l&&l.value&&Ke(l.value).then(C=>{C.category!==n.value&&(e.value=e.value.map(P=>{var O;return P.id===n.value&&(P.books=P.books&&P.books.filter(re=>re.id!==C.id)),P.id===C.category&&((O=P.books)==null||O.splice(0,0,C)),P}))})},X=()=>{a.value=void 0,r.value=!1},fe=()=>{l.value=void 0,n.value=void 0,r.value=!1},ve=C=>{d.value=C},ke=()=>{d.value=""};return Q(()=>{Fo().then(C=>{o.value=C.editable,e.value=C.portals})}),(C,P)=>(p(),f(j,null,[s("div",zs,[v(J,{hiddenFold:!0},{default:U(()=>[o.value?(p(),f("div",qs,[s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium rounded-md text-slate-50 bg-blue-400 hover:bg-blue-700",onClick:x},[Fs,v(k,{name:"add-line"})]),s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium border rounded-md text-blue-400 border-blue-400 hover:text-blue-700 hover:border-blue-700",onClick:$},[Ws,v(k,{name:"add-line"})]),s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium border rounded-md text-blue-400 border-blue-400 hover:text-blue-700 hover:border-blue-700",onClick:I},[Ns,v(k,{name:"add-line"})])])):T("",!0)]),_:1}),s("div",Ds,[(p(!0),f(j,null,W(e.value,(O,re)=>(p(),f("ul",{key:re},[s("p",{class:"m-2 lg:m-4 text-basic lg:text-lg text-blue-900 font-medium",onMouseover:Y=>ve(O.id),onMouseleave:P[0]||(P[0]=Y=>ke())},[s("span",Ks,M(O.name),1),o.value&&d.value===O.id?(p(),N(k,{key:0,class:"shadow-sm rounded-sm text-blue-300 hover:text-blue-700",name:"edit-line",onClick:V(Y=>w(O),["stop"])},null,8,["onClick"])):T("",!0)],40,Gs),s("div",Hs,[(p(!0),f(j,null,W(O.books,(Y,$e)=>(p(),f("li",{class:"m-2 lg:m-4",key:$e},[v(_e,{theme:"blue",editable:o.value,modelValue:Y,onEdit:he=>m(Y),onRemove:he=>b(Y)},null,8,["editable","modelValue","onEdit","onRemove"])]))),128)),o.value?(p(),f("li",Js,[v(_e,{theme:"blue",modelValue:{title:"新增书签",icon:"add-line"},onCardClick:()=>u(O)},null,8,["onCardClick"])])):T("",!0)])]))),128))])]),v(Qe,{title:`${r.value?"新增分类":"编辑分类"}`,visible:!!a.value,group:a.value,onConfirm:G,onCancel:X},null,8,["title","visible","group"]),v(Ye,{fixedType:"link",title:`${r.value?"新增书签":"编辑书签"}`,visible:!!l.value,book:l.value,onConfirm:Z,categories:e.value,onCancel:fe},null,8,["title","visible","book","categories"]),v(me,{visible:!!i.value,closable:!1,title:"确认删除",onConfirm:_,onCancel:c},{default:U(()=>[Xs]),_:1},8,["visible"])],64))}}),Qs={class:"w-full h-screen flex flex-col relative pb-44"},Zs={class:"absolute left-0 bottom-0 w-full flex flex-col p-2 bg-slate-50"},ea={class:"h-32 px-2 overflow-y-auto"},ta=se({__name:"Coding",props:{modelValue:String},emits:["update:modelValue"],setup(t,{emit:e}){const o=[ct()],l=t,n=e,a=h(l.modelValue),r=h([{classes:"font-bold",content:"输出结果:"}]),i=ze(),d=x=>{i.value=x.view},u=x=>{n("update:modelValue",x)},m=()=>{console.log("focus")},b=()=>{console.log("change")},c=()=>{const x={log:(...I)=>{r.value.push({classes:"text-green-500",content:I.join(" ")})},error:(...I)=>{r.value.push({classes:"text-red-500",content:I.join(" ")})},warning:(...I)=>{r.value.push({classes:"text-yellow-500",content:I.join(" ")})},info:(...I)=>{r.value.push({classes:"text-blue-500",content:I.join(" ")})}};let w;try{w=new Function("console",a.value||"")}catch(I){typeof I=="string"?r.value.push({classes:"text-red-500",content:I}):I instanceof Error&&r.value.push({classes:"text-red-500",content:I.message})}let $=w(x);r.value.push({classes:"text-green-500",content:$})},_=()=>{r.value=[{classes:"font-bold",content:"输出结果:"}]};return D(()=>l.modelValue,x=>{a.value=x}),(x,w)=>(p(),f("div",Qs,[v(J),v(ie(dt),{class:"w-full flex-1 pro-code",modelValue:a.value,"onUpdate:modelValue":w[0]||(w[0]=$=>a.value=$),pleholder:"输入代码...",autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:o,onReady:d,onChange:u,onFocus:m,onBlur:b},null,8,["modelValue"]),s("div",Zs,[s("div",{class:"flex flex-row h-8 text-sm"},[s("button",{class:"border border-blue-300 text-blue-300 hover:text-blue-100 hover:border-blue-100 rounded-md px-2 m-1",onClick:c},"执行"),s("button",{class:"border border-slate-300 text-slate-300 hover:text-slate-100 hover:border-slate-100 rounded-md px-2 m-1",onClick:_},"清除")]),s("div",ea,[(p(!0),f(j,null,W(r.value,($,I)=>(p(),f("p",{key:I,class:L($.classes)},M($.content),3))),128))])])]))}}),oa=ae(ta,[["__scopeId","data-v-d7e5dbac"]]),la={class:"relative inline-flex items-center h-6 border border-slate-400 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2"},sa=["checked"],aa=s("span",{class:"sr-only"},"Use setting",-1),na={__name:"Switch",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:e}){return(o,l)=>(p(),f("label",la,[s("input",{type:"checkbox",checked:t.modelValue,onChange:l[0]||(l[0]=n=>o.$emit("update:modelValue",n.target.checked)),class:"absolute opacity-0 w-0 h-0"},null,40,sa),s("span",{"aria-hidden":"true",class:L(["inline-block w-5 h-5 rounded-full shadow transform ring-0 transition duration-200 ease-in-out",{"bg-blue-400 translate-x-5":t.modelValue,"bg-slate-400 translate-x-0":!t.modelValue}])},null,2),aa]))}},ra={__name:"Setting",setup(t){const e=h(!1);return(o,l)=>(p(),f("div",null,[v(J,{hiddenFold:!0}),v(na,{modelValue:e.value,"onUpdate:modelValue":l[0]||(l[0]=n=>e.value=n)},null,8,["modelValue"])]))}},ia={class:"flex shadow-lg p-2 lg:p-4 rounded-lg"},ua={class:"flex-1"},ca={class:"font-bold text-slate-900"},da={class:"text-blue-900"},pa={class:"w-8 flex items-center text-lg text-blue-300 hover:text-blue-700"},ma={__name:"WordCard",props:{modelValue:{type:Object,default:()=>({_id:"",chinese:"",english:"",newWord:!0,createTime:""})}},emits:["update:modelValue"],setup(t,{emit:e}){const o=t,l=e,n=()=>{xo(o.modelValue._id,!o.modelValue.newWord).then(()=>{l("update:modelValue",{...o.modelValue,newWord:!o.modelValue.newWord})})};return(a,r)=>(p(),f("div",ia,[s("div",ua,[s("p",ca,M(t.modelValue.chinese),1),s("p",da,M(t.modelValue.english),1)]),s("div",pa,[v(k,{name:t.modelValue.newWord?"flag-2-line":"flag-2-fill",onClick:V(n,["stop"])},null,8,["name"])])]))}},fa={class:"flex flex-col h-screen w-full justify-center items-center text-slate-700"},va={class:"flex-1 w-full p-2 lg:p-4"},ha={__name:"Words",setup(t){const e=h([]),o=(l,n)=>{let a=e.value[l];a.newWord=n.newWord};return Q(()=>{go(!0).then(l=>{e.value=l})}),(l,n)=>(p(),f("div",fa,[v(J),s("div",va,[(p(!0),f(j,null,W(e.value,(a,r)=>(p(),N(ma,{kye:"word._id",modelValue:a,"onUpdate:modelValue":i=>o(r,i)},null,8,["modelValue","onUpdate:modelValue"]))),256))])]))}},ga={class:"flex-1 p-2 sm:p-3 xl:p-5 pb-10 lg:pb-14 bg-white/95 lg:bg-transparent"},ba=["onClick"],xa={__name:"Contacts",props:{fold:{type:Boolean,default:!0},contacts:{type:Array,default:()=>[]}},emits:["toggleFold","menuChange"],setup(t,{emit:e}){const o=t,l=h(!0),n=h(""),a=e,r=()=>{l.value=!0,a("toggleFold",!0)},i=d=>{n.value=d,a("chatTo",d)};return D(()=>o.fold,(d,u)=>{l.value=d},{immediate:!0}),(d,u)=>(p(),f("div",{class:L(["flex flex-col fixed top-16 bottom-0 backdrop-blur overflow-y-auto z-20 bg-black/20 lg:bg-transparent w-full lg:w-80 pr-24 lg:pr-0 transition-transform duration-300 ease-out delay-100 lg:translate-x-0",l.value?"translate-x-[-100%]":"translate-x-0"]),onClick:V(r,["stop"])},[s("nav",ga,[s("ul",null,[(p(!0),f(j,null,W(t.contacts,(m,b)=>(p(),f("li",{key:m._id,onClick:c=>i(m._id),class:"cursor-pointer"},[v(ue,{size:"sm"}),s("span",{class:L(n.value===m._id?"text-blue-500 font-bold":"text-slate-500 hover:text-blue-300")},M(m.name),3)],8,ba))),128))])])],2))}},_a=ae(xa,[["__scopeId","data-v-79713423"]]),ya=t=>B.get("/message/getContactMessages",{params:{contact:t}}).then(e=>e&&e.data&&e.data.success?e.data.data:Promise.reject(e&&e.data&&e.data.message)),wa="ws://42.193.244.237:3001";class ka{constructor(){F(this,"sender",h(Ot()));F(this,"recipient");F(this,"contacts",h([]));F(this,"messages",h([]));F(this,"socket");F(this,"useMessages",()=>this.messages);F(this,"useUserId",()=>this.sender);this.recipient="",this.contacts=h([]),$t().then(e=>{this.contacts.value=e||[]}),this.messages=h([]),this.socket=new WebSocket(wa),this.bindEvent()}sendMessage(e){e&&(this.socket.send(JSON.stringify(e)),this.appendMessage(e))}appendMessage(e,o=!1){let{from:l,to:n}=e,a=o?l:n;this.messages.value.push(e);let r=this.contacts.value.find(({_id:i})=>i===a);r&&!o&&(r.unreadCount=r.unreadCount?r.unreadCount+1:1)}close(){this.socket.close(),this.contacts=null,this.messages=null}bindEvent(){this.socket.addEventListener("open",()=>{console.log("Connection opened"),this.sender&&this.sender.value?this.socket.send(this.sender.value):Fe().then(e=>{this.sender.value=e.userId,Ve(e),this.socket.send(e.userId)})}),this.socket.addEventListener("message",e=>{let o=e.data;console.log(`Received message: ${o}`),o=JSON.parse(o),Object.prototype.toString.call(o)==="[object Array]"?o.forEach(l=>{this.appendMessage(l,!0)}):this.appendMessage(o,!0)}),this.socket.addEventListener("close",()=>{console.log("Connection closed")})}getContacts(){var e;return(e=this.contacts)==null?void 0:e.value}useContacts(){return this.contacts}setContacts(e){this.contacts.value=e}changeRecipient(e){var l;this.recipient=e;let o=(l=this.contacts.value.find(({_id:n})=>n===e))==null?void 0:l.messages;o?this.messages.value=o:ya(e).then(n=>{this.messages.value=n||[],this.contacts.value.find(({_id:a})=>a===e).messages=this.messages.value})}onChat(e){this.sendMessage({from:this.sender.value,to:this.recipient,content:e})}}const $a={class:"flex flex-col w-full h-screen"},Ca={class:"flex-1 flex flex-col w-full lg:pl-80 overflow-y-auto"},Ia={__name:"Chat",setup(t){let e=new ka;const o=h(!0),l=h(!1),n=e.useContacts(),a=e.useMessages(),r=e.useUserId(),i=m=>{if(m!==void 0){o.value=m;return}o.value=!o.value},d=m=>{e.changeRecipient(m)},u=m=>{e.onChat(m)};return pe(()=>{e.close(),e=null}),(m,b)=>(p(),f("div",$a,[v(J,{onToggleFold:i,fold:o.value},null,8,["fold"]),v(_a,{class:"lg: border-r",onChatTo:d,fold:o.value,contacts:ie(n),onToggleFold:i},null,8,["fold","contacts"]),s("div",Ca,[v(tt,{placeholder:"咱们开始聊天吧...",editable:!0,messages:ie(a),loading:l.value,onChart:u,owner:ie(r),roleProperty:"from"},null,8,["messages","loading","owner"])])]))}},Va=[{name:"root",path:"/",redirect:"/home"},{name:"login",path:"/login",component:Wt},{name:"home",path:"/home",component:Eo},{name:"register",path:"/register",component:Ro},{name:"books",path:"/books",component:Nl,children:[{path:":id",component:Hl}]},{name:"schedule",path:"/schedule",component:ss},{name:"robot",path:"/robot",component:ws},{name:"translation",path:"/translation",component:Os},{name:"portals",path:"/portals",component:Ys},{name:"coding",path:"/coding",component:oa},{name:"setting",path:"/setting",component:ra},{name:"words",path:"/words",component:ha},{name:"chat",path:"/chat",component:Ia}],ot=pt({history:mt(),routes:Va,scrollBehavior(t){if(t.hash)return{el:t.hash}}});ot.beforeEach(async(t,e,o)=>{console.log("route",t,e),o()});const Be=ft(yt);Be.use(ot);Be.use(vt,{defaultProps:{theme:"light"}});Be.mount("#app");export{k as _,ae as a,bs as g,A as m};
