import{ai as j,aj as r,ao as L,aD as v,aE as d,aH as u,aF as i,aS as h,aG as x,aT as C,aX as y,aN as X,aY as Y,aV as q}from"./vendor-7SOp03Eo.js";import{R as k}from"./RemixIcon-C3kAUqBT.js";import{C as _}from"./Card-DdO88aH6.js";import{a as z,G as J,B as K,c as O,u as Q}from"./GroupModal-CTqx1GXs.js";import{H as W}from"./Header-RLgrfCVI.js";import{M as Z}from"./Modal-DgpgRzLZ.js";import{r as ee,c as oe,u as le}from"./book-D8GVYk51.js";import{m as B}from"./message-DneuB5hD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-BIo_BOvM.js";import"./userInfo-GWa4mCN8.js";import"./user-DjlSiqBu.js";const ae={class:"flex flex-col h-screen w-full"},te={key:0},se={class:"flex-1 p-2 lg:p-4 overflow-y-auto"},ne=["onMouseover"],ie={class:"mr-2"},ue={class:"flex flex-row flex-wrap"},re={key:0,class:"p-2 md:p-4 lg:p-4 basis-1/4 md:basis-1/6 lg:basis-1/12"},ve=u("p",{class:"align-center"},"你真的要删除这个书签？",-1),Be=j({__name:"Portals",setup(de){const a=r(Array()),m=r(!1),t=r(),p=r(),n=r(),s=r(!1),f=r(),b=r(""),M=e=>{s.value=!0,t.value={title:"新增书签",type:"link",url:"",category:e.id}},w=e=>{s.value=!1,t.value=e,p.value=e.category},P=e=>{f.value=e.id},E=()=>{f.value=null},R=()=>{ee(f.value).then(e=>{a.value=a.value.map(o=>(o.id===e.category&&(o.books=o.books&&o.books.filter(l=>l.id!==e.id)),o)),f.value=null})},V=()=>{s.value=!0,n.value={name:""}},$=e=>{s.value=!1,n.value=e},G=()=>{B.warning("还未开发，敬请期待")},N=()=>{B.warning("还未开发，敬请期待")},I=()=>{s.value?O(n.value).then(e=>{a.value&&a.value.length>0&&a.value.push(e),n.value=void 0,s.value=!1}):Q(n.value).then(e=>{a.value=a.value.map(o=>o.id===e.id?e:o),n.value=void 0})},F=()=>{s.value?oe(t.value).then(e=>{let o=a.value.find(({id:l})=>l===e.category);o&&(o.books=o.books||[],e.id=e._id,o.books.splice(0,0,e),t.value=void 0,s.value=!1)}):t&&t.value&&le(t.value).then(e=>{e.category!==p.value&&(a.value=a.value.map(o=>{var l;return o.id===p.value&&(o.books=o.books&&o.books.filter(g=>g.id!==e.id)),o.id===e.category&&((l=o.books)==null||l.splice(0,0,e)),o})),t.value=void 0})},H=()=>{n.value=void 0,s.value=!1},A=()=>{t.value=void 0,p.value=void 0,s.value=!1},D=e=>{b.value=e},S=()=>{b.value=""};return L(()=>{z().then(e=>{m.value=e.editable,a.value=e.portals})}),(e,o)=>(v(),d(x,null,[u("div",ae,[i(W,{hiddenFold:!0},{default:h(()=>[m.value?(v(),d("div",te,[u("button",{class:"px-2 py-1 text-2xl text-gray-500 hover:bg-gray-100 rounded",onClick:V},[i(k,{name:"add-line"})]),u("button",{class:"px-2 py-1 text-2xl text-gray-500 hover:bg-gray-100 rounded",onClick:G},[i(k,{name:"import-line"})]),u("button",{class:"px-2 py-1 text-2xl text-gray-500 hover:bg-gray-100 rounded",onClick:N},[i(k,{name:"export-line"})])])):y("",!0)]),_:1}),u("div",se,[(v(!0),d(x,null,C(a.value,(l,g)=>(v(),d("ul",{key:g},[u("p",{class:"m-2 text-gray-600 dark:text-gray-200 font-medium",onMouseover:c=>D(l.id),onMouseleave:o[0]||(o[0]=c=>S())},[u("span",ie,X(l.name),1),m.value&&b.value===l.id?(v(),Y(k,{key:0,class:"shadow-sm rounded-sm text-blue-300 hover:text-blue-700",name:"edit-line",onClick:q(c=>$(l),["stop"])},null,8,["onClick"])):y("",!0)],40,ne),u("div",ue,[(v(!0),d(x,null,C(l.books,(c,T)=>(v(),d("li",{class:"p-2 md:p-4 lg:p-4 basis-1/4 md:basis-1/6 lg:basis-1/12",key:T},[i(_,{theme:"blue",editable:m.value,modelValue:c,onEdit:U=>w(c),onRemove:U=>P(c)},null,8,["editable","modelValue","onEdit","onRemove"])]))),128)),m.value?(v(),d("li",re,[i(_,{theme:"blue",modelValue:{title:"新增书签",icon:"add-line"},onCardClick:()=>M(l)},null,8,["onCardClick"])])):y("",!0)])]))),128))])]),i(J,{title:`${s.value?"新增分类":"编辑分类"}`,visible:!!n.value,group:n.value,"onUpdate:group":o[1]||(o[1]=l=>n.value=l),onConfirm:I,onCancel:H},null,8,["title","visible","group"]),i(K,{fixedType:"link",title:`${s.value?"新增书签":"编辑书签"}`,visible:!!t.value,book:t.value,"onUpdate:book":o[2]||(o[2]=l=>t.value=l),onConfirm:F,categories:a.value,onCancel:A},null,8,["title","visible","book","categories"]),i(Z,{visible:!!f.value,closable:!1,title:"确认删除",onConfirm:R,onCancel:E},{default:h(()=>[ve]),_:1},8,["visible"])],64))}});export{Be as default};
