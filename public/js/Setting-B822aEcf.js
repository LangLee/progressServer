import{H as S}from"./Header-jlxeZXVD.js";import{P as k}from"./ProInput-DLzwbHQE.js";import{d as B,_ as j,e as A}from"./index-bEem1MK9.js";import{aj as f,bd as y,aW as $,az as p,a_ as M,a$ as F,aG as c,aD as i,aF as z,aE as h,aA as b,aB as U,ai as H,aH as L,ap as T}from"./vendor-DqHIQWU1.js";import{v as q,s as D}from"./verification-CL8ovHMx.js";import{g as I,s as _}from"./userInfo-CSbayTML.js";import{a as N,u as P,b as R,c as E}from"./user-BZG51SbY.js";import"./utils-DVDKZiQc.js";import"./remixicon-l0sNRNKZ.js";/* empty css                                                                 */import"./message-DsTL7g5X.js";import"./file-D7E9LNHg.js";const G={class:"w-full my-3 flex flex-row justify-between"},O={__name:"VerifyModal",props:{name:{type:String,default:"email"},label:{type:String,default:"邮箱"},visible:{type:Boolean,default:!1},value:{type:String,default:""}},emits:["confirm","cancel"],setup(n,{emit:e}){const t=n,u=f(t.value),o=f(),r=f(!1),a=e,l=f(t.visible),s=y(()=>`绑定${t.label}`),d=y(()=>`请输入${t.label}`),g=()=>{q({[t.name]:u.value},o.value).then(m=>{m&&(a("confirm",u.value),l.value=!1)})},V=()=>{a("cancel"),l.value=!1},w=()=>{D({[t.name]:u.value}).then(m=>{r.value=!0})};return $(()=>t.visible,()=>{l.value=t.visible}),$(()=>t.value,(m,v)=>{m!=v&&(u.value=m)}),(m,v)=>(p(),M(B,{title:s.value,visible:l.value,"onUpdate:visible":v[2]||(v[2]=x=>l.value=x),onConfirm:g,onCancel:V,okText:"绑定"},{default:F(()=>[c(k,{class:"my-2",name:"modelValue",modelValue:u.value,"onUpdate:modelValue":v[0]||(v[0]=x=>u.value=x),placeholder:d.value},null,8,["modelValue","placeholder"]),i("div",G,[c(k,{class:"mr-2",width:"10rem",name:"verification",modelValue:o.value,"onUpdate:modelValue":v[1]||(v[1]=x=>o.value=x),placeholder:"输入验证码"},null,8,["modelValue"]),i("button",{class:"px-2 bg-slate-300 text-white font-semibold rounded-md hover:bg-slate-600",onClick:z(w,["stop"])},h(r.value?"重新发送":"发送验证码"),1)])]),_:1},8,["title","visible"]))}},W={class:"w-full flex flex-row items-center justify-center bg-slate-300/20 dark:bg-neutral-800 text-gray-500 dark:text-gray-400 p-2 rounded-lg"},J={class:"flex-1"},K={class:"mb-1"},Q={class:"text-sm text-gray-400 dark:text-gray-500"},C={__name:"ThirdBindCard",props:{name:{type:String,required:!0,default:"email"},label:{type:String,default:"邮件"},modelValue:{type:String,default:""},placeholder:{type:String,default:"未绑定"}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,u=e,o=f(!1),r=y(()=>t.modelValue?"checkbox-circle-fill":"question-fill"),a=y(()=>t.modelValue?"更改":"绑定"),l=()=>{o.value=!0},s=g=>{u("update:modelValue",g),o.value=!1},d=()=>{o.value=!1};return(g,V)=>(p(),b("div",W,[c(j,{class:U(["p-4 text-3xl",r.value==="checkbox-circle-fill"?"text-green-500":"text-yellow-500"]),name:r.value},null,8,["class","name"]),i("div",J,[i("div",K,h(n.label),1),i("div",Q,h(n.modelValue||n.placeholder),1)]),i("button",{class:"px-2 rounded border border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-400 hover:border-blue-500 hover:text-blue-500 text-sm",onClick:l},h(a.value),1),c(O,{name:n.name,label:n.label,visible:o.value,value:n.modelValue,onConfirm:s,onCancel:d},null,8,["name","label","visible","value"])]))}},X={class:"flex flex-col items-center justify-center"},Y=["src"],Z={key:1,xmlns:"http://www.w3.org/2000/svg",class:"w-16 h-16 text-gray-400 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ee=i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1),le=[ee],ae={class:"mt-2 text-sm text-gray-500"},te=H({__name:"AvatarUploader",props:{img:{type:String,default:""},upload:{type:Function,default:()=>null},rounded:{type:Boolean,default:!0}},emits:["remove"],setup(n,{emit:e}){const t=n,u=e,o=f(),r=f(""),a=async s=>{const d=s.target.files[0];if(!d)return;if(!["image/jpeg","image/png"].includes(d.type)){r.value="只允许上传jpeg/png格式的图片";return}if(d.size>2*1024*1024){r.value="图片上传大小不能超过2MB";return}if(t.upload&&await t.upload(d)){const w=new FileReader;w.onload=m=>{o.value=m.target&&m.target.result,r.value=""},w.readAsDataURL(d)}},l=()=>{o.value=null,r.value="",u("remove")};return $(()=>t.img,s=>{s&&(o.value=s)},{immediate:!0}),(s,d)=>(p(),b("div",X,[i("label",{for:"avatar",class:U(["cursor-pointer relative inline-block w-32 h-32 overflow-hidden bg-gray-200",{"border-4 border-dashed border-blue-500":!o.value,"rounded-full":n.rounded}])},[o.value?(p(),b("img",{key:0,src:o.value,class:"w-full h-full object-cover"},null,8,Y)):(p(),b("svg",Z,le)),i("input",{type:"file",id:"avatar",class:"hidden",accept:"image/*",onChange:a,"accept-charset":"utf-8"},null,32)],2),o.value?(p(),b("button",{key:0,class:"mt-4 px-4 py-1 bg-red-500 text-white rounded hover:bg-red-600",onClick:l}," 删除头像 ")):L("",!0),i("p",ae,h(r.value),1)]))}}),oe={class:"h-screen w-full flex flex-col overflow-y-auto"},se={class:"w-full flex-1 flex flex-wrap justify-start bg-gray-300/20 dark:bg-transparent max-w-screen-2xl mx-auto"},ne={class:"flex flex-col w-full items-center max-w-screen-sm mx-auto bg-white p-8 lg:px-16 dark:bg-transparent"},he={__name:"Setting",setup(n){const e=f(I()||{}),t=y(()=>{if(e.value&&e.value.avatar)return`${A}/file/preview?file=${e.value.avatar}`}),u=a=>P(e.value._id,a).then(l=>{l&&(e.value=l,_(l))}),o=()=>R(e.value).then(a=>{a&&(e.value=a,_(a))}),r=()=>{E(e.value).then(a=>{a&&_(a)})};return T(()=>{(!e.value||!e.value._id)&&N().then(a=>{_(a),e.value=a})}),(a,l)=>(p(),b("div",oe,[c(S,{hiddenFold:!0}),i("div",se,[i("div",ne,[c(te,{upload:u,img:t.value,onRemove:o},null,8,["img"]),c(k,{class:"mb-4",name:"name",label:"用户名称",modelValue:e.value.name,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value.name=s),placeholder:"请输入用户名称",border:"",required:""},null,8,["modelValue"]),c(C,{class:"mb-4",name:"email",label:"邮箱",modelValue:e.value.email,"onUpdate:modelValue":l[1]||(l[1]=s=>e.value.email=s)},null,8,["modelValue"]),c(C,{class:"mb-4",name:"mobile",label:"手机号码",modelValue:e.value.mobile,"onUpdate:modelValue":l[2]||(l[2]=s=>e.value.mobile=s)},null,8,["modelValue"]),i("button",{class:"w-full py-2 lg:py-3 bg-blue-300 lg:text-lg text-white font-semibold rounded-md shadow-md hover:bg-blue-600",onClick:r}," 保存 ")])])]))}};export{he as default};
