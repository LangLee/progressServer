import{ad as L,ae as r,ak as Q,ay as d,az as v,aC as s,aA as i,aN as _,aB as x,aQ as y,aU as h,aP as T,aM as j,aS as q}from"./vendor-BLq22pPX.js";import{R as p}from"./RemixIcon-BDA1nEXk.js";import{_ as C}from"./Card.vue_vue_type_script_setup_true_lang-Bgq7kUqg.js";import{a as J,G as K,B as O,c as W,u as X}from"./GroupModal-C7Gvsm3t.js";import{H as Y}from"./Header-C6RPu72y.js";import{M as Z}from"./Modal-BWdB3J9G.js";import{r as ee,c as oe,u as le}from"./book-B1UjrR01.js";import{m as B}from"./message-AZuur2LZ.js";import"./userInfo-CtL9gwPY.js";import"./user-Bu3yqCiw.js";import"./index-DpKJEyGL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"flex flex-col h-screen w-full"},ae={key:0},se=s("span",null,"新增",-1),ne=s("span",null,"导入",-1),ue=s("span",null,"导出",-1),ie={class:"flex-1 p-2 lg:p-4 overflow-y-auto"},re=["onMouseover"],de={class:"mr-2"},ve={class:"flex flex-row flex-wrap"},ce={key:0,class:"m-2 lg:m-4"},me=s("p",{class:"align-center"},"你真的要删除这个书签？",-1),Pe=L({__name:"Portals",setup(fe){const t=r(Array()),m=r(!1),n=r(),b=r(),u=r(),a=r(!1),f=r(),g=r(""),M=e=>{a.value=!0,n.value={title:"新增书签",type:"link",url:"",category:e.id}},w=e=>{a.value=!1,n.value=e,b.value=e.category},P=e=>{f.value=e.id},R=()=>{f.value=null},$=()=>{ee(f.value).then(e=>{t.value=t.value.map(o=>(o.id===e.category&&(o.books=o.books&&o.books.filter(l=>l.id!==e.id)),o)),f.value=null})},E=()=>{a.value=!0,u.value={name:""}},V=e=>{a.value=!1,u.value=e},N=()=>{B.warning("还未开发，敬请期待")},G=()=>{B.warning("还未开发，敬请期待")},I=()=>{a.value?W(u.value).then(e=>{t.value&&t.value.length>0&&t.value.push(e),u.value=void 0,a.value=!1}):X(u.value).then(e=>{t.value=t.value.map(o=>o.id===e.id?e:o),u.value=void 0})},A=()=>{a.value?oe(n.value).then(e=>{let o=t.value.find(({id:l})=>l===e.category);o&&(o.books=o.books||[],e.id=e._id,o.books.splice(0,0,e),n.value=void 0,a.value=!1)}):n&&n.value&&le(n.value).then(e=>{e.category!==b.value&&(t.value=t.value.map(o=>{var l;return o.id===b.value&&(o.books=o.books&&o.books.filter(k=>k.id!==e.id)),o.id===e.category&&((l=o.books)==null||l.splice(0,0,e)),o}))})},U=()=>{u.value=void 0,a.value=!1},F=()=>{n.value=void 0,b.value=void 0,a.value=!1},H=e=>{g.value=e},S=()=>{g.value=""};return Q(()=>{J().then(e=>{m.value=e.editable,t.value=e.portals})}),(e,o)=>(d(),v(x,null,[s("div",te,[i(Y,{hiddenFold:!0},{default:_(()=>[m.value?(d(),v("div",ae,[s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium rounded-md text-slate-50 bg-blue-400 hover:bg-blue-700",onClick:E},[se,i(p,{name:"add-line"})]),s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium border rounded-md text-blue-400 border-blue-400 hover:text-blue-700 hover:border-blue-700",onClick:N},[ne,i(p,{name:"add-line"})]),s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium border rounded-md text-blue-400 border-blue-400 hover:text-blue-700 hover:border-blue-700",onClick:G},[ue,i(p,{name:"add-line"})])])):h("",!0)]),_:1}),s("div",ie,[(d(!0),v(x,null,y(t.value,(l,k)=>(d(),v("ul",{key:k},[s("p",{class:"m-2 lg:m-4 text-basic lg:text-lg text-blue-900 font-medium",onMouseover:c=>H(l.id),onMouseleave:o[0]||(o[0]=c=>S())},[s("span",de,T(l.name),1),m.value&&g.value===l.id?(d(),j(p,{key:0,class:"shadow-sm rounded-sm text-blue-300 hover:text-blue-700",name:"edit-line",onClick:q(c=>V(l),["stop"])},null,8,["onClick"])):h("",!0)],40,re),s("div",ve,[(d(!0),v(x,null,y(l.books,(c,z)=>(d(),v("li",{class:"m-2 lg:m-4",key:z},[i(C,{theme:"blue",editable:m.value,modelValue:c,onEdit:D=>w(c),onRemove:D=>P(c)},null,8,["editable","modelValue","onEdit","onRemove"])]))),128)),m.value?(d(),v("li",ce,[i(C,{theme:"blue",modelValue:{title:"新增书签",icon:"add-line"},onCardClick:()=>M(l)},null,8,["onCardClick"])])):h("",!0)])]))),128))])]),i(K,{title:`${a.value?"新增分类":"编辑分类"}`,visible:!!u.value,group:u.value,"onUpdate:group":o[1]||(o[1]=l=>u.value=l),onConfirm:I,onCancel:U},null,8,["title","visible","group"]),i(O,{fixedType:"link",title:`${a.value?"新增书签":"编辑书签"}`,visible:!!n.value,book:n.value,"onUpdate:book":o[2]||(o[2]=l=>n.value=l),onConfirm:A,categories:t.value,onCancel:F},null,8,["title","visible","book","categories"]),i(Z,{visible:!!f.value,closable:!1,title:"确认删除",onConfirm:$,onCancel:R},{default:_(()=>[me]),_:1},8,["visible"])],64))}});export{Pe as default};
