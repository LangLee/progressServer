const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Markdown-VYojzyL6.js","./tiptap-Cw0-fBmj.js","./vendor-1hORrrXR.js","../css/vendor-St55MTdn.css","./RemixIcon-DLZgjpvL.js","./ai-BAwTwO-P.js","./message-ShWl2tYi.js","./_plugin-vue_export-helper-DlAUqK2U.js","../css/message-Ld0-QEl8.css","./utils-Cs41FaCi.js","../css/Markdown-dm9U-szx.css","./Text-Cdwkxe2y.js","./Code-BQ2yOrKq.js","../css/Code-BLTi7TbQ.css","./Task-Bu1XZ5ok.js","../css/Task-CoyDmG1V.css","./Drawing-zM0z3MpC.js","../css/Drawing-Bdgq6z4a.css"])))=>i.map(i=>d[i]);
import{_ as n}from"./index-CA56zL0v.js";import{ad as x,av as E,ai as C,ae as m,aM as A,ay as p,az as f,aN as I,aV as R,aA as V,aU as y,aT as L,aF as s}from"./vendor-1hORrrXR.js";import{u as P,g as B}from"./book-Dm6-ywUB.js";import{m as _}from"./message-ShWl2tYi.js";import{R as D}from"./RemixIcon-DLZgjpvL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const M=x({__name:"Book",setup(T){const k=E(),r=C(),l=m(""),u=m(Array()),c=m(!1),i=m(!1);let v="";const d=m(""),b=()=>new Promise(t=>{if(l.value===v)return t(!0);let o=[];u.value.length>0&&(o=u.value.map(a=>({id:a.id,itemIndex:a.itemIndex,level:a.level,originalLevel:a.originalLevel,pos:a.pos,textContent:a.textContent})));let e={id:d.value,content:l.value,anchors:o};P(e).then(a=>{a&&(v=l.value,_.success("保存成功"),t(!0))}).catch(a=>{_.error(a),t(!1)})}),g=t=>{switch(t){case"markdown":{r.value=s(()=>n(()=>import("./Markdown-VYojzyL6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url));break}case"chat":case"text":{r.value=s(()=>n(()=>import("./Text-Cdwkxe2y.js"),__vite__mapDeps([11,1,2,3,9]),import.meta.url));break}case"code":{r.value=s(()=>n(()=>import("./Code-BQ2yOrKq.js"),__vite__mapDeps([12,2,3,9,13]),import.meta.url));break}case"task":{r.value=s(()=>n(()=>import("./Task-Bu1XZ5ok.js"),__vite__mapDeps([14,1,2,3,9,15]),import.meta.url));break}case"drawing":{r.value=s(()=>n(()=>import("./Drawing-zM0z3MpC.js"),__vite__mapDeps([16,1,2,3,7,9,17]),import.meta.url));break}default:{r.value=s(()=>n(()=>import("./Markdown-VYojzyL6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url));break}}},h=()=>{i.value?b().then(()=>{i.value=!1}):i.value=c.value};return A(()=>k.params.id,(t,o)=>{t&&t!==o&&(typeof t=="string"&&(d.value=t||""),B(d.value).then(e=>{l.value=e.content||"",u.value=e.anchors||[],v=e.content||"",c.value=e.editable||!1,g(e.type)}).catch(e=>{_.error(e)}))},{immediate:!0}),(t,o)=>(p(),f("div",{class:L(["w-full h-full flex",{"select-none":!c.value}])},[(p(),I(R(r.value),{editable:i.value,modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=e=>l.value=e),anchors:u.value,"onUpdate:anchors":o[1]||(o[1]=e=>u.value=e)},null,40,["editable","modelValue","anchors"])),c.value?(p(),f("div",{key:0,class:"fixed top-28 right-4 w-8 h-8 text-center rounded-full border bg-blue-700/10 hover:bg-blue-500 z-50 cursor-pointer",onClick:h},[V(D,{class:"text-slate-50 text-lg",name:i.value?"save-line":"file-edit-line"},null,8,["name"])])):y("",!0)],2))}});export{M as default};
