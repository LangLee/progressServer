import{R as h}from"./RemixIcon-CgHXNHMg.js";import{M as S}from"./Modal-B5x_NgZY.js";import{H as R}from"./Header-C2ZRdA8X.js";import{_ as H}from"./ChatPanel-BUmdwLXC.js";import"./Menu-DTRMr5Ar.js";import{g as D}from"./ai-BVRWMiUD.js";import{aj as i,aD as v,aE as g,aH as t,aF as u,aS as M,aX as x,aU as I,aO as V,aP as q,ao as A,aG as E,aV as N,aQ as $,az as O,aA as j,aT as z,aR as F,aY as L}from"./vendor-CWXOCgin.js";import{u as P,r as U,b as X,g as G}from"./book-PI_kZs2c.js";import{m as J}from"./message-B11-HW_C.js";import"./userInfo-BH_HArD6.js";import"./Fish-twJ8LYmt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-BIo_BOvM.js";import"./Question-B_5_mfwX.js";import"./FishGlass-BerDv30e.js";import"./GroupModal-HttnGsel.js";import"./index-B7emg1l8.js";const K={key:0,class:"h-8 leading-8"},Q={key:1,class:"text-slate-500"},Y={class:"flex flex-col"},W={class:"flex flex-row"},Z=t("label",{class:"text-right mr-2 p-2"},"标题",-1),ee={__name:"BookMark",props:{book:{type:Object,required:!0}},emits:["skip","delete"],setup(f,{emit:b}){const o=i(!1);let e=0;const l=f,r=i(l.book.title),a=b,c=i(!1),n=()=>{a("skip",l.book._id)},k=()=>{c.value=!0},_=()=>{c.value=!1},T=w=>{e=w.touches[0].clientX},B=w=>{if(!e)return!0;let m=w.changedTouches[0].clientX;if(Math.abs(e-m)<10)return e=0,!0;e>m?c.value=!0:e<m&&(c.value=!1),e=0},y=()=>{o.value=!0},s=()=>{o.value=!1,!(!r.value||r.value===l.book.title)&&P({id:l.book._id,title:r.value}).then(()=>{l.book.title=r.value,r.value=""})},d=()=>{o.value=!1},p=()=>{U(l.book._id).then(()=>{a("delete",l.book._id),J.success("删除成功!")})};return(w,m)=>(v(),g("div",{class:"flex flex-row w-full justify-between items-center h-12 leading-[3rem] border border-gray-300/20 bg-white/90 dark:bg-neutral-900 m-1 px-4 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-neutral-800",onClick:x(n,["stop"]),onMouseover:x(k,["stop"]),onMouseleave:x(_,["stop"]),onTouchstartPassive:T,onTouchendPassive:B},[t("span",null,[u(h,{class:"text-blue-300 mr-2",name:"chat-smile-2-line"}),t("span",null,M(f.book.title),1)]),c.value?(v(),g("span",K,[t("button",{class:"px-1 lg:px-2 rounded hover:bg-gray-200 dark:hover:bg-gray-500 text-gray-500 hover:text-gray-700",onClick:x(y,["stop"])},[u(h,{name:"edit-2-fill"})]),t("button",{class:"px-1 lg:px-2 rounded hover:bg-gray-200 dark:hover:bg-gray-500 text-gray-500 hover:text-gray-700",onClick:x(p,["stop"])},[u(h,{name:"delete-bin-fill"})])])):(v(),g("span",Q,M(f.book.createTime),1)),u(S,{title:"编辑",visible:o.value,"onUpdate:visible":m[1]||(m[1]=C=>o.value=C),onConfirm:s,onCancel:d},{default:I(()=>[t("div",Y,[t("div",W,[Z,V(t("input",{class:"flex-1 border p-2 rounded","onUpdate:modelValue":m[0]||(m[0]=C=>r.value=C)},null,512),[[q,r.value]])])])]),_:1},8,["visible"])],32))}},te={class:"w-full bg-white/40 dark:bg-neutral-700/40 backdrop-blur-2xl overflow-y-auto"},oe={class:"flex flex-col items-center max-w-screen-md mx-auto p-2"},ae={__name:"BookHistory",emits:["skipTo"],setup(f,{emit:b}){const o=i([]),e=b,l=a=>{e("skipTo",a)},r=a=>{o.value.splice(a,1)};return A(()=>{X().then(a=>{o.value=a})}),(a,c)=>(v(),g("div",te,[t("div",oe,[(v(!0),g(E,null,N(o.value,(n,k)=>(v(),$(ee,{key:n._id,book:n,onSkip:l,onDelete:_=>r(k)},null,8,["book","onDelete"]))),128))])]))}},se={class:"flex flex-col w-full h-screen"},le={class:"p-2 text-xl text-gray-500"},re={class:"flex-1 flex-col w-full bg-slate-300/20 overflow-hidden"},Ce={__name:"Robot",setup(f){const b=O(),o=j(),e=i([]),l=i(!1),r=i("tongyi"),a=i("");i(!0);const c=i(""),n=i(!1),k=s=>{e.value=e.value.concat([{role:"user",content:s}]);let d="";D({appId:o.query.appId,id:a.value,mode:r.value,question:s},p=>{d+=p,c.value=d},p=>{p&&(a.value=p),c.value="",e.value=e.value.concat([{role:"assistant",content:d}])})},_=()=>{y()},T=()=>{n.value=!n.value},B=()=>{},y=s=>{b.push({path:"/robot",query:{id:s,appId:o.query.appId}}),n.value=!1};return z(()=>o.query.id,(s,d)=>{s!==d&&(a.value=s,s?G(s).then(p=>{e.value=JSON.parse(p.content||"[]")}):e.value=[])},{immediate:!0}),(s,d)=>(v(),g("div",se,[u(R,{hiddenFold:!0},{default:I(()=>[t("div",le,[t("button",{class:"hover:bg-gray-200 hover:text-gray-700 px-1 rounded mr-2",onClick:_},[u(h,{class:"",name:"chat-new-line"})]),t("button",{class:L(["hover:bg-gray-200 hover:text-gray-700 px-1 rounded mr-2",{"text-gray-700":n.value,"bg-gray-200":n.value}]),onClick:T},[u(h,{class:"",name:"chat-history-line"})],2),t("button",{class:"hover:bg-gray-200 hover:text-gray-700 px-1 rounded",onClick:B},[u(h,{class:"",name:"robot-line"})])])]),_:1}),t("div",re,[u(H,{cardOperation:!0,editable:!0,messages:e.value,loading:l.value,onChart:k,response:c.value},null,8,["messages","loading","response"])]),n.value?(v(),$(ae,{key:0,class:"fixed top-16 bottom-0 right-0 z-50",onSkipTo:y})):F("",!0)]))}};export{Ce as default};
