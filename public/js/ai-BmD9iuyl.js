import{ay as p,bd as h}from"./vendor-7SOp03Eo.js";import{b}from"./index-DiC8-oKs.js";const S=o=>p.post("/ai/getYouDaoAiTranslate",o).then(t=>t.data&&t.data.success?t.data.data&&t.data.data:Promise.reject(t.data&&t.data.message)),y=({appId:o,id:t,mode:l,question:c,autoSave:d},u,e)=>{let a=new AbortController;const g=localStorage.getItem("me_token")||"";return h(`${b}/ai/getAiChatStream`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:g,appId:o},openWhenHidden:!0,body:JSON.stringify({id:t,mode:l,question:c,autoSave:d}),signal:a==null?void 0:a.signal,onmessage:n=>{const i=n.data||"";if(i==="[DONE]"){e(),a.abort();return}const r=JSON.parse(i);if(r.Done){let m=r.id;e(m),a.abort();return}const s=r.choices[0].delta.content;if(s==null){console.log("stop..."),e();return}u(s)},onclose(){console.log("close")},onerror(n){throw a.abort(),n}})};export{S as a,y as g};
