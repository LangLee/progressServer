import{ad as Q,ae as r,ak as T,ay as d,az as v,aC as s,aA as i,aN as h,aB as x,aQ as y,aU as _,aP as U,aM as j,aS as q}from"./vendor-BSAPUjJi.js";import{_ as g}from"./RemixIcon-Cb0msOyL.js";import{_ as C}from"./Card.vue_vue_type_script_setup_true_lang-C23AzbU6.js";import{a as J,G as K,B as O,c as W,u as X}from"./GroupModal-CjWEyChi.js";import{H as Y}from"./Header-DxcrElIQ.js";import{M as Z}from"./Modal-kPGpxXj6.js";import{r as ee,c as oe,u as le}from"./book-DvR0ogho.js";import{m as B}from"./message-CIMfOfme.js";import"./userInfo-Dj_dDAEm.js";import"./user-DPFXhvfg.js";import"./index-DVZ6Nk77.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"flex flex-col h-screen w-full"},ae={key:0},se=s("span",null,"新增",-1),ne=s("span",null,"导入",-1),ue=s("span",null,"导出",-1),ie={class:"flex-1 p-2 lg:p-4 overflow-y-auto"},re=["onMouseover"],de={class:"mr-2"},ve={class:"flex flex-row flex-wrap"},ce={key:0,class:"m-2 lg:m-4"},me=s("p",{class:"align-center"},"你真的要删除这个书签？",-1),Pe=Q({__name:"Portals",setup(fe){const l=r(Array()),m=r(!1),n=r(),b=r(),u=r(),a=r(!1),f=r(),p=r(""),M=e=>{a.value=!0,n.value={title:"新增书签",type:"link",url:"",category:e.id}},w=e=>{a.value=!1,n.value=e,b.value=e.category},P=e=>{f.value=e.id},$=()=>{f.value=null},E=()=>{ee(f.value).then(e=>{l.value=l.value.map(o=>(o.id===e.category&&(o.books=o.books&&o.books.filter(t=>t.id!==e.id)),o)),f.value=null})},R=()=>{a.value=!0,u.value={name:""}},V=e=>{a.value=!1,u.value=e},N=()=>{B.warning("还未开发，敬请期待")},G=()=>{B.warning("还未开发，敬请期待")},A=()=>{a.value?W(u.value).then(e=>{l.value&&l.value.length>0&&l.value.push(e),u.value=void 0,a.value=!1}):X(u.value).then(e=>{l.value=l.value.map(o=>o.id===e.id?e:o),u.value=void 0})},I=()=>{a.value?oe(n.value).then(e=>{let o=l.value.find(({id:t})=>t===e.category);o&&(o.books=o.books||[],e.id=e._id,o.books.splice(0,0,e),n.value=null,a.value=!1)}):n&&n.value&&le(n.value).then(e=>{e.category!==b.value&&(l.value=l.value.map(o=>{var t;return o.id===b.value&&(o.books=o.books&&o.books.filter(k=>k.id!==e.id)),o.id===e.category&&((t=o.books)==null||t.splice(0,0,e)),o}))})},F=()=>{u.value=void 0,a.value=!1},H=()=>{n.value=void 0,b.value=void 0,a.value=!1},S=e=>{p.value=e},z=()=>{p.value=""};return T(()=>{J().then(e=>{m.value=e.editable,l.value=e.portals})}),(e,o)=>(d(),v(x,null,[s("div",te,[i(Y,{hiddenFold:!0},{default:h(()=>[m.value?(d(),v("div",ae,[s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium rounded-md text-slate-50 bg-blue-400 hover:bg-blue-700",onClick:R},[se,i(g,{name:"add-line"})]),s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium border rounded-md text-blue-400 border-blue-400 hover:text-blue-700 hover:border-blue-700",onClick:N},[ne,i(g,{name:"add-line"})]),s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium border rounded-md text-blue-400 border-blue-400 hover:text-blue-700 hover:border-blue-700",onClick:G},[ue,i(g,{name:"add-line"})])])):_("",!0)]),_:1}),s("div",ie,[(d(!0),v(x,null,y(l.value,(t,k)=>(d(),v("ul",{key:k},[s("p",{class:"m-2 lg:m-4 text-basic lg:text-lg text-blue-900 font-medium",onMouseover:c=>S(t.id),onMouseleave:o[0]||(o[0]=c=>z())},[s("span",de,U(t.name),1),m.value&&p.value===t.id?(d(),j(g,{key:0,class:"shadow-sm rounded-sm text-blue-300 hover:text-blue-700",name:"edit-line",onClick:q(c=>V(t),["stop"])},null,8,["onClick"])):_("",!0)],40,re),s("div",ve,[(d(!0),v(x,null,y(t.books,(c,D)=>(d(),v("li",{class:"m-2 lg:m-4",key:D},[i(C,{theme:"blue",editable:m.value,modelValue:c,onEdit:L=>w(c),onRemove:L=>P(c)},null,8,["editable","modelValue","onEdit","onRemove"])]))),128)),m.value?(d(),v("li",ce,[i(C,{theme:"blue",modelValue:{title:"新增书签",icon:"add-line"},onCardClick:()=>M(t)},null,8,["onCardClick"])])):_("",!0)])]))),128))])]),i(K,{title:`${a.value?"新增分类":"编辑分类"}`,visible:!!u.value,group:u.value,onConfirm:A,onCancel:F},null,8,["title","visible","group"]),i(O,{fixedType:"link",title:`${a.value?"新增书签":"编辑书签"}`,visible:!!n.value,book:n.value,onConfirm:I,categories:l.value,onCancel:H},null,8,["title","visible","book","categories"]),i(Z,{visible:!!f.value,closable:!1,title:"确认删除",onConfirm:E,onCancel:$},{default:h(()=>[me]),_:1},8,["visible"])],64))}});export{Pe as default};
