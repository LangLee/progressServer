import{ad as L,ae as r,ak as O,ay as d,az as v,aC as s,aA as u,aO as _,aB as x,aQ as y,aU as h,aI as Q,aN as T,aS as j}from"./vendor-BNUAhoVR.js";import{R as p}from"./RemixIcon-D7fRXDKe.js";import{_ as C}from"./Card.vue_vue_type_script_setup_true_lang-BK8Xmx1W.js";import{a as q,G as J,B as K,c as W,u as X}from"./GroupModal-CQHL7XIo.js";import{H as Y}from"./Header-BZE7___w.js";import{M as Z}from"./Modal-CRZm8Nfu.js";import{r as ee,c as oe,u as le}from"./book-CTB1ni6Z.js";import{m as B}from"./message-IIE1a5pF.js";import"./userInfo-CWFSU6LP.js";import"./user-vqedsJWp.js";import"./index-CajyH5eH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"flex flex-col h-screen w-full"},ae={key:0},se=s("span",null,"新增",-1),ne=s("span",null,"导入",-1),ie=s("span",null,"导出",-1),ue={class:"flex-1 p-2 lg:p-4 overflow-y-auto"},re=["onMouseover"],de={class:"mr-2"},ve={class:"flex flex-row flex-wrap"},ce={key:0,class:"p-2 md:p-4 lg:p-4 basis-1/4 md:basis-1/6 lg:basis-1/12"},me=s("p",{class:"align-center"},"你真的要删除这个书签？",-1),Pe=L({__name:"Portals",setup(fe){const t=r(Array()),m=r(!1),n=r(),b=r(),i=r(),a=r(!1),f=r(),g=r(""),M=e=>{a.value=!0,n.value={title:"新增书签",type:"link",url:"",category:e.id}},w=e=>{a.value=!1,n.value=e,b.value=e.category},P=e=>{f.value=e.id},R=()=>{f.value=null},$=()=>{ee(f.value).then(e=>{t.value=t.value.map(o=>(o.id===e.category&&(o.books=o.books&&o.books.filter(l=>l.id!==e.id)),o)),f.value=null})},E=()=>{a.value=!0,i.value={name:""}},V=e=>{a.value=!1,i.value=e},I=()=>{B.warning("还未开发，敬请期待")},N=()=>{B.warning("还未开发，敬请期待")},G=()=>{a.value?W(i.value).then(e=>{t.value&&t.value.length>0&&t.value.push(e),i.value=void 0,a.value=!1}):X(i.value).then(e=>{t.value=t.value.map(o=>o.id===e.id?e:o),i.value=void 0})},A=()=>{a.value?oe(n.value).then(e=>{let o=t.value.find(({id:l})=>l===e.category);o&&(o.books=o.books||[],e.id=e._id,o.books.splice(0,0,e),n.value=void 0,a.value=!1)}):n&&n.value&&le(n.value).then(e=>{e.category!==b.value&&(t.value=t.value.map(o=>{var l;return o.id===b.value&&(o.books=o.books&&o.books.filter(k=>k.id!==e.id)),o.id===e.category&&((l=o.books)==null||l.splice(0,0,e)),o}))})},U=()=>{i.value=void 0,a.value=!1},F=()=>{n.value=void 0,b.value=void 0,a.value=!1},H=e=>{g.value=e},S=()=>{g.value=""};return O(()=>{q().then(e=>{m.value=e.editable,t.value=e.portals})}),(e,o)=>(d(),v(x,null,[s("div",te,[u(Y,{hiddenFold:!0},{default:_(()=>[m.value?(d(),v("div",ae,[s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium rounded-md text-slate-50 bg-blue-400 hover:bg-blue-700",onClick:E},[se,u(p,{name:"add-line"})]),s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium border rounded-md text-blue-400 border-blue-400 hover:text-blue-700 hover:border-blue-700",onClick:I},[ne,u(p,{name:"add-line"})]),s("button",{class:"px-2 lg:py-1 lg:px-4 mx-1 lg:mx-2 text-basic lg:text-lg font-normal lg:font-medium border rounded-md text-blue-400 border-blue-400 hover:text-blue-700 hover:border-blue-700",onClick:N},[ie,u(p,{name:"add-line"})])])):h("",!0)]),_:1}),s("div",ue,[(d(!0),v(x,null,y(t.value,(l,k)=>(d(),v("ul",{key:k},[s("p",{class:"m-2 lg:m-4 text-basic lg:text-lg text-blue-900 dark:text-slate-200 font-medium",onMouseover:c=>H(l.id),onMouseleave:o[0]||(o[0]=c=>S())},[s("span",de,Q(l.name),1),m.value&&g.value===l.id?(d(),T(p,{key:0,class:"shadow-sm rounded-sm text-blue-300 hover:text-blue-700",name:"edit-line",onClick:j(c=>V(l),["stop"])},null,8,["onClick"])):h("",!0)],40,re),s("div",ve,[(d(!0),v(x,null,y(l.books,(c,z)=>(d(),v("li",{class:"p-2 md:p-4 lg:p-4 basis-1/4 md:basis-1/6 lg:basis-1/12",key:z},[u(C,{theme:"blue",editable:m.value,modelValue:c,onEdit:D=>w(c),onRemove:D=>P(c)},null,8,["editable","modelValue","onEdit","onRemove"])]))),128)),m.value?(d(),v("li",ce,[u(C,{theme:"blue",modelValue:{title:"新增书签",icon:"add-line"},onCardClick:()=>M(l)},null,8,["onCardClick"])])):h("",!0)])]))),128))])]),u(J,{title:`${a.value?"新增分类":"编辑分类"}`,visible:!!i.value,group:i.value,"onUpdate:group":o[1]||(o[1]=l=>i.value=l),onConfirm:G,onCancel:U},null,8,["title","visible","group"]),u(K,{fixedType:"link",title:`${a.value?"新增书签":"编辑书签"}`,visible:!!n.value,book:n.value,"onUpdate:book":o[2]||(o[2]=l=>n.value=l),onConfirm:A,categories:t.value,onCancel:F},null,8,["title","visible","book","categories"]),u(Z,{visible:!!f.value,closable:!1,title:"确认删除",onConfirm:$,onCancel:R},{default:_(()=>[me]),_:1},8,["visible"])],64))}});export{Pe as default};
