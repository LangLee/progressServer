import{ay as h,bl as b}from"./vendor-DqHIQWU1.js";import{e as f}from"./index-bEem1MK9.js";const y=e=>h.post("/ai/getYouDaoAiTranslate",e).then(t=>t.data&&t.data.success?t.data.data&&t.data.data:Promise.reject(t.data&&t.data.message)),C=({appId:e,id:t,mode:l,question:c,autoSave:d,prompt:u},g,o)=>{let a=new AbortController;const m=localStorage.getItem("me_token")||"";return b(`${f}/ai/getAiChatStream`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:m,appId:e},openWhenHidden:!0,body:JSON.stringify({id:t,mode:l,question:c,autoSave:d,prompt:u}),signal:a==null?void 0:a.signal,onmessage:n=>{const i=n.data||"";if(i==="[DONE]"){o(),a.abort();return}const r=JSON.parse(i);if(r.Done){let p=r.id;o(p),a.abort();return}const s=r.choices[0].delta.content;if(s==null){console.log("stop..."),o();return}g(s)},onclose(){console.log("close")},onerror(n){throw a.abort(),n}})};export{y as a,C as g};
