const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Markdown-DQ-bqARq.js","./tiptap-BKsPUihP.js","./vendor-CWXOCgin.js","../css/vendor-BPbd6SgJ.css","./RemixIcon-CgHXNHMg.js","./ai-BVRWMiUD.js","./index-B7emg1l8.js","../css/index-BgIz4_C3.css","./message-B11-HW_C.js","./_plugin-vue_export-helper-DlAUqK2U.js","../css/message-Ld0-QEl8.css","./utils-BIo_BOvM.js","../css/Markdown-DA1csfbN.css","./Chat-C8BP3w6Y.js","./ChatPanel-BUmdwLXC.js","./Modal-B5x_NgZY.js","./Header-C2ZRdA8X.js","./userInfo-BH_HArD6.js","./Fish-twJ8LYmt.js","../css/Fish-DzSoJcto.css","./Question-B_5_mfwX.js","./FishGlass-BerDv30e.js","../css/FishGlass-DD7IDg5z.css","./Text-DVptALfq.js","./Code-CVHVETHS.js","../css/Code-BLTi7TbQ.css","./Task-DO7ulC51.js","../css/Task-CoyDmG1V.css","./Drawing-BakfNY7r.js","../css/Drawing-Bdgq6z4a.css"])))=>i.map(i=>d[i]);
import{_ as l}from"./index-B7emg1l8.js";import{ai as C,aA as L,an as R,aj as n,aT as I,aD as p,aE as k,aQ as b,a_ as y,aF as D,aR as E,aY as P,aK as s}from"./vendor-CWXOCgin.js";import{u as V,g as T}from"./book-PI_kZs2c.js";import{m as f}from"./message-B11-HW_C.js";import{R as B}from"./RemixIcon-CgHXNHMg.js";import{L as O}from"./Loading-6Ot9jxdK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const S=C({__name:"Book",setup(w){const g=L(),r=R(),u=n(""),i=n(Array()),v=n(!1),m=n(!1),c=n(!1);let _="";const d=n(""),h=()=>new Promise(t=>{if(u.value===_)return t(!0);let o=[];i.value.length>0&&(o=i.value.map(a=>({id:a.id,itemIndex:a.itemIndex,level:a.level,originalLevel:a.originalLevel,pos:a.pos,textContent:a.textContent})));let e={id:d.value,content:u.value,anchors:o};V(e).then(a=>{a&&(_=u.value,f.success("保存成功"),t(!0))}).catch(a=>{f.error(a),t(!1)})}),x=t=>{switch(t){case"markdown":{r.value=s(()=>l(()=>import("./Markdown-DQ-bqARq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url));break}case"chat":r.value=s(()=>l(()=>import("./Chat-C8BP3w6Y.js"),__vite__mapDeps([13,14,4,2,3,15,16,17,18,9,19,11,8,10,20,21,22]),import.meta.url));break;case"text":{r.value=s(()=>l(()=>import("./Text-DVptALfq.js"),__vite__mapDeps([23,1,2,3,11]),import.meta.url));break}case"code":{r.value=s(()=>l(()=>import("./Code-CVHVETHS.js"),__vite__mapDeps([24,2,3,11,25]),import.meta.url));break}case"task":{r.value=s(()=>l(()=>import("./Task-DO7ulC51.js"),__vite__mapDeps([26,1,2,3,11,27]),import.meta.url));break}case"drawing":{r.value=s(()=>l(()=>import("./Drawing-BakfNY7r.js"),__vite__mapDeps([28,1,2,3,9,11,29]),import.meta.url));break}default:{r.value=s(()=>l(()=>import("./Markdown-DQ-bqARq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url));break}}},A=()=>{m.value?h().then(()=>{m.value=!1}):m.value=v.value};return I(()=>g.params.id,(t,o)=>{t&&t!==o&&(typeof t=="string"&&(d.value=t||""),c.value=!0,T(d.value).then(e=>{u.value=e.content||"",i.value=e.anchors||[],_=e.content||"",v.value=e.editable&&e.type!=="chat"||!1,x(e.type),c.value=!1}).catch(e=>{f.error(e),c.value=!1}))},{immediate:!0}),(t,o)=>(p(),k("div",{class:P(["w-full h-full flex",{"select-none":!v.value}])},[(p(),b(y(r.value),{editable:m.value,modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=e=>u.value=e),anchors:i.value,"onUpdate:anchors":o[1]||(o[1]=e=>i.value=e)},null,40,["editable","modelValue","anchors"])),v.value?(p(),k("div",{key:0,class:"fixed top-28 right-4 w-8 h-8 text-center rounded-full border bg-blue-700/10 hover:bg-blue-500 z-40 cursor-pointer",onClick:A},[D(B,{class:"text-slate-50 text-lg",name:m.value?"save-line":"file-edit-line"},null,8,["name"])])):E("",!0),c.value?(p(),b(O,{key:1})):E("",!0)],2))}});export{S as default};
