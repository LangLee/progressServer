import{ai as j,aj as r,ao as L,aD as v,aE as d,aH as u,aF as i,aT as C,aG as g,aV as _,aZ as h,aN as X,aS as Z,aX as q}from"./vendor-Ca624vxD.js";import{R as p}from"./RemixIcon-Cy7WqHn8.js";import{C as B}from"./Card-qUt5X4wy.js";import{a as z,G as J,B as K,c as O,u as Q}from"./GroupModal-SqgswNQa.js";import{H as W}from"./Header-PYXapPSr.js";import{M as Y}from"./Modal-DAiAG9nN.js";import{r as ee,c as oe,u as le}from"./book-BoQwkkU-.js";import{m as y}from"./message-BXUz8B8N.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-BIo_BOvM.js";import"./userInfo-CpJIz3bh.js";import"./user-Ugs0z67X.js";import"./index-D5Zmbx3T.js";const te={class:"flex flex-col h-screen w-full"},ae={key:0},se={class:"flex-1 p-2 lg:p-4 overflow-y-auto"},ne=["onMouseover"],ie={class:"mr-2"},ue={class:"flex flex-row flex-wrap"},re={key:0,class:"p-2 md:p-4 lg:p-4 basis-1/4 md:basis-1/6 lg:basis-1/12"},ve=u("p",{class:"align-center"},"你真的要删除这个书签？",-1),Me=j({__name:"Portals",setup(de){const t=r(Array()),m=r(!1),s=r(),b=r(),n=r(),a=r(!1),f=r(),x=r(""),M=e=>{a.value=!0,s.value={title:"新增书签",type:"link",url:"",category:e.id}},w=e=>{a.value=!1,s.value=e,b.value=e.category},P=e=>{f.value=e.id},E=()=>{f.value=null},R=()=>{ee(f.value).then(e=>{t.value=t.value.map(o=>(o.id===e.category&&(o.books=o.books&&o.books.filter(l=>l.id!==e.id)),o)),f.value=null})},V=()=>{a.value=!0,n.value={name:""}},$=e=>{a.value=!1,n.value=e},G=()=>{y.warning("还未开发，敬请期待")},N=()=>{y.warning("还未开发，敬请期待")},I=()=>{a.value?O(n.value).then(e=>{t.value&&t.value.length>0&&t.value.push(e),n.value=void 0,a.value=!1}):Q(n.value).then(e=>{t.value=t.value.map(o=>o.id===e.id?e:o),n.value=void 0})},F=()=>{a.value?oe(s.value).then(e=>{let o=t.value.find(({id:l})=>l===e.category);o&&(o.books=o.books||[],e.id=e._id,o.books.splice(0,0,e),s.value=void 0,a.value=!1)}):s&&s.value&&le(s.value).then(e=>{e.category!==b.value&&(t.value=t.value.map(o=>{var l;return o.id===b.value&&(o.books=o.books&&o.books.filter(k=>k.id!==e.id)),o.id===e.category&&((l=o.books)==null||l.splice(0,0,e)),o}))})},H=()=>{n.value=void 0,a.value=!1},A=()=>{s.value=void 0,b.value=void 0,a.value=!1},D=e=>{x.value=e},S=()=>{x.value=""};return L(()=>{z().then(e=>{m.value=e.editable,t.value=e.portals})}),(e,o)=>(v(),d(g,null,[u("div",te,[i(W,{hiddenFold:!0},{default:C(()=>[m.value?(v(),d("div",ae,[u("button",{class:"mx-1 lg:mx-2 text-xl lg:text-3xl text-blue-400 hover:text-blue-700",onClick:V},[i(p,{name:"add-fill"})]),u("button",{class:"mx-1 lg:mx-2 text-xl lg:text-3xl font-normal text-blue-400 border-blue-400 hover:text-blue-700",onClick:G},[i(p,{name:"import-fill"})]),u("button",{class:"mx-1 lg:mx-2 text-xl lg:text-3xl font-normal text-blue-400 border-blue-400 hover:text-blue-700",onClick:N},[i(p,{name:"export-fill"})])])):h("",!0)]),_:1}),u("div",se,[(v(!0),d(g,null,_(t.value,(l,k)=>(v(),d("ul",{key:k},[u("p",{class:"m-2 lg:m-4 text-basic lg:text-lg text-blue-900 dark:text-slate-200 font-medium",onMouseover:c=>D(l.id),onMouseleave:o[0]||(o[0]=c=>S())},[u("span",ie,X(l.name),1),m.value&&x.value===l.id?(v(),Z(p,{key:0,class:"shadow-sm rounded-sm text-blue-300 hover:text-blue-700",name:"edit-line",onClick:q(c=>$(l),["stop"])},null,8,["onClick"])):h("",!0)],40,ne),u("div",ue,[(v(!0),d(g,null,_(l.books,(c,T)=>(v(),d("li",{class:"p-2 md:p-4 lg:p-4 basis-1/4 md:basis-1/6 lg:basis-1/12",key:T},[i(B,{theme:"blue",editable:m.value,modelValue:c,onEdit:U=>w(c),onRemove:U=>P(c)},null,8,["editable","modelValue","onEdit","onRemove"])]))),128)),m.value?(v(),d("li",re,[i(B,{theme:"blue",modelValue:{title:"新增书签",icon:"add-line"},onCardClick:()=>M(l)},null,8,["onCardClick"])])):h("",!0)])]))),128))])]),i(J,{title:`${a.value?"新增分类":"编辑分类"}`,visible:!!n.value,group:n.value,"onUpdate:group":o[1]||(o[1]=l=>n.value=l),onConfirm:I,onCancel:H},null,8,["title","visible","group"]),i(K,{fixedType:"link",title:`${a.value?"新增书签":"编辑书签"}`,visible:!!s.value,book:s.value,"onUpdate:book":o[2]||(o[2]=l=>s.value=l),onConfirm:F,categories:t.value,onCancel:A},null,8,["title","visible","book","categories"]),i(Y,{visible:!!f.value,closable:!1,title:"确认删除",onConfirm:R,onCancel:E},{default:C(()=>[ve]),_:1},8,["visible"])],64))}});export{Me as default};
